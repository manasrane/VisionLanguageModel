[0m11:39:27.240155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a8b2dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a70f0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a72728d0>]}


============================== 11:39:27.246868 | 10e158a3-4a82-44c2-8e8d-b231b33a678c ==============================
[0m11:39:27.246868 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:39:27.247282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:39:27.247552 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:39:27.248240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.047126003, "process_in_blocks": "0", "process_kernel_time": 0.225116, "process_mem_max_rss": "86148", "process_out_blocks": "1472", "process_user_time": 0.989737}
[0m11:39:27.248569 [debug] [MainThread]: Command `dbt run` failed at 11:39:27.248496 after 0.05 seconds
[0m11:39:27.248787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a7735ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a7892ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a6e8fbc0>]}
[0m11:39:27.249043 [debug] [MainThread]: Flushing usage events
[0m11:39:28.601697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:06.412893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212cafe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212a19100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212e38bc0>]}


============================== 11:40:06.418784 | 785c77fe-a829-425b-add3-41630bf8cca2 ==============================
[0m11:40:06.418784 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:40:06.419188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init my_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:40:06.462123 [debug] [MainThread]: Starter project path: /usr/local/lib/python3.12/site-packages/dbt/include/starter_project
[0m11:40:06.465483 [info ] [MainThread]: 
Your new dbt project "my_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:40:06.465806 [info ] [MainThread]: Setting up your profile.
[0m11:40:39.843476 [info ] [MainThread]: Profile my_project written to /root/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m11:40:39.846847 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 34.624004, "process_in_blocks": "0", "process_kernel_time": 0.187087, "process_mem_max_rss": "91728", "process_out_blocks": "1552", "process_user_time": 1.06961}
[0m11:40:39.847760 [debug] [MainThread]: Command `dbt init` succeeded at 11:40:39.847518 after 34.63 seconds
[0m11:40:39.848372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212ce2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7012127b6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7012127e5400>]}
[0m11:40:39.848989 [debug] [MainThread]: Flushing usage events
[0m11:40:41.165418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:55.483985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c30fd0d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c31098be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c30fd0f5c0>]}


============================== 11:43:55.493318 | 3e7efbab-9c5a-4400-8258-b78a70719462 ==============================
[0m11:43:55.493318 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:43:55.493736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:55.494037 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:43:55.496806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07938974, "process_in_blocks": "82112", "process_kernel_time": 0.244016, "process_mem_max_rss": "86032", "process_out_blocks": "1480", "process_user_time": 1.147639}
[0m11:43:55.497236 [debug] [MainThread]: Command `dbt run` failed at 11:43:55.497149 after 0.08 seconds
[0m11:43:55.497530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c31098be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c3106ac200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c30ffa61b0>]}
[0m11:43:55.497802 [debug] [MainThread]: Flushing usage events
[0m11:43:56.305298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:43.989837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd685f1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67e33b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd685f36e0>]}


============================== 11:46:43.995009 | eb27c7bf-acfa-45c7-92cf-3cb73589746c ==============================
[0m11:46:43.995009 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:46:43.995383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:46:44.239895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd68052630>]}
[0m11:46:44.308037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67adb200>]}
[0m11:46:44.309692 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:46:44.377828 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:46:44.378370 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:46:44.378664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd6626e0c0>]}
[0m11:46:45.049508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m11:46:45.055118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd660deb40>]}
[0m11:46:45.091195 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:45.093659 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:45.129062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd65f877a0>]}
[0m11:46:45.129509 [info ] [MainThread]: Found 429 macros
[0m11:46:45.130144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd663116d0>]}
[0m11:46:45.133725 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:46:45.134357 [debug] [MainThread]: Command end result
[0m11:46:45.147899 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:45.149279 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:45.152423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:46:45.153342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2086997, "process_in_blocks": "13104", "process_kernel_time": 0.207004, "process_mem_max_rss": "98928", "process_out_blocks": "4064", "process_user_time": 2.039381}
[0m11:46:45.153786 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:45.153696 after 1.21 seconds
[0m11:46:45.154082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd68347e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67d73a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67b73ce0>]}
[0m11:46:45.154348 [debug] [MainThread]: Flushing usage events
[0m11:46:46.410448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:56.518499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa0bb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa0bac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa0b8aa0>]}


============================== 11:54:56.523571 | c122ab35-5bd9-461e-a9be-b63614419f81 ==============================
[0m11:54:56.523571 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:54:56.523977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:54:56.748335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea9da9280>]}
[0m11:54:56.799913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa5aac90>]}
[0m11:54:56.800730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:54:56.867398 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:54:56.919176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m11:54:56.921172 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/my_first_dbt_model.sql
[0m11:54:56.921587 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/schema.yml
[0m11:54:56.921872 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/my_second_dbt_model.sql
[0m11:54:57.332617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea81095b0>]}
[0m11:54:57.390896 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:54:57.393559 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:54:57.413546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea5c65a60>]}
[0m11:54:57.413992 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m11:54:57.415398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eab14fc50>]}
[0m11:54:57.417087 [info ] [MainThread]: 
[0m11:54:57.417965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:57.418781 [info ] [MainThread]: 
[0m11:54:57.419867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:54:57.424026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:54:57.459927 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:54:57.460379 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:54:57.460619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:57.462399 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:54:57.463426 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:54:57.463652 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:54:57.463889 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:54:57.464137 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:54:57.464371 [debug] [ThreadPool]: On list_db: No close available on handle
[0m11:54:57.465286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:57.465570 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m11:54:57.465822 [info ] [MainThread]: 
[0m11:54:57.466135 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m11:54:57.466571 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:54:57.467428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.98911524, "process_in_blocks": "2216", "process_kernel_time": 0.330103, "process_mem_max_rss": "109508", "process_out_blocks": "3304", "process_user_time": 1.871882}
[0m11:54:57.467845 [debug] [MainThread]: Command `dbt run` failed at 11:54:57.467756 after 0.99 seconds
[0m11:54:57.468141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa41b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea827e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea5b24560>]}
[0m11:54:57.468431 [debug] [MainThread]: Flushing usage events
[0m11:54:58.799290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:45.283804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000ced00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000d81ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000ced1310>]}


============================== 11:58:45.291329 | d95494d2-f256-4dec-86ae-c22471737ae4 ==============================
[0m11:58:45.291329 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:58:45.292045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:58:45.483380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000d2a2090>]}
[0m11:58:45.549786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000dd6c860>]}
[0m11:58:45.551459 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:58:45.621268 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:58:45.708004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:45.708336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:45.737678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b66c7d0>]}
[0m11:58:45.791778 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:58:45.794188 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:58:45.816410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b385340>]}
[0m11:58:45.816848 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m11:58:45.817432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b33c770>]}
[0m11:58:45.819859 [info ] [MainThread]: 
[0m11:58:45.820178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:45.820402 [info ] [MainThread]: 
[0m11:58:45.820813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:58:45.824219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:58:45.856732 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:58:45.857078 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:58:45.857272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:45.859487 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:58:45.861409 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:58:45.861987 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:58:45.862531 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:58:45.863035 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:58:45.863545 [debug] [ThreadPool]: On list_db: No close available on handle
[0m11:58:45.864670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:45.864879 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m11:58:45.865071 [info ] [MainThread]: 
[0m11:58:45.865327 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m11:58:45.865684 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:58:45.866477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6257717, "process_in_blocks": "0", "process_kernel_time": 0.226057, "process_mem_max_rss": "103224", "process_out_blocks": "2480", "process_user_time": 1.578505}
[0m11:58:45.866862 [debug] [MainThread]: Command `dbt run` failed at 11:58:45.866781 after 0.63 seconds
[0m11:58:45.867142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000d1ccfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b3457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000a4e81a0>]}
[0m11:58:45.867440 [debug] [MainThread]: Flushing usage events
[0m11:58:47.133596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:42:05.841941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32e8a0>]}


============================== 05:42:05.849045 | bc5d99bd-9f85-4e0a-a8f7-170ddf3db066 ==============================
[0m05:42:05.849045 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:42:05.849449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:42:05.851129 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_project'
[0m05:42:05.852534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05013612, "process_in_blocks": "84568", "process_kernel_time": 0.254795, "process_mem_max_rss": "86244", "process_out_blocks": "1480", "process_user_time": 0.966466}
[0m05:42:05.852872 [debug] [MainThread]: Command `dbt run` failed at 05:42:05.852800 after 0.05 seconds
[0m05:42:05.853103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b309fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32d4f0>]}
[0m05:42:05.853349 [debug] [MainThread]: Flushing usage events
[0m05:42:07.083509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:43:11.161815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb7933e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efbbeae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb793500>]}


============================== 05:43:11.168519 | f25681f1-008d-41e4-8c90-0d36778dd7a2 ==============================
[0m05:43:11.168519 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:43:11.168989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:43:11.171027 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_project'
[0m05:43:11.172845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.056842603, "process_in_blocks": "78000", "process_kernel_time": 0.257499, "process_mem_max_rss": "86304", "process_out_blocks": "1472", "process_user_time": 0.937128}
[0m05:43:11.173238 [debug] [MainThread]: Command `dbt run` failed at 05:43:11.173155 after 0.06 seconds
[0m05:43:11.173508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb842540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb2653a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efbecba70>]}
[0m05:43:11.173790 [debug] [MainThread]: Flushing usage events
[0m05:43:12.065963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:43:28.872735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da374e71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da3720d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da37c492e0>]}


============================== 05:43:28.878322 | 7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d ==============================
[0m05:43:28.878322 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:43:28.878684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:43:29.103119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da376c6d20>]}
[0m05:43:29.148790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da370b7c50>]}
[0m05:43:29.151131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:43:29.226818 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:43:29.289066 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:43:29.289546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da355813d0>]}
[0m05:43:29.961533 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/sources/sources.yml @ sources: {'name': 'dev', 'database': 'db', 'tables': [{'name': 'raw_weather_data', 'columns': {'-name': 'utc_offset'}}]} - at path ['tables'][0]['columns']: {'-name': 'utc_offset'} is not of type 'array'
[0m05:43:29.963532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1309751, "process_in_blocks": "18640", "process_kernel_time": 0.239349, "process_mem_max_rss": "99928", "process_out_blocks": "1512", "process_user_time": 1.923497}
[0m05:43:29.964291 [debug] [MainThread]: Command `dbt run` failed at 05:43:29.964182 after 1.13 seconds
[0m05:43:29.964597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da37a4f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da3542bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da16d0aae0>]}
[0m05:43:29.964857 [debug] [MainThread]: Flushing usage events
[0m05:43:33.872294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:45:58.316392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d095fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d096f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d095580>]}


============================== 05:45:58.320970 | 28673400-9aca-4f78-b28e-b527c1a3fc51 ==============================
[0m05:45:58.320970 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:45:58.321345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:45:58.481240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d095580>]}
[0m05:45:58.523151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d0c3950>]}
[0m05:45:58.525513 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:45:58.577703 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:45:58.637813 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:45:58.638195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735b1589e0>]}
[0m05:45:59.383234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735af09b80>]}
[0m05:45:59.429893 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:45:59.433108 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:45:59.462901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727358a68470>]}
[0m05:45:59.463366 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m05:45:59.463631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727358a09ee0>]}
[0m05:45:59.464964 [info ] [MainThread]: 
[0m05:45:59.465247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:59.465729 [info ] [MainThread]: 
[0m05:45:59.466318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:45:59.467286 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:45:59.569179 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:45:59.569880 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:45:59.570430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:59.591645 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m05:45:59.592683 [debug] [ThreadPool]: On list_db: Close
[0m05:45:59.593397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev_dev)
[0m05:45:59.593803 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev_dev"
"
[0m05:45:59.597481 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m05:45:59.597916 [debug] [ThreadPool]: On create_db_dev_dev: BEGIN
[0m05:45:59.598447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:59.603020 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m05:45:59.603368 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m05:45:59.603570 [debug] [ThreadPool]: On create_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev_dev"} */
create schema if not exists "dev_dev"
[0m05:45:59.604258 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m05:45:59.605116 [debug] [ThreadPool]: On create_db_dev_dev: COMMIT
[0m05:45:59.605365 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m05:45:59.605567 [debug] [ThreadPool]: On create_db_dev_dev: COMMIT
[0m05:45:59.607481 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m05:45:59.607708 [debug] [ThreadPool]: On create_db_dev_dev: Close
[0m05:45:59.608713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev_dev, now list_db_dev_dev)
[0m05:45:59.612757 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:45:59.612994 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m05:45:59.613174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:59.617412 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m05:45:59.617652 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:45:59.617837 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m05:45:59.624309 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m05:45:59.625186 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m05:45:59.625533 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m05:45:59.628528 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.628782 [debug] [MainThread]: On master: BEGIN
[0m05:45:59.628969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:59.633396 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:45:59.633651 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.633886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:45:59.638911 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:45:59.639891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727358a094f0>]}
[0m05:45:59.640254 [debug] [MainThread]: On master: ROLLBACK
[0m05:45:59.640646 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.640877 [debug] [MainThread]: On master: BEGIN
[0m05:45:59.641295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:45:59.641502 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.641676 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.641846 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.642156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:45:59.642401 [debug] [MainThread]: On master: Close
[0m05:45:59.644470 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:45:59.644844 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.staging ................................... [RUN]
[0m05:45:59.645154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.staging)
[0m05:45:59.645364 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:45:59.649943 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:45:59.651503 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:45:59.679452 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:45:59.680435 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.680692 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:45:59.681025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:59.685992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m05:45:59.686305 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.686532 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev_dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select  * 
from "db"."dev"."raw_weather_data"
  );
  
[0m05:45:59.697175 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.010 seconds
[0m05:45:59.701631 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.701966 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev_dev"."staging__dbt_tmp" rename to "staging"
[0m05:45:59.702639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:45:59.716774 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:45:59.717190 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.717439 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:45:59.740410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m05:45:59.746667 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."staging__dbt_backup"
[0m05:45:59.752810 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.753547 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev_dev"."staging__dbt_backup" cascade
[0m05:45:59.754384 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m05:45:59.756763 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:45:59.762487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735b08e6f0>]}
[0m05:45:59.763351 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.staging .............................. [[32mSELECT 37[0m in 0.11s]
[0m05:45:59.763915 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:45:59.766497 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.766868 [debug] [MainThread]: On master: BEGIN
[0m05:45:59.767096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:59.773730 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m05:45:59.774203 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.774502 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.774760 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.775447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:45:59.775767 [debug] [MainThread]: On master: Close
[0m05:45:59.776234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:59.776518 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:45:59.776832 [info ] [MainThread]: 
[0m05:45:59.777176 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m05:45:59.777792 [debug] [MainThread]: Command end result
[0m05:45:59.796219 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:45:59.797669 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:45:59.802025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:45:59.802314 [info ] [MainThread]: 
[0m05:45:59.802627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:45:59.803001 [info ] [MainThread]: 
[0m05:45:59.803458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:45:59.804977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5526671, "process_in_blocks": "102528", "process_kernel_time": 0.291356, "process_mem_max_rss": "110464", "process_out_blocks": "2640", "process_user_time": 2.255803}
[0m05:45:59.805397 [debug] [MainThread]: Command `dbt run` succeeded at 05:45:59.805310 after 1.55 seconds
[0m05:45:59.805687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735fcb94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735fcb9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735af70860>]}
[0m05:45:59.805961 [debug] [MainThread]: Flushing usage events
[0m05:46:00.661664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:48:13.543557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a31cd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a31ce240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a31cd8e0>]}


============================== 05:48:13.545966 | f099878e-276c-4557-a7a2-76c4b46944bb ==============================
[0m05:48:13.545966 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:48:13.547283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:48:13.676661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a14a0950>]}
[0m05:48:13.722032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a37ccf20>]}
[0m05:48:13.722794 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:48:13.771633 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:48:13.836279 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:48:13.836796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a319bf50>]}
[0m05:48:14.572824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a123c680>]}
[0m05:48:14.620096 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:48:14.621955 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:48:14.632846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e89aa95a60>]}
[0m05:48:14.633225 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m05:48:14.633509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e89aafe0c0>]}
[0m05:48:14.634682 [info ] [MainThread]: 
[0m05:48:14.635016 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:48:14.635263 [info ] [MainThread]: 
[0m05:48:14.636560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:48:14.638061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:48:14.712035 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:48:14.712371 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:48:14.712572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:48:14.720739 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m05:48:14.721762 [debug] [ThreadPool]: On list_db: Close
[0m05:48:14.722935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:48:14.727152 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:48:14.727396 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:48:14.727643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:48:14.732400 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m05:48:14.732722 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:48:14.732936 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:48:14.735220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m05:48:14.736329 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:48:14.736748 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:48:14.740207 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.740494 [debug] [MainThread]: On master: BEGIN
[0m05:48:14.740710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:48:14.745812 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m05:48:14.746108 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.746364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:48:14.749014 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m05:48:14.750336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e899ee6d20>]}
[0m05:48:14.750783 [debug] [MainThread]: On master: ROLLBACK
[0m05:48:14.751237 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.751490 [debug] [MainThread]: On master: BEGIN
[0m05:48:14.752054 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:48:14.752305 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.752557 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.752755 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.753053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:48:14.753264 [debug] [MainThread]: On master: Close
[0m05:48:14.755520 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:48:14.755961 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m05:48:14.756297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:48:14.756531 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:48:14.761242 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:48:14.761812 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:48:14.788570 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:48:14.789217 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.789494 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:48:14.789700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:48:14.794259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m05:48:14.794581 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.794793 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select  * 
from "db"."dev"."raw_weather_data"
  );
  
[0m05:48:14.823707 [debug] [Thread-1 (]: SQL status: SELECT 38 in 0.029 seconds
[0m05:48:14.828890 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.829191 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:48:14.829802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:48:14.840167 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:48:14.840453 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.840658 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:48:14.851209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m05:48:14.854874 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:48:14.858022 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.858286 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:48:14.859108 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m05:48:14.862394 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:48:14.865186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a4a02270>]}
[0m05:48:14.866268 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 38[0m in 0.11s]
[0m05:48:14.867076 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:48:14.869301 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.869611 [debug] [MainThread]: On master: BEGIN
[0m05:48:14.869863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:48:14.874316 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:48:14.874597 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.874804 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.875037 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.875363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:48:14.875575 [debug] [MainThread]: On master: Close
[0m05:48:14.875905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:48:14.876108 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:48:14.876321 [info ] [MainThread]: 
[0m05:48:14.876566 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m05:48:14.877082 [debug] [MainThread]: Command end result
[0m05:48:14.891553 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:48:14.892911 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:48:14.896823 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:48:14.897087 [info ] [MainThread]: 
[0m05:48:14.897376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:48:14.897582 [info ] [MainThread]: 
[0m05:48:14.897804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:48:14.898616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4212016, "process_in_blocks": "0", "process_kernel_time": 0.237477, "process_mem_max_rss": "110372", "process_out_blocks": "2528", "process_user_time": 2.244829}
[0m05:48:14.899025 [debug] [MainThread]: Command `dbt run` succeeded at 05:48:14.898945 after 1.42 seconds
[0m05:48:14.899297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a2d50290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a2d50e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a123d100>]}
[0m05:48:14.899553 [debug] [MainThread]: Flushing usage events
[0m05:48:15.763299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:59:07.329908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755d234a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755d21b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667552f2480>]}


============================== 05:59:07.333951 | d75dfe5e-ce33-4eb4-95a3-64eb2812a22c ==============================
[0m05:59:07.333951 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:59:07.334930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:59:07.451075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755493b60>]}
[0m05:59:07.494184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675588b5f0>]}
[0m05:59:07.495507 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:59:07.540832 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:59:07.613796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:59:07.614269 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m05:59:07.803427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755a64f20>]}
[0m05:59:07.850574 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:59:07.852541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:59:07.864133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675350e1b0>]}
[0m05:59:07.864496 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m05:59:07.864747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667538d3980>]}
[0m05:59:07.865853 [info ] [MainThread]: 
[0m05:59:07.866192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:59:07.866405 [info ] [MainThread]: 
[0m05:59:07.866818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:59:07.867761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:59:07.893270 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:59:07.893625 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:59:07.893825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:59:07.902380 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m05:59:07.903439 [debug] [ThreadPool]: On list_db: Close
[0m05:59:07.904516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:59:07.908020 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:59:07.908295 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:59:07.908475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:07.912942 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m05:59:07.913248 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:59:07.913474 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:59:07.915929 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m05:59:07.916865 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:59:07.917240 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:59:07.921549 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.921881 [debug] [MainThread]: On master: BEGIN
[0m05:59:07.922082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:59:07.926989 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m05:59:07.927320 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.927566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:59:07.930667 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m05:59:07.931775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675059e5a0>]}
[0m05:59:07.932179 [debug] [MainThread]: On master: ROLLBACK
[0m05:59:07.932586 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.932845 [debug] [MainThread]: On master: BEGIN
[0m05:59:07.933249 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:59:07.933463 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.933813 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.934102 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.934432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:59:07.934660 [debug] [MainThread]: On master: Close
[0m05:59:07.936716 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:59:07.937114 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m05:59:07.937484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:59:07.937704 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:59:07.942406 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:59:07.942961 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:59:07.969114 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:59:07.969745 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:07.970013 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:59:07.970231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:07.974740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m05:59:07.975085 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:07.975372 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select  * 
from "db"."dev"."raw_weather_data"

select 
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    time as weather_time_local,
    (inserted_at +(utc_offset || 'hours') :: interval) as inserted_at_local
from source
  );
  
[0m05:59:07.976646 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 17: select 
         ^

[0m05:59:07.976885 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m05:59:07.977312 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:59:07.984487 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "select"
  LINE 17: select 
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m05:59:07.985818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755dae4b0>]}
[0m05:59:07.986358 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.05s]
[0m05:59:07.986863 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:59:07.987434 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "select"
  LINE 17: select 
           ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m05:59:07.989245 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.989504 [debug] [MainThread]: On master: BEGIN
[0m05:59:07.989695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:59:07.994899 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m05:59:07.995284 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.995502 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.995698 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.996038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:59:07.996265 [debug] [MainThread]: On master: Close
[0m05:59:07.996616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:59:07.996821 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:59:07.997044 [info ] [MainThread]: 
[0m05:59:07.997323 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m05:59:07.998056 [debug] [MainThread]: Command end result
[0m05:59:08.010690 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:59:08.012022 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:59:08.016031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:59:08.016275 [info ] [MainThread]: 
[0m05:59:08.016560 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:59:08.016910 [info ] [MainThread]: 
[0m05:59:08.017562 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "select"
  LINE 17: select 
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m05:59:08.017923 [info ] [MainThread]: 
[0m05:59:08.018333 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:59:08.019476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7569224, "process_in_blocks": "368", "process_kernel_time": 0.193704, "process_mem_max_rss": "110264", "process_out_blocks": "2520", "process_user_time": 1.598061}
[0m05:59:08.020605 [debug] [MainThread]: Command `dbt run` failed at 05:59:08.020490 after 0.76 seconds
[0m05:59:08.020940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675521cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667535f38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675510e180>]}
[0m05:59:08.021351 [debug] [MainThread]: Flushing usage events
[0m05:59:08.888995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:01:28.106487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd89b83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd82b7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd89b84a0>]}


============================== 06:01:28.109053 | f5e95e68-2a1e-485b-8c47-bc8452266021 ==============================
[0m06:01:28.109053 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:01:28.109439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:01:28.230907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd7ce1310>]}
[0m06:01:28.273759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abdb4ca900>]}
[0m06:01:28.274443 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:01:28.319118 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:01:28.385327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:01:28.385762 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:01:28.582314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd60e8710>]}
[0m06:01:28.630365 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:01:28.632876 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:01:28.643836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd60e2150>]}
[0m06:01:28.644539 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m06:01:28.645030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd61c7b90>]}
[0m06:01:28.646654 [info ] [MainThread]: 
[0m06:01:28.646958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:01:28.647469 [info ] [MainThread]: 
[0m06:01:28.648434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:01:28.649209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:01:28.672967 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:01:28.673290 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:01:28.673483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:28.681332 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m06:01:28.682432 [debug] [ThreadPool]: On list_db: Close
[0m06:01:28.683895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:01:28.687718 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:01:28.687971 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:01:28.688152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:28.692680 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:01:28.692962 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:01:28.693149 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:01:28.694937 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:01:28.695844 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:01:28.696167 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:01:28.700393 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.700650 [debug] [MainThread]: On master: BEGIN
[0m06:01:28.700838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:01:28.705571 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:01:28.705907 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.706154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:01:28.708778 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:01:28.709813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abcef902f0>]}
[0m06:01:28.710175 [debug] [MainThread]: On master: ROLLBACK
[0m06:01:28.710547 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.710773 [debug] [MainThread]: On master: BEGIN
[0m06:01:28.711238 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:01:28.711462 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.711643 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.711816 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.712094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:01:28.712305 [debug] [MainThread]: On master: Close
[0m06:01:28.714368 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:01:28.714785 [info ] [Thread-1 (]: 1 of 1 START sql Table model dev.staging ....................................... [RUN]
[0m06:01:28.715142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:01:28.715368 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:01:28.720099 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:01:28.720696 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:01:28.722521 [debug] [Thread-1 (]: Compilation Error in model staging (models/staging/staging.sql)
  No materialization 'Table' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m06:01:28.723692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd8982360>]}
[0m06:01:28.724186 [error] [Thread-1 (]: 1 of 1 ERROR creating sql Table model dev.staging .............................. [[31mERROR[0m in 0.01s]
[0m06:01:28.724580 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:01:28.724974 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Compilation Error in model staging (models/staging/staging.sql)
  No materialization 'Table' was found for adapter postgres! (searched types 'default' and 'postgres').
[0m06:01:28.726807 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.727102 [debug] [MainThread]: On master: BEGIN
[0m06:01:28.727297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:01:28.731880 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:01:28.732326 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.732539 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.732718 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.733089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:01:28.733349 [debug] [MainThread]: On master: Close
[0m06:01:28.733685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:01:28.733868 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:01:28.734088 [info ] [MainThread]: 
[0m06:01:28.734314 [info ] [MainThread]: Finished running 1 Table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m06:01:28.734795 [debug] [MainThread]: Command end result
[0m06:01:28.747333 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:01:28.748619 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:01:28.752870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:01:28.753194 [info ] [MainThread]: 
[0m06:01:28.753508 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:01:28.753760 [info ] [MainThread]: 
[0m06:01:28.754482 [error] [MainThread]:   Compilation Error in model staging (models/staging/staging.sql)
  No materialization 'Table' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m06:01:28.754965 [info ] [MainThread]: 
[0m06:01:28.755521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:01:28.756681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7180685, "process_in_blocks": "0", "process_kernel_time": 0.141998, "process_mem_max_rss": "108740", "process_out_blocks": "2512", "process_user_time": 1.588608}
[0m06:01:28.757048 [debug] [MainThread]: Command `dbt run` failed at 06:01:28.756970 after 0.72 seconds
[0m06:01:28.757321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd7fc6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd7ce2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd617c7d0>]}
[0m06:01:28.757576 [debug] [MainThread]: Flushing usage events
[0m06:01:29.556090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:02:33.083965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb263473b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2633a6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb26490bb90>]}


============================== 06:02:33.088998 | 8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67 ==============================
[0m06:02:33.088998 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:02:33.089488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:33.207527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb262e9f7a0>]}
[0m06:02:33.250222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb26303cd40>]}
[0m06:02:33.250888 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:02:33.296037 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:02:33.367709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:02:33.368174 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:02:33.550953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb261330920>]}
[0m06:02:33.596497 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:02:33.598178 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:02:33.607889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb261321fd0>]}
[0m06:02:33.608250 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m06:02:33.608505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2614114f0>]}
[0m06:02:33.609679 [info ] [MainThread]: 
[0m06:02:33.609964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:02:33.610163 [info ] [MainThread]: 
[0m06:02:33.610530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:02:33.611381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:02:33.637453 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:02:33.637789 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:02:33.638009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:33.674696 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.037 seconds
[0m06:02:33.676685 [debug] [ThreadPool]: On list_db: Close
[0m06:02:33.678400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:02:33.682733 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:02:33.682989 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:02:33.683184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:33.688410 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:02:33.688822 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:02:33.689106 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:02:33.691301 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:02:33.692287 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:02:33.692718 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:02:33.697240 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.697545 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.697748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:33.702307 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:02:33.702880 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.703228 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:02:33.705496 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:02:33.706425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb25a28a990>]}
[0m06:02:33.706750 [debug] [MainThread]: On master: ROLLBACK
[0m06:02:33.707112 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.707306 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.707699 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:02:33.707925 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.708121 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.708282 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.708609 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:33.708837 [debug] [MainThread]: On master: Close
[0m06:02:33.711243 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:02:33.711687 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:02:33.712022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:02:33.712257 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:02:33.716844 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:02:33.717337 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:02:33.742018 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:02:33.742601 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:33.742835 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:02:33.743024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:33.748222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:02:33.748648 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:33.748884 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM "db"."dev"."raw_weather_data";
  );
  
[0m06:02:33.749391 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: FROM "db"."dev"."raw_weather_data";
                                           ^

[0m06:02:33.749641 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:02:33.750090 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:02:33.752621 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: FROM "db"."dev"."raw_weather_data";
                                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:02:33.753879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb263bc9e80>]}
[0m06:02:33.754405 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:02:33.754849 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:02:33.755335 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: FROM "db"."dev"."raw_weather_data";
                                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:02:33.757567 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.757893 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.758115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:33.763204 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:02:33.763586 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.763901 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.764149 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.764561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:33.764805 [debug] [MainThread]: On master: Close
[0m06:02:33.765160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:33.765357 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:02:33.765576 [info ] [MainThread]: 
[0m06:02:33.765810 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m06:02:33.766428 [debug] [MainThread]: Command end result
[0m06:02:33.779183 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:02:33.780781 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:02:33.784802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:02:33.785036 [info ] [MainThread]: 
[0m06:02:33.785319 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:02:33.785549 [info ] [MainThread]: 
[0m06:02:33.786081 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: FROM "db"."dev"."raw_weather_data";
                                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:02:33.786538 [info ] [MainThread]: 
[0m06:02:33.786878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:02:33.787679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76986665, "process_in_blocks": "0", "process_kernel_time": 0.147353, "process_mem_max_rss": "109768", "process_out_blocks": "2528", "process_user_time": 1.603027}
[0m06:02:33.788039 [debug] [MainThread]: Command `dbt run` failed at 06:02:33.787945 after 0.77 seconds
[0m06:02:33.788310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2635e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb263bc9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2613c5c10>]}
[0m06:02:33.788595 [debug] [MainThread]: Flushing usage events
[0m06:02:34.601845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:03:39.944458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9467170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9bb2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cca7f3290>]}


============================== 06:03:39.949357 | 125ff9ea-eddf-4238-94c0-395e28cf2669 ==============================
[0m06:03:39.949357 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:03:39.950062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:40.062905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc91e7e90>]}
[0m06:03:40.102281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9f0cbc0>]}
[0m06:03:40.102932 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:03:40.147924 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:03:40.214408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:03:40.214852 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:03:40.412196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc76c4620>]}
[0m06:03:40.458117 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:03:40.459953 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:03:40.470618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc76bde20>]}
[0m06:03:40.470987 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m06:03:40.471241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9255640>]}
[0m06:03:40.472790 [info ] [MainThread]: 
[0m06:03:40.473087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:03:40.473496 [info ] [MainThread]: 
[0m06:03:40.474082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:03:40.474853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:03:40.499368 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:03:40.499715 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:03:40.499949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:40.507279 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:03:40.508570 [debug] [ThreadPool]: On list_db: Close
[0m06:03:40.509648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:03:40.513154 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:03:40.513418 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:03:40.513595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:40.518801 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:03:40.519059 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:03:40.519247 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:03:40.521656 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:03:40.522520 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:03:40.522834 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:03:40.527073 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.527370 [debug] [MainThread]: On master: BEGIN
[0m06:03:40.527574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:40.532377 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:03:40.532731 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.532977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:03:40.535433 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:03:40.536475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc4446060>]}
[0m06:03:40.536828 [debug] [MainThread]: On master: ROLLBACK
[0m06:03:40.537294 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.537521 [debug] [MainThread]: On master: BEGIN
[0m06:03:40.537998 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:03:40.538231 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.538589 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.538792 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.539100 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:03:40.539330 [debug] [MainThread]: On master: Close
[0m06:03:40.541357 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:03:40.541744 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:03:40.542063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:03:40.542292 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:03:40.546952 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:03:40.547685 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:03:40.572527 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:03:40.573097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.573342 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:03:40.573557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:40.578425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:03:40.578779 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.579016 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM "db"."dev"."raw_weather_data"
  );
  
[0m06:03:40.584881 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.006 seconds
[0m06:03:40.589116 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.589403 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:03:40.589967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:03:40.600537 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:03:40.600874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.601082 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:03:40.603687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:03:40.607378 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:03:40.610665 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.610906 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:03:40.611445 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:03:40.612950 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:03:40.614541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ccb02a450>]}
[0m06:03:40.615069 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 33[0m in 0.07s]
[0m06:03:40.615444 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:03:40.617010 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.617332 [debug] [MainThread]: On master: BEGIN
[0m06:03:40.617527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:40.622077 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:03:40.622391 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.622596 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.622782 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.623112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:03:40.623349 [debug] [MainThread]: On master: Close
[0m06:03:40.623703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:40.623914 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:03:40.624185 [info ] [MainThread]: 
[0m06:03:40.624633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m06:03:40.625544 [debug] [MainThread]: Command end result
[0m06:03:40.638104 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:03:40.639714 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:03:40.643683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:03:40.643959 [info ] [MainThread]: 
[0m06:03:40.644256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:40.644468 [info ] [MainThread]: 
[0m06:03:40.644697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:03:40.645676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7725314, "process_in_blocks": "0", "process_kernel_time": 0.207482, "process_mem_max_rss": "109540", "process_out_blocks": "2520", "process_user_time": 1.575983}
[0m06:03:40.646037 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:40.645962 after 0.77 seconds
[0m06:03:40.646287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9839160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc932fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9bb2d80>]}
[0m06:03:40.646531 [debug] [MainThread]: Flushing usage events
[0m06:03:41.480421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:28:51.587587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2d1a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2e8a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf4238530>]}


============================== 06:28:51.590272 | 4cdd516e-1a47-4738-92b4-f3ae97ed9437 ==============================
[0m06:28:51.590272 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:28:51.590651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:51.720756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2f031a0>]}
[0m06:28:51.770894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf46541a0>]}
[0m06:28:51.771568 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:28:51.820969 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:28:51.899467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:28:51.900011 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/weather_report.sql
[0m06:28:51.900365 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:28:52.116892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf0bd9100>]}
[0m06:28:52.174235 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:52.176001 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:52.187351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf0bc6ab0>]}
[0m06:28:52.187726 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:28:52.187996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf0bc36e0>]}
[0m06:28:52.189634 [info ] [MainThread]: 
[0m06:28:52.190036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:52.190392 [info ] [MainThread]: 
[0m06:28:52.191155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:28:52.193968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:28:52.221089 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:28:52.221493 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:28:52.221800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:52.296297 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.074 seconds
[0m06:28:52.297664 [debug] [ThreadPool]: On list_db: Close
[0m06:28:52.299155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:28:52.304095 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:52.304376 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:28:52.304559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:52.310739 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:28:52.311350 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:52.311635 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:28:52.313795 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:28:52.314663 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:28:52.315014 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:28:52.318288 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.318587 [debug] [MainThread]: On master: BEGIN
[0m06:28:52.318786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:28:52.323376 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:28:52.323718 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.324008 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:28:52.326395 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:28:52.327335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf1077290>]}
[0m06:28:52.327670 [debug] [MainThread]: On master: ROLLBACK
[0m06:28:52.328000 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.328201 [debug] [MainThread]: On master: BEGIN
[0m06:28:52.328581 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:28:52.328781 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.329179 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.329530 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.329991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:52.330231 [debug] [MainThread]: On master: Close
[0m06:28:52.332672 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:28:52.333144 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:28:52.333537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:28:52.333802 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:28:52.337989 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:28:52.338519 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:28:52.364734 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:28:52.365358 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:52.365625 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:28:52.366039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:52.370600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:28:52.370863 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:52.371067 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:28:52.371521 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "de_dup"
LINE 14: de_dup as (
         ^

[0m06:28:52.371759 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:28:52.372130 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:28:52.374405 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 14: de_dup as (
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:28:52.376155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf10775f0>]}
[0m06:28:52.378393 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:28:52.379052 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:28:52.379653 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 14: de_dup as (
           ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:28:52.381273 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:28:52.381606 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m06:28:52.381966 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:28:52.383604 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.383860 [debug] [MainThread]: On master: BEGIN
[0m06:28:52.384052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:28:52.389030 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:28:52.389496 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.389836 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.390106 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.390536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:52.390787 [debug] [MainThread]: On master: Close
[0m06:28:52.391134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:52.391324 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:28:52.391617 [info ] [MainThread]: 
[0m06:28:52.391883 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m06:28:52.392988 [debug] [MainThread]: Command end result
[0m06:28:52.408700 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:52.410216 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:52.414227 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:28:52.414478 [info ] [MainThread]: 
[0m06:28:52.414752 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:28:52.414977 [info ] [MainThread]: 
[0m06:28:52.415243 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 14: de_dup as (
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:28:52.415452 [info ] [MainThread]: 
[0m06:28:52.415680 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m06:28:52.416429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8942181, "process_in_blocks": "0", "process_kernel_time": 0.178353, "process_mem_max_rss": "110180", "process_out_blocks": "2520", "process_user_time": 1.712192}
[0m06:28:52.416792 [debug] [MainThread]: Command `dbt run` failed at 06:28:52.416716 after 0.89 seconds
[0m06:28:52.417065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf36a27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2a9b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2a99a90>]}
[0m06:28:52.417335 [debug] [MainThread]: Flushing usage events
[0m06:28:53.361168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:29:09.168691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef84d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef84c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef84e450>]}


============================== 06:29:09.173149 | 80f173f5-c4e6-48df-aff3-0114133c8366 ==============================
[0m06:29:09.173149 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:29:09.173837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:09.296883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef385b80>]}
[0m06:29:09.343257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f0522780>]}
[0m06:29:09.344040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:29:09.392108 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:29:09.463605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:29:09.464085 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:29:09.658824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed641100>]}
[0m06:29:09.706124 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:09.707871 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:09.718725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ec062990>]}
[0m06:29:09.719093 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:29:09.719450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed640cb0>]}
[0m06:29:09.720626 [info ] [MainThread]: 
[0m06:29:09.720915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:29:09.721149 [info ] [MainThread]: 
[0m06:29:09.721522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:29:09.724390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:29:09.751158 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:29:09.751519 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:29:09.751732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:09.758560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:29:09.759466 [debug] [ThreadPool]: On list_db: Close
[0m06:29:09.760862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:29:09.764930 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:09.765228 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:29:09.765422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:09.770216 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:29:09.770469 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:09.770639 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:29:09.772733 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:29:09.773647 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:29:09.774073 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:29:09.778840 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.779160 [debug] [MainThread]: On master: BEGIN
[0m06:29:09.779393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:09.783890 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:29:09.784194 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.784437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:29:09.786951 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:29:09.787875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed56df70>]}
[0m06:29:09.788225 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:09.788610 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.788810 [debug] [MainThread]: On master: BEGIN
[0m06:29:09.789176 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:29:09.789435 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.789929 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.790129 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.790445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:09.790653 [debug] [MainThread]: On master: Close
[0m06:29:09.793105 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:29:09.793543 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:29:09.793958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:29:09.794209 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:29:09.799521 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:29:09.800204 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:29:09.825507 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:29:09.826151 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:09.826423 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:29:09.826621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:09.831130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:29:09.831381 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:09.831585 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    ,

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:29:09.832091 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 12:     ,
             ^

[0m06:29:09.832330 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:29:09.832705 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:29:09.834874 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ","
  LINE 12:     ,
               ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:29:09.836008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed56d820>]}
[0m06:29:09.836490 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:29:09.836919 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:29:09.837396 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ","
  LINE 12:     ,
               ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:29:09.838555 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:29:09.839148 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m06:29:09.839446 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:29:09.840873 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.841107 [debug] [MainThread]: On master: BEGIN
[0m06:29:09.841287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:09.845821 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:29:09.846156 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.846352 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.846532 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.846923 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:09.847144 [debug] [MainThread]: On master: Close
[0m06:29:09.847493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:09.847675 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:29:09.848032 [info ] [MainThread]: 
[0m06:29:09.848402 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m06:29:09.849458 [debug] [MainThread]: Command end result
[0m06:29:09.864021 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:09.866655 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:09.872594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:29:09.872915 [info ] [MainThread]: 
[0m06:29:09.873219 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:29:09.873478 [info ] [MainThread]: 
[0m06:29:09.873776 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ","
  LINE 12:     ,
               ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:29:09.874010 [info ] [MainThread]: 
[0m06:29:09.874346 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m06:29:09.875168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76969665, "process_in_blocks": "0", "process_kernel_time": 0.234683, "process_mem_max_rss": "109904", "process_out_blocks": "2520", "process_user_time": 1.576366}
[0m06:29:09.875568 [debug] [MainThread]: Command `dbt run` failed at 06:29:09.875482 after 0.77 seconds
[0m06:29:09.875884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef750da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed627e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235e649dc70>]}
[0m06:29:09.876166 [debug] [MainThread]: Flushing usage events
[0m06:29:10.688596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:33:42.853660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad977ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad971a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad902bfb0>]}


============================== 06:33:42.856334 | 2f72781a-c753-42d2-8210-455bda215747 ==============================
[0m06:33:42.856334 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:33:42.856939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:33:42.977637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad8a57c20>]}
[0m06:33:43.020243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad8a9c8c0>]}
[0m06:33:43.020950 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:33:43.064415 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:33:43.136397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:33:43.136910 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:33:43.332967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6f053d0>]}
[0m06:33:43.380219 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:33:43.382066 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:33:43.393480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6efa810>]}
[0m06:33:43.393854 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:33:43.394102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6feda60>]}
[0m06:33:43.395549 [info ] [MainThread]: 
[0m06:33:43.395822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:33:43.396428 [info ] [MainThread]: 
[0m06:33:43.397011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:43.399741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:33:43.428241 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:33:43.428578 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:33:43.428775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:43.438315 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m06:33:43.439331 [debug] [ThreadPool]: On list_db: Close
[0m06:33:43.440578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:33:43.444116 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:33:43.444385 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:33:43.444564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:43.449126 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:33:43.449463 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:33:43.449665 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:33:43.451881 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:33:43.452809 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:33:43.453147 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:33:43.457760 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.458051 [debug] [MainThread]: On master: BEGIN
[0m06:33:43.458241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:33:43.462613 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:33:43.462851 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.463076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:33:43.465501 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:33:43.466617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6ef3fb0>]}
[0m06:33:43.466993 [debug] [MainThread]: On master: ROLLBACK
[0m06:33:43.467401 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.467609 [debug] [MainThread]: On master: BEGIN
[0m06:33:43.468028 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:33:43.468267 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.468474 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.468872 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.469296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:43.469539 [debug] [MainThread]: On master: Close
[0m06:33:43.471668 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:33:43.472099 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:33:43.472426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:33:43.472643 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:33:43.477262 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:33:43.477762 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:33:43.501475 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:33:43.502048 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:43.502294 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:33:43.502488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:43.507048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:33:43.507304 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:43.507509 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:33:43.508045 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                ^

[0m06:33:43.508290 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:33:43.508816 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:33:43.511504 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                  ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:33:43.512983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759acfeacfe0>]}
[0m06:33:43.513736 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:33:43.514225 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:33:43.514666 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                  ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:33:43.515807 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:33:43.516103 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m06:33:43.516360 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:33:43.517985 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.518485 [debug] [MainThread]: On master: BEGIN
[0m06:33:43.518738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:33:43.523835 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:33:43.524236 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.524460 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.524660 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.525149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:43.525569 [debug] [MainThread]: On master: Close
[0m06:33:43.526156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:43.526477 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:33:43.526796 [info ] [MainThread]: 
[0m06:33:43.527076 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m06:33:43.528560 [debug] [MainThread]: Command end result
[0m06:33:43.541844 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:33:43.543288 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:33:43.547495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:33:43.547744 [info ] [MainThread]: 
[0m06:33:43.548005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:33:43.548228 [info ] [MainThread]: 
[0m06:33:43.548500 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                  ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:33:43.548701 [info ] [MainThread]: 
[0m06:33:43.548927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m06:33:43.549675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.757676, "process_in_blocks": "0", "process_kernel_time": 0.260723, "process_mem_max_rss": "110372", "process_out_blocks": "2528", "process_user_time": 1.559919}
[0m06:33:43.550049 [debug] [MainThread]: Command `dbt run` failed at 06:33:43.549961 after 0.76 seconds
[0m06:33:43.550429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad95e40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad8b097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad7057cb0>]}
[0m06:33:43.550696 [debug] [MainThread]: Flushing usage events
[0m06:33:44.371198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:29.721050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab84bec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86fee900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86366060>]}


============================== 06:34:29.723843 | b6536add-4987-474d-bccf-7f4a7f28091f ==============================
[0m06:34:29.723843 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:29.724505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:34:29.839793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab8545cec0>]}
[0m06:34:29.886305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab849138c0>]}
[0m06:34:29.887067 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:29.936298 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:34:30.004801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:34:30.005301 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:34:30.200155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab82da1100>]}
[0m06:34:30.245600 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:30.247587 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:30.258550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab82cbaa50>]}
[0m06:34:30.258932 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:34:30.259199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab8308bd70>]}
[0m06:34:30.260402 [info ] [MainThread]: 
[0m06:34:30.260706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:30.260935 [info ] [MainThread]: 
[0m06:34:30.261330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:30.264576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:34:30.292597 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:34:30.292967 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:34:30.293172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:30.301973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m06:34:30.303367 [debug] [ThreadPool]: On list_db: Close
[0m06:34:30.304567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:34:30.308370 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:30.308689 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:34:30.308879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:30.313577 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.313842 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:30.314028 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:34:30.315797 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:34:30.316734 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:34:30.317090 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:34:30.321399 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.321686 [debug] [MainThread]: On master: BEGIN
[0m06:34:30.321890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:30.326620 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.326966 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.327211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:30.329683 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:34:30.330683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86740530>]}
[0m06:34:30.331028 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:30.331384 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.331595 [debug] [MainThread]: On master: BEGIN
[0m06:34:30.332027 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:30.332285 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.332471 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.332647 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.332931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:30.333152 [debug] [MainThread]: On master: Close
[0m06:34:30.335394 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:34:30.335827 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:34:30.336216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:34:30.336457 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:34:30.341182 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:34:30.341702 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:34:30.365918 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:34:30.366497 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.366980 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:34:30.367292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:30.372275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.372658 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.372901 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:34:30.379772 [debug] [Thread-1 (]: SQL status: SELECT 68 in 0.007 seconds
[0m06:34:30.383979 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.384361 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:34:30.385082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:30.386743 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.386976 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:34:30.387491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:30.399294 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:30.399639 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.399878 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:30.405436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:34:30.409159 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:34:30.412786 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.413051 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:34:30.444832 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m06:34:30.446719 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:34:30.447939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86696450>]}
[0m06:34:30.448562 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 68[0m in 0.11s]
[0m06:34:30.448968 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:34:30.450176 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:34:30.451007 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m06:34:30.451784 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:34:30.452173 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m06:34:30.454509 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:34:30.455269 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m06:34:30.457316 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:34:30.458035 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.458292 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m06:34:30.458496 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:34:30.463763 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.464323 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.464610 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:34:30.473954 [debug] [Thread-3 (]: SQL status: SELECT 68 in 0.009 seconds
[0m06:34:30.476158 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.476433 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:34:30.476929 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:30.477830 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:34:30.478056 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.478250 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:34:30.480223 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:34:30.482476 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:34:30.482867 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.483107 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:34:30.483554 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:34:30.484464 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m06:34:30.484882 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab80169f40>]}
[0m06:34:30.485297 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 68[0m in 0.03s]
[0m06:34:30.485659 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:34:30.487674 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.488173 [debug] [MainThread]: On master: BEGIN
[0m06:34:30.488409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:30.492885 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:34:30.493198 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.493398 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.493581 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.493977 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:30.494215 [debug] [MainThread]: On master: Close
[0m06:34:30.494558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:30.494746 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:34:30.494904 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:34:30.495160 [info ] [MainThread]: 
[0m06:34:30.495390 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m06:34:30.496131 [debug] [MainThread]: Command end result
[0m06:34:30.509179 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:30.510541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:30.514723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:34:30.514990 [info ] [MainThread]: 
[0m06:34:30.515262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:30.515534 [info ] [MainThread]: 
[0m06:34:30.516408 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:34:30.517966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8695422, "process_in_blocks": "0", "process_kernel_time": 0.291748, "process_mem_max_rss": "110160", "process_out_blocks": "2552", "process_user_time": 1.626716}
[0m06:34:30.518393 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:30.518304 after 0.87 seconds
[0m06:34:30.518674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab84bec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab831aeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab8300d5b0>]}
[0m06:34:30.518950 [debug] [MainThread]: Flushing usage events
[0m06:34:31.323832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:37:59.426424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81a206a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81bec3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81a205e80>]}


============================== 06:37:59.429040 | f6a22583-ea0f-49eb-b743-3af94ceee28a ==============================
[0m06:37:59.429040 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:37:59.429419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:37:59.557318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa819cf9700>]}
[0m06:37:59.601895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8184f7a40>]}
[0m06:37:59.602701 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:37:59.647823 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:37:59.719581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:37:59.720148 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:37:59.920117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa818187c50>]}
[0m06:37:59.970400 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:37:59.972453 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:37:59.984101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81805e8a0>]}
[0m06:37:59.984478 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:37:59.984745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa818050f50>]}
[0m06:37:59.985957 [info ] [MainThread]: 
[0m06:37:59.986255 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:37:59.986472 [info ] [MainThread]: 
[0m06:37:59.986846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:37:59.989674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:38:00.020663 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:38:00.020990 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:38:00.021183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:00.029200 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m06:38:00.030202 [debug] [ThreadPool]: On list_db: Close
[0m06:38:00.031577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:38:00.035263 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:38:00.035662 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:38:00.035877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:00.040132 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:38:00.040357 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:38:00.040691 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:00.042700 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:38:00.043926 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:38:00.044454 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:38:00.050279 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.050618 [debug] [MainThread]: On master: BEGIN
[0m06:38:00.050817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:00.055709 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:00.056071 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.056344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:00.059301 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:38:00.060402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81ba90500>]}
[0m06:38:00.060787 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:00.061170 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.061390 [debug] [MainThread]: On master: BEGIN
[0m06:38:00.061875 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:00.062109 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.062300 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.062485 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.062838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:00.063175 [debug] [MainThread]: On master: Close
[0m06:38:00.065505 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:38:00.065905 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:38:00.066238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:38:00.066472 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:38:00.071863 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:38:00.072362 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:38:00.098003 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:38:00.098636 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.098911 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:38:00.099145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:00.103671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:38:00.103959 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.104174 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:38:00.110669 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:38:00.115201 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.115612 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:38:00.116354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.118025 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.118254 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:38:00.118691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.131174 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:38:00.131600 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.131817 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:38:00.137180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:38:00.141330 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:38:00.145138 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.145494 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:38:00.148677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:38:00.151396 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:38:00.152717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8144cf8f0>]}
[0m06:38:00.153242 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.09s]
[0m06:38:00.154157 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:38:00.154998 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:38:00.155531 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m06:38:00.155936 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:38:00.156156 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m06:38:00.158057 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:38:00.158512 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m06:38:00.160426 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:38:00.160979 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.161207 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m06:38:00.161404 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:38:00.166233 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:38:00.166616 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.166847 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:38:00.172365 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:38:00.174867 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.175165 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:38:00.175884 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.178664 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.178920 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:38:00.179575 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.180624 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:38:00.180939 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.181182 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:38:00.183464 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:38:00.185252 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:38:00.185666 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.185883 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:38:00.188386 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:38:00.189317 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m06:38:00.189752 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8181ad700>]}
[0m06:38:00.190173 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.03s]
[0m06:38:00.190532 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:38:00.192045 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.192282 [debug] [MainThread]: On master: BEGIN
[0m06:38:00.192472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:00.197852 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:00.198278 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.198534 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.198769 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.199505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:00.199855 [debug] [MainThread]: On master: Close
[0m06:38:00.200303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:00.200539 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:38:00.200762 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:38:00.201122 [info ] [MainThread]: 
[0m06:38:00.201539 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m06:38:00.202844 [debug] [MainThread]: Command end result
[0m06:38:00.216982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:38:00.218560 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:38:00.222922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:38:00.223190 [info ] [MainThread]: 
[0m06:38:00.223591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:00.223827 [info ] [MainThread]: 
[0m06:38:00.224264 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:38:00.225366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8662028, "process_in_blocks": "0", "process_kernel_time": 0.287998, "process_mem_max_rss": "109840", "process_out_blocks": "2568", "process_user_time": 1.688111}
[0m06:38:00.225798 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:00.225707 after 0.87 seconds
[0m06:38:00.226101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81a162b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8181a33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa819f8c980>]}
[0m06:38:00.226398 [debug] [MainThread]: Flushing usage events
[0m06:38:01.024121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:43:16.451356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bd256900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bca33bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bd256630>]}


============================== 06:43:16.455251 | ee6ce91e-7b04-42ce-8199-a1892dff6441 ==============================
[0m06:43:16.455251 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:43:16.455668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:16.587789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc7a6360>]}
[0m06:43:16.632000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bdbb5940>]}
[0m06:43:16.632714 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:43:16.677886 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:43:16.757420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:43:16.757958 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/daily_avg.sql
[0m06:43:16.945835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295baaa52e0>]}
[0m06:43:16.993303 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:43:16.995066 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:43:17.005899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bab7b020>]}
[0m06:43:17.006282 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:43:17.006530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bac63d70>]}
[0m06:43:17.007660 [info ] [MainThread]: 
[0m06:43:17.007942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:17.008161 [info ] [MainThread]: 
[0m06:43:17.008502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:17.011345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:43:17.041416 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:43:17.041797 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:43:17.042010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:17.049356 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:43:17.050503 [debug] [ThreadPool]: On list_db: Close
[0m06:43:17.051986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:43:17.056578 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:43:17.056824 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:43:17.057003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:17.061305 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:43:17.061592 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:43:17.061796 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:43:17.063914 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:43:17.064904 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:43:17.065453 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:43:17.069147 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.069480 [debug] [MainThread]: On master: BEGIN
[0m06:43:17.069677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:17.074253 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:43:17.074561 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.074814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:17.077461 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:43:17.078447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b87c2b10>]}
[0m06:43:17.078790 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:17.079227 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.079478 [debug] [MainThread]: On master: BEGIN
[0m06:43:17.079908 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:43:17.080185 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.080593 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.080913 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.081410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:17.081678 [debug] [MainThread]: On master: Close
[0m06:43:17.084024 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:43:17.084435 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:43:17.084770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:43:17.085008 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:43:17.089558 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:43:17.090098 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:43:17.114330 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:43:17.114906 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.115160 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:43:17.115366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:17.119869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:43:17.120136 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.120347 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:43:17.127556 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:43:17.132222 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.132601 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:43:17.133302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:17.135649 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.135965 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:43:17.136502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:17.149624 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:43:17.149987 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.150200 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:43:17.154675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m06:43:17.159882 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:43:17.163097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.163357 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:43:17.166219 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:43:17.167978 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:43:17.169112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295be5166c0>]}
[0m06:43:17.169593 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.08s]
[0m06:43:17.170133 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:43:17.171217 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:43:17.171578 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:43:17.172030 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:43:17.172641 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:43:17.173273 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:43:17.173724 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:43:17.174052 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:43:17.174343 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:43:17.176263 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:43:17.178026 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:43:17.178552 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:43:17.181621 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:43:17.182094 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:43:17.184095 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:43:17.184694 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:43:17.185499 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:43:17.185855 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:43:17.186179 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.186566 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:43:17.186768 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:43:17.190996 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:43:17.191386 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:43:17.191646 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed,
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:43:17.191995 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m06:43:17.192328 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.192567 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 19: from "db"."dev"."staging"
         ^

[0m06:43:17.192860 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:43:17.193166 [debug] [Thread-3 (]: On model.my_project.daily_avg: ROLLBACK
[0m06:43:17.193748 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:43:17.199232 [debug] [Thread-3 (]: Database Error in model daily_avg (models/mart/daily_avg.sql)
  syntax error at or near "from"
  LINE 19: from "db"."dev"."staging"
           ^
  compiled code at target/run/my_project/models/mart/daily_avg.sql
[0m06:43:17.199753 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:43:17.200418 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bae7f860>]}
[0m06:43:17.202984 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.203774 [error] [Thread-3 (]: 2 of 3 ERROR creating sql table model dev.daily_avg ............................ [[31mERROR[0m in 0.03s]
[0m06:43:17.204276 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:43:17.204770 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:43:17.205561 [debug] [Thread-7 (]: Marking all children of 'model.my_project.daily_avg' to be skipped because of status 'error'.  Reason: Database Error in model daily_avg (models/mart/daily_avg.sql)
  syntax error at or near "from"
  LINE 19: from "db"."dev"."staging"
           ^
  compiled code at target/run/my_project/models/mart/daily_avg.sql.
[0m06:43:17.205940 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:17.208654 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.208955 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:43:17.209536 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:17.210786 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:43:17.211072 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.211304 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:43:17.213461 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:43:17.214878 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:43:17.215338 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.215574 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:43:17.218217 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:43:17.219214 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:43:17.219672 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b821cc50>]}
[0m06:43:17.220082 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m06:43:17.220439 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:43:17.221966 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.222205 [debug] [MainThread]: On master: BEGIN
[0m06:43:17.222393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:17.226659 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:43:17.226930 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.227123 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.227311 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.227678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:17.227939 [debug] [MainThread]: On master: Close
[0m06:43:17.228281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:17.228481 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:43:17.228653 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:43:17.228819 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:43:17.229333 [info ] [MainThread]: 
[0m06:43:17.229863 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m06:43:17.231227 [debug] [MainThread]: Command end result
[0m06:43:17.246298 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:43:17.247878 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:43:17.252939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:43:17.253304 [info ] [MainThread]: 
[0m06:43:17.253644 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:43:17.253963 [info ] [MainThread]: 
[0m06:43:17.254373 [error] [MainThread]:   Database Error in model daily_avg (models/mart/daily_avg.sql)
  syntax error at or near "from"
  LINE 19: from "db"."dev"."staging"
           ^
  compiled code at target/run/my_project/models/mart/daily_avg.sql
[0m06:43:17.254631 [info ] [MainThread]: 
[0m06:43:17.254960 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m06:43:17.255927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8733757, "process_in_blocks": "0", "process_kernel_time": 0.212605, "process_mem_max_rss": "110324", "process_out_blocks": "2616", "process_user_time": 1.762851}
[0m06:43:17.256399 [debug] [MainThread]: Command `dbt run` failed at 06:43:17.256248 after 0.87 seconds
[0m06:43:17.256735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc832db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bff6a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bab85be0>]}
[0m06:43:17.257014 [debug] [MainThread]: Flushing usage events
[0m06:43:18.048588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:44:54.204878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f97229dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971a51d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971562480>]}


============================== 06:44:54.207117 | f6ee715e-0f29-41cf-98cf-e5f1d2f4d093 ==============================
[0m06:44:54.207117 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:44:54.207512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:44:54.322925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f970f74ce0>]}
[0m06:44:54.363635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971b8fe00>]}
[0m06:44:54.364380 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:44:54.410060 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:44:54.479579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:44:54.480061 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/daily_avg.sql
[0m06:44:54.671868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f9710f1880>]}
[0m06:44:54.722088 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:44:54.723893 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:44:54.737365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f2e6f90>]}
[0m06:44:54.737733 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:44:54.737983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f6c2960>]}
[0m06:44:54.739143 [info ] [MainThread]: 
[0m06:44:54.739415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:44:54.739603 [info ] [MainThread]: 
[0m06:44:54.739947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:44:54.742688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:44:54.769835 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:44:54.770185 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:44:54.770387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:54.777216 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:44:54.778772 [debug] [ThreadPool]: On list_db: Close
[0m06:44:54.780408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:44:54.783956 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:44:54.784221 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:44:54.784400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:44:54.788469 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.788736 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:44:54.788923 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:44:54.791005 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:44:54.792074 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:44:54.792472 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:44:54.797253 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.797546 [debug] [MainThread]: On master: BEGIN
[0m06:44:54.797741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:44:54.802220 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.802506 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.802744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:44:54.805520 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:44:54.806522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f6c2960>]}
[0m06:44:54.806892 [debug] [MainThread]: On master: ROLLBACK
[0m06:44:54.807302 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.807507 [debug] [MainThread]: On master: BEGIN
[0m06:44:54.807905 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:44:54.808120 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.808311 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.808485 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.808808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:44:54.809007 [debug] [MainThread]: On master: Close
[0m06:44:54.811202 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:44:54.811658 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:44:54.811993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:44:54.812226 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:44:54.816752 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:44:54.817238 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:44:54.840847 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:44:54.841409 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.841657 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:44:54.841855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:44:54.846395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.846648 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.846870 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:44:54.852373 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:44:54.856652 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.856958 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:44:54.857488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.859123 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.859358 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:44:54.859711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.871665 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:44:54.871997 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.872233 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:44:54.910312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m06:44:54.916683 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:44:54.919982 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.920241 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:44:54.923846 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:44:54.927129 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:44:54.928557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f972cca360>]}
[0m06:44:54.929024 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.12s]
[0m06:44:54.929400 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:44:54.930379 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:44:54.930692 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:44:54.931213 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:44:54.931772 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:44:54.932394 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:44:54.933038 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:44:54.933394 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:44:54.933659 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:44:54.935579 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:44:54.937482 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:44:54.938067 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:44:54.938325 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:44:54.940292 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:44:54.943574 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:44:54.944293 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.944587 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:44:54.945007 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.945439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:44:54.945750 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:44:54.946148 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:44:54.950641 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m06:44:54.951015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:44:54.951308 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.951597 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.951873 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:44:54.952162 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:44:54.957333 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:44:54.959463 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.959748 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:44:54.960011 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:44:54.961701 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.961976 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:44:54.962277 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:44:54.963803 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.964156 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:44:54.964428 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.964711 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.965622 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:44:54.966580 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:44:54.966875 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.967146 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.967421 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:44:54.967701 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:44:54.970018 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:44:54.971294 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:44:54.971564 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:44:54.972058 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.973519 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:44:54.973843 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:44:54.974263 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.974600 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:44:54.974930 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:44:54.975759 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:44:54.976169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f82eb70>]}
[0m06:44:54.976622 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.04s]
[0m06:44:54.977000 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:44:54.977245 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:44:54.978337 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:44:54.978714 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96c1a2ed0>]}
[0m06:44:54.979082 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m06:44:54.979431 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:44:54.980758 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.980990 [debug] [MainThread]: On master: BEGIN
[0m06:44:54.981172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:44:54.985538 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.986052 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.986313 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.986505 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.986877 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:44:54.987133 [debug] [MainThread]: On master: Close
[0m06:44:54.987513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:54.987737 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:44:54.987933 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:44:54.988105 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:44:54.988456 [info ] [MainThread]: 
[0m06:44:54.988740 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m06:44:54.989595 [debug] [MainThread]: Command end result
[0m06:44:55.004663 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:44:55.007002 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:44:55.017551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:44:55.018112 [info ] [MainThread]: 
[0m06:44:55.018543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:44:55.019024 [info ] [MainThread]: 
[0m06:44:55.019457 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:44:55.021080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8758612, "process_in_blocks": "0", "process_kernel_time": 0.198539, "process_mem_max_rss": "110596", "process_out_blocks": "2616", "process_user_time": 1.650086}
[0m06:44:55.021841 [debug] [MainThread]: Command `dbt run` succeeded at 06:44:55.021663 after 0.88 seconds
[0m06:44:55.022459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f9713ff530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f972cca360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971a04b60>]}
[0m06:44:55.023073 [debug] [MainThread]: Flushing usage events
[0m06:44:55.809210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:14:55.447547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb836840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb69e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb6ee540>]}


============================== 07:14:55.453872 | 5f703c84-23fb-4579-9d15-272dd4fa2b2e ==============================
[0m07:14:55.453872 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:14:55.454280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:14:55.627958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfbe888c0>]}
[0m07:14:55.677893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df98b8050>]}
[0m07:14:55.678696 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:14:55.765503 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:14:55.841547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:55.841876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:55.866007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df9973b90>]}
[0m07:14:55.920593 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:14:55.922513 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:14:55.941682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df98a2660>]}
[0m07:14:55.942147 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:14:55.942531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb200110>]}
[0m07:14:55.944126 [info ] [MainThread]: 
[0m07:14:55.944636 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:55.945025 [info ] [MainThread]: 
[0m07:14:55.945785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:14:55.948710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:14:55.983039 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:14:55.983393 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:14:55.983793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:55.994335 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m07:14:55.995674 [debug] [ThreadPool]: On list_db: Close
[0m07:14:55.997135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:14:56.000920 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:14:56.001179 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:14:56.001358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:56.007258 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:14:56.007510 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:14:56.007720 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:14:56.010088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:14:56.011306 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:14:56.011858 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:14:56.016749 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.017156 [debug] [MainThread]: On master: BEGIN
[0m07:14:56.017432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:14:56.023279 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:14:56.023700 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.024358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:14:56.027366 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:14:56.028985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb274980>]}
[0m07:14:56.029538 [debug] [MainThread]: On master: ROLLBACK
[0m07:14:56.030188 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.030499 [debug] [MainThread]: On master: BEGIN
[0m07:14:56.031136 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:14:56.031575 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.031844 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.032112 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.032532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:14:56.032818 [debug] [MainThread]: On master: Close
[0m07:14:56.035167 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:14:56.035551 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:14:56.035877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:14:56.036087 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:14:56.040458 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:14:56.041073 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:14:56.066320 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:14:56.066874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.067117 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:14:56.067316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:56.073106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:14:56.073402 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.073636 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:14:56.081324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m07:14:56.086011 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.086286 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:14:56.086818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:14:56.097710 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:14:56.098244 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.098519 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:14:56.120711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m07:14:56.129369 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:14:56.136653 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.137091 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:14:56.138584 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:14:56.140447 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:14:56.141593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfd0fe600>]}
[0m07:14:56.142051 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m07:14:56.142422 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:14:56.143494 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:14:56.143909 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:14:56.144611 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:14:56.145078 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:14:56.145630 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:14:56.146205 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:14:56.146860 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:14:56.146582 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:14:56.149395 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:14:56.152274 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:14:56.153065 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:14:56.153367 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:14:56.156071 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:14:56.158033 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:14:56.158767 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.159136 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:14:56.159824 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:14:56.160218 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.160616 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:14:56.161123 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:14:56.166578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m07:14:56.167286 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.167717 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m07:14:56.168012 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:14:56.168405 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.168914 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:14:56.177946 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m07:14:56.182612 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.183297 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m07:14:56.186990 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.187238 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:14:56.187990 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:14:56.183713 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:14:56.188946 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:14:56.189441 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.189624 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:14:56.190969 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:14:56.192118 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:14:56.192386 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.192613 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:14:56.192907 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m07:14:56.195743 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:14:56.196562 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.196928 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:14:56.198001 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:14:56.199270 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:14:56.199733 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df87d7b90>]}
[0m07:14:56.200162 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.05s]
[0m07:14:56.200509 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:14:56.201001 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m07:14:56.203157 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:14:56.204466 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.204839 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:14:56.205546 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:14:56.206771 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:14:56.208418 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df87e53d0>]}
[0m07:14:56.213223 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m07:14:56.213689 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:14:56.215049 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.215307 [debug] [MainThread]: On master: BEGIN
[0m07:14:56.215483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:14:56.235819 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m07:14:56.236212 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.236418 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.236616 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.236975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:14:56.237222 [debug] [MainThread]: On master: Close
[0m07:14:56.237597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:56.237786 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:14:56.237991 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:14:56.238147 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:14:56.238459 [info ] [MainThread]: 
[0m07:14:56.238711 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:14:56.239415 [debug] [MainThread]: Command end result
[0m07:14:56.253496 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:14:56.255329 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:14:56.260630 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:14:56.260964 [info ] [MainThread]: 
[0m07:14:56.261631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:14:56.262811 [info ] [MainThread]: 
[0m07:14:56.263767 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:14:56.265025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85888064, "process_in_blocks": "1376", "process_kernel_time": 0.354395, "process_mem_max_rss": "107932", "process_out_blocks": "3392", "process_user_time": 1.668798}
[0m07:14:56.265406 [debug] [MainThread]: Command `dbt run` succeeded at 07:14:56.265328 after 0.86 seconds
[0m07:14:56.265767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb1bfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df98ebb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb4fca70>]}
[0m07:14:56.266200 [debug] [MainThread]: Flushing usage events
[0m07:14:57.272338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:23:15.091610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f96642000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f95182ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f952085c0>]}


============================== 07:23:15.095327 | 664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5 ==============================
[0m07:23:15.095327 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:23:15.096228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:23:15.246992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94af24b0>]}
[0m07:23:15.292729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94b52000>]}
[0m07:23:15.293450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:23:15.342030 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:23:15.417611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:23:15.418006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:23:15.443763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94565280>]}
[0m07:23:15.511289 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:23:15.513494 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:23:15.528131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f92a08110>]}
[0m07:23:15.528527 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:23:15.528804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94648e30>]}
[0m07:23:15.530029 [info ] [MainThread]: 
[0m07:23:15.530297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:23:15.530501 [info ] [MainThread]: 
[0m07:23:15.530857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:23:15.533582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:23:15.565882 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:23:15.566207 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:23:15.566378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:19.305490 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m07:23:22.824587 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:23:22.825107 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:23:22.825606 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:23:22.825873 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:23:22.826152 [debug] [ThreadPool]: On list_db: No close available on handle
[0m07:23:22.827160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:22.827616 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m07:23:22.828150 [info ] [MainThread]: 
[0m07:23:22.828490 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m07:23:22.828927 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m07:23:22.831372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.815302, "process_in_blocks": "0", "process_kernel_time": 0.246595, "process_mem_max_rss": "102948", "process_out_blocks": "872", "process_user_time": 1.623046}
[0m07:23:22.831762 [debug] [MainThread]: Command `dbt run` failed at 07:23:22.831689 after 7.82 seconds
[0m07:23:22.831988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94af1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f929fb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f929d3380>]}
[0m07:23:22.832205 [debug] [MainThread]: Flushing usage events
[0m07:23:24.020782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:05.533567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f595d0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f59ebfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f593d8470>]}


============================== 07:31:05.540896 | aa1d46d1-960e-40d2-9f73-aefde062b5d2 ==============================
[0m07:31:05.540896 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:31:05.541648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:31:05.719155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f59446960>]}
[0m07:31:05.765157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f57a7b8f0>]}
[0m07:31:05.765926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:31:05.829230 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:31:05.905867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:31:05.923775 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m07:31:06.141226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f57746e40>]}
[0m07:31:06.192002 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:31:06.193791 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:31:06.213793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f55165010>]}
[0m07:31:06.214500 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:31:06.215032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5786b3b0>]}
[0m07:31:06.216760 [info ] [MainThread]: 
[0m07:31:06.217191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:06.217913 [info ] [MainThread]: 
[0m07:31:06.219308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:06.223005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:31:06.250696 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:31:06.251048 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:31:06.251236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:06.261744 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m07:31:06.262758 [debug] [ThreadPool]: On list_db: Close
[0m07:31:06.263477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:31:06.263814 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:31:06.266918 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:31:06.267146 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:31:06.267313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:06.271952 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:31:06.272544 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:31:06.272875 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:31:06.273421 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:31:06.274067 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:31:06.274312 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:31:06.274479 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:31:06.277487 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m07:31:06.277734 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:31:06.279008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:31:06.282971 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:31:06.283281 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:31:06.283453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:06.288125 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:31:06.288408 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:31:06.288833 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:31:06.291684 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:31:06.292514 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:31:06.292862 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:31:06.295977 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.296269 [debug] [MainThread]: On master: BEGIN
[0m07:31:06.296460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:06.301048 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:31:06.301375 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.301602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:06.303517 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m07:31:06.304451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f57650170>]}
[0m07:31:06.304786 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:06.305134 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.305334 [debug] [MainThread]: On master: BEGIN
[0m07:31:06.305894 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:31:06.306271 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.306551 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.306853 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.307210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:06.307515 [debug] [MainThread]: On master: Close
[0m07:31:06.312168 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:31:06.312737 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:31:06.313115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:31:06.313342 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:31:06.319030 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:31:06.319512 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:31:06.351893 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:31:06.352436 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:31:06.352675 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:31:06.352867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:06.359727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:31:06.360321 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:31:06.360831 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:31:06.361871 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_weather_data" does not exist
LINE 15:     select * from "db"."dev"."raw_weather_data"
                           ^

[0m07:31:06.362204 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:31:06.362830 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:31:06.375241 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:31:06.376568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5453c380>]}
[0m07:31:06.377080 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.06s]
[0m07:31:06.377493 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:31:06.377922 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:31:06.379088 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:31:06.379477 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:31:06.379908 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_avg ............................................. [[33mSKIP[0m]
[0m07:31:06.380182 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m07:31:06.381410 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:31:06.381110 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:31:06.383503 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.384109 [debug] [MainThread]: On master: BEGIN
[0m07:31:06.384298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:06.390834 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:31:06.391326 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.391629 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.391990 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.392445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:06.392704 [debug] [MainThread]: On master: Close
[0m07:31:06.393045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:06.393213 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:31:06.393442 [info ] [MainThread]: 
[0m07:31:06.393673 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m07:31:06.394249 [debug] [MainThread]: Command end result
[0m07:31:06.411724 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:31:06.412996 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:31:06.420465 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:31:06.420808 [info ] [MainThread]: 
[0m07:31:06.421416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:31:06.421953 [info ] [MainThread]: 
[0m07:31:06.422862 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:31:06.423539 [info ] [MainThread]: 
[0m07:31:06.424291 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m07:31:06.425049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9459884, "process_in_blocks": "0", "process_kernel_time": 0.372149, "process_mem_max_rss": "110804", "process_out_blocks": "4168", "process_user_time": 1.878681}
[0m07:31:06.425427 [debug] [MainThread]: Command `dbt run` failed at 07:31:06.425354 after 0.95 seconds
[0m07:31:06.425685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5caee930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f594475f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f596576b0>]}
[0m07:31:06.425937 [debug] [MainThread]: Flushing usage events
[0m07:31:07.534450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:34:13.712497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ee34db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ee484140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eca0fc80>]}


============================== 07:34:13.718115 | e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0 ==============================
[0m07:34:13.718115 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:34:13.718681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:34:13.952594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eca43110>]}
[0m07:34:14.022094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ec4c1d30>]}
[0m07:34:14.022998 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:34:14.095404 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:34:14.192270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:34:14.193077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:34:14.230561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eac45400>]}
[0m07:34:14.315920 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:34:14.318248 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:34:14.352302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eab93920>]}
[0m07:34:14.352826 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:34:14.353172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ea9249e0>]}
[0m07:34:14.355461 [info ] [MainThread]: 
[0m07:34:14.355990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:34:14.358697 [info ] [MainThread]: 
[0m07:34:14.360270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:34:14.366115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:34:14.429296 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:34:14.430016 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:34:14.430550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:14.446110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m07:34:14.448243 [debug] [ThreadPool]: On list_db: Close
[0m07:34:14.449804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:34:14.450559 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:34:14.458200 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:14.458947 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:34:14.459276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:14.467120 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:34:14.467884 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:14.468679 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:34:14.470033 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m07:34:14.471352 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:34:14.471875 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:14.472324 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:34:14.475858 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m07:34:14.476271 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:34:14.478366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:34:14.483016 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:34:14.483362 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:34:14.483591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:14.492379 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:34:14.493292 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:34:14.493787 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:34:14.497743 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m07:34:14.498911 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:34:14.499585 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:34:14.506445 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.507062 [debug] [MainThread]: On master: BEGIN
[0m07:34:14.507493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:14.516998 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:34:14.517433 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.517763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:34:14.521466 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:34:14.522843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ee2ac230>]}
[0m07:34:14.523333 [debug] [MainThread]: On master: ROLLBACK
[0m07:34:14.524023 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.524383 [debug] [MainThread]: On master: BEGIN
[0m07:34:14.525797 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:34:14.526710 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.527010 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.527254 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.527868 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:14.528365 [debug] [MainThread]: On master: Close
[0m07:34:14.532362 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:34:14.533014 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:34:14.533474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:34:14.533787 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:34:14.543454 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:34:14.545808 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:34:14.577655 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:34:14.578306 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:34:14.578648 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:34:14.578934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:14.586964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:34:14.587402 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:34:14.587696 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:34:14.588671 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_weather_data" does not exist
LINE 15:     select * from "db"."dev"."raw_weather_data"
                           ^

[0m07:34:14.589306 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:34:14.590210 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:34:14.597662 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:34:14.600150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ecffa2a0>]}
[0m07:34:14.601528 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.07s]
[0m07:34:14.602553 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:34:14.603670 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:34:14.606396 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:34:14.607548 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_avg ............................................. [[33mSKIP[0m]
[0m07:34:14.608786 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:34:14.609508 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m07:34:14.610103 [info ] [Thread-3 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m07:34:14.610804 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m07:34:14.615046 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.615447 [debug] [MainThread]: On master: BEGIN
[0m07:34:14.615684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:14.625272 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:34:14.626637 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.626911 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.627121 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.627736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:14.628095 [debug] [MainThread]: On master: Close
[0m07:34:14.628642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:14.628986 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:34:14.629364 [info ] [MainThread]: 
[0m07:34:14.629692 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m07:34:14.630339 [debug] [MainThread]: Command end result
[0m07:34:14.657395 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:34:14.659552 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:34:14.664866 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:34:14.665224 [info ] [MainThread]: 
[0m07:34:14.665553 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:34:14.666083 [info ] [MainThread]: 
[0m07:34:14.666743 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:34:14.667260 [info ] [MainThread]: 
[0m07:34:14.667919 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m07:34:14.673616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0083218, "process_in_blocks": "8", "process_kernel_time": 0.431906, "process_mem_max_rss": "107520", "process_out_blocks": "3344", "process_user_time": 2.582531}
[0m07:34:14.674963 [debug] [MainThread]: Command `dbt run` failed at 07:34:14.674690 after 1.01 seconds
[0m07:34:14.675826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ece96270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563e9dc17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ecbcb4d0>]}
[0m07:34:14.676217 [debug] [MainThread]: Flushing usage events
[0m07:34:15.792748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:38:10.613420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8be0e3e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf5e6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdfc934d0>]}


============================== 07:38:10.619749 | 9a083326-280a-4dcd-b0bf-505373c42a09 ==============================
[0m07:38:10.619749 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:38:10.621029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:38:10.839738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf16d6a0>]}
[0m07:38:10.924118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf5e6c30>]}
[0m07:38:10.925047 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:38:10.999648 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:38:11.097937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:11.098382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:11.129642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdef769f0>]}
[0m07:38:11.183070 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:38:11.184961 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:38:11.203415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdd4508c0>]}
[0m07:38:11.203862 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:38:11.204223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdef296a0>]}
[0m07:38:11.205935 [info ] [MainThread]: 
[0m07:38:11.206199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:38:11.206749 [info ] [MainThread]: 
[0m07:38:11.207790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:38:11.211036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:38:11.238446 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:38:11.238761 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:38:11.238933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:11.249175 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m07:38:11.250458 [debug] [ThreadPool]: On list_db: Close
[0m07:38:11.251540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:38:11.252168 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:38:11.256298 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:38:11.256618 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:38:11.256811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:11.262585 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:38:11.263712 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:38:11.264228 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:38:11.265197 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m07:38:11.265862 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:38:11.266057 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:38:11.266215 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:38:11.269364 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m07:38:11.269931 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:38:11.272298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:38:11.277943 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:38:11.278303 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:38:11.278599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:11.286548 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:38:11.287154 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:38:11.287655 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:38:11.291179 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:38:11.292955 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:38:11.293598 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:38:11.299754 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.300234 [debug] [MainThread]: On master: BEGIN
[0m07:38:11.300617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:38:11.306567 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:38:11.306912 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.307238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:38:11.310279 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:38:11.311581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdd4fa960>]}
[0m07:38:11.312054 [debug] [MainThread]: On master: ROLLBACK
[0m07:38:11.312748 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.313197 [debug] [MainThread]: On master: BEGIN
[0m07:38:11.314074 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:38:11.314480 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.314815 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.315135 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.315711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:38:11.315999 [debug] [MainThread]: On master: Close
[0m07:38:11.319078 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:38:11.319569 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:38:11.319977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:38:11.320242 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:38:11.325204 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:38:11.326158 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:38:11.353144 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:38:11.353755 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:38:11.354002 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:38:11.354215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:11.359121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:38:11.359442 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:38:11.359664 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:38:11.360262 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_weather_data" does not exist
LINE 15:     select * from "db"."dev"."raw_weather_data"
                           ^

[0m07:38:11.360702 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:38:11.363938 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:38:11.369753 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:38:11.370973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdfacdf40>]}
[0m07:38:11.371474 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.05s]
[0m07:38:11.371841 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:38:11.372225 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:38:11.373252 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:38:11.373601 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:38:11.373891 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_avg ............................................. [[33mSKIP[0m]
[0m07:38:11.374251 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m07:38:11.374586 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:38:11.374861 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:38:11.378119 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.378429 [debug] [MainThread]: On master: BEGIN
[0m07:38:11.378603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:38:11.385633 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:38:11.386456 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.387064 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.387353 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.387718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:38:11.387943 [debug] [MainThread]: On master: Close
[0m07:38:11.388533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:11.389222 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:38:11.389599 [info ] [MainThread]: 
[0m07:38:11.390039 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m07:38:11.391622 [debug] [MainThread]: Command end result
[0m07:38:11.411352 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:38:11.412718 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:38:11.416615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:38:11.416878 [info ] [MainThread]: 
[0m07:38:11.417296 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:38:11.417799 [info ] [MainThread]: 
[0m07:38:11.418632 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:38:11.419461 [info ] [MainThread]: 
[0m07:38:11.421718 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m07:38:11.423852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8566439, "process_in_blocks": "0", "process_kernel_time": 0.405231, "process_mem_max_rss": "107236", "process_out_blocks": "3344", "process_user_time": 2.21496}
[0m07:38:11.424353 [debug] [MainThread]: Command `dbt run` failed at 07:38:11.424240 after 0.86 seconds
[0m07:38:11.424830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf16d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf008290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf008860>]}
[0m07:38:11.425196 [debug] [MainThread]: Flushing usage events
[0m07:38:12.601879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:51:14.708378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c65606a0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655eb283e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655ecaa6f0>]}


============================== 06:51:14.714826 | 9e6fcce2-ed74-4295-91ce-b438a7db8a5c ==============================
[0m06:51:14.714826 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:51:14.715211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:51:14.928288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655f2a5490>]}
[0m06:51:14.970521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655ea3ab40>]}
[0m06:51:14.973186 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:51:15.027969 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:51:15.136557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:51:15.137037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:51:15.162966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655e674e90>]}
[0m06:51:15.216207 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:51:15.218420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:51:15.249180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655cb4cd40>]}
[0m06:51:15.249557 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:51:15.249967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655cb665a0>]}
[0m06:51:15.251656 [info ] [MainThread]: 
[0m06:51:15.251950 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:51:15.252142 [info ] [MainThread]: 
[0m06:51:15.252564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:51:15.255565 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:51:15.301179 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:51:15.301530 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:51:15.301715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:15.315612 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m06:51:15.316694 [debug] [ThreadPool]: On list_db: Close
[0m06:51:15.318091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:51:15.322014 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:51:15.322290 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:51:15.322483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:51:15.327451 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:51:15.327720 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:51:15.327932 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:51:15.330823 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:51:15.331982 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:51:15.332397 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:51:15.335831 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:15.336121 [debug] [MainThread]: On master: BEGIN
[0m06:51:15.336342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:51:15.341845 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:51:15.342404 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:15.342804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:51:15.346666 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:51:15.348533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655cb4c7a0>]}
[0m06:51:15.349073 [debug] [MainThread]: On master: ROLLBACK
[0m06:51:15.349614 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:15.349906 [debug] [MainThread]: On master: BEGIN
[0m06:51:15.350860 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:51:15.351208 [debug] [MainThread]: On master: COMMIT
[0m06:51:15.351514 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:15.351823 [debug] [MainThread]: On master: COMMIT
[0m06:51:15.352260 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:51:15.352614 [debug] [MainThread]: On master: Close
[0m06:51:15.355273 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:51:15.355756 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:51:15.356106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:51:15.356328 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:51:15.361179 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:51:15.361732 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:51:15.389133 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:51:15.389974 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:15.390222 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:51:15.390410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:51:15.395223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:51:15.395557 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:15.395813 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:51:15.402655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:51:15.406963 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:15.407247 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:51:15.408002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:15.419209 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:51:15.419570 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:15.419815 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:51:15.422199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:51:15.426135 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:51:15.429810 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:15.430064 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:51:15.431077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:51:15.433033 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:51:15.434906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6560622690>]}
[0m06:51:15.435630 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.08s]
[0m06:51:15.436273 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:51:15.437265 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:51:15.437949 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:51:15.437661 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:51:15.438932 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:51:15.438528 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:51:15.439368 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:51:15.439784 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:51:15.442629 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:51:15.442935 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:51:15.445668 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:51:15.446236 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:51:15.448232 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:51:15.448886 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:51:15.452013 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:51:15.452474 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:15.453044 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:51:15.453284 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:51:15.453956 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:15.454319 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:51:15.454633 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:51:15.458908 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m06:51:15.459573 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:15.460053 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:51:15.460359 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m06:51:15.460829 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:15.461183 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:51:15.466700 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:51:15.469028 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:15.469435 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:51:15.469791 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:51:15.471430 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:15.471813 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:51:15.472149 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:15.472469 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:15.473454 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:51:15.474371 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:51:15.474668 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:15.474954 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:15.475230 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:51:15.475489 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:51:15.477583 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:51:15.478970 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:51:15.479254 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:51:15.479664 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:15.481031 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:51:15.481353 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:51:15.481780 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:15.482162 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:51:15.482430 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:51:15.483415 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:51:15.483661 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:51:15.484597 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:51:15.484997 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655bd06ed0>]}
[0m06:51:15.485440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e6fcce2-ed74-4295-91ce-b438a7db8a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655bde2ae0>]}
[0m06:51:15.485898 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m06:51:15.487046 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:51:15.486583 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.05s]
[0m06:51:15.487895 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:51:15.489522 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:15.489751 [debug] [MainThread]: On master: BEGIN
[0m06:51:15.489942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:51:15.494582 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:51:15.494936 [debug] [MainThread]: On master: COMMIT
[0m06:51:15.495153 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:15.495368 [debug] [MainThread]: On master: COMMIT
[0m06:51:15.495833 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:51:15.496192 [debug] [MainThread]: On master: Close
[0m06:51:15.496718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:51:15.497045 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:51:15.497336 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:51:15.497598 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:51:15.498005 [info ] [MainThread]: 
[0m06:51:15.498387 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m06:51:15.499527 [debug] [MainThread]: Command end result
[0m06:51:15.516161 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:51:15.517516 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:51:15.521581 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:51:15.521804 [info ] [MainThread]: 
[0m06:51:15.522063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:51:15.522393 [info ] [MainThread]: 
[0m06:51:15.523021 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:51:15.525042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8579716, "process_in_blocks": "104712", "process_kernel_time": 0.365357, "process_mem_max_rss": "107452", "process_out_blocks": "3392", "process_user_time": 1.615047}
[0m06:51:15.525836 [debug] [MainThread]: Command `dbt run` succeeded at 06:51:15.525650 after 0.86 seconds
[0m06:51:15.526649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655eb31430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c65600bbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c655f04fef0>]}
[0m06:51:15.527222 [debug] [MainThread]: Flushing usage events
[0m06:51:16.565127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:02.917468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3280031fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e328016c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327ece3fb0>]}


============================== 09:06:02.931463 | 5429853f-972e-4b5d-bffd-d7561b767781 ==============================
[0m09:06:02.931463 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:06:02.932031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:06:03.270932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5429853f-972e-4b5d-bffd-d7561b767781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327e266a80>]}
[0m09:06:03.343754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5429853f-972e-4b5d-bffd-d7561b767781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e328193e870>]}
[0m09:06:03.386166 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:03.475498 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:06:03.641401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:06:03.641959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:06:03.681263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5429853f-972e-4b5d-bffd-d7561b767781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327e361c10>]}
[0m09:06:03.777915 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:06:03.781453 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:06:03.835635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5429853f-972e-4b5d-bffd-d7561b767781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327c62eae0>]}
[0m09:06:03.837756 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:06:03.838647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5429853f-972e-4b5d-bffd-d7561b767781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327e3f9280>]}
[0m09:06:03.841686 [info ] [MainThread]: 
[0m09:06:03.842572 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:06:03.843063 [info ] [MainThread]: 
[0m09:06:03.843741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:06:03.848620 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:06:03.938748 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:06:03.941781 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:06:03.942146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:06:07.722480 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:06:11.400944 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:06:11.402128 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:06:11.403056 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:06:11.403642 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:06:11.404176 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:06:11.405614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:06:11.406261 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:06:11.407004 [info ] [MainThread]: 
[0m09:06:11.407779 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.56 seconds (7.56s).
[0m09:06:11.408814 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:06:11.454477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.616235, "process_in_blocks": "13128", "process_kernel_time": 0.992816, "process_mem_max_rss": "103560", "process_out_blocks": "2480", "process_user_time": 2.428777}
[0m09:06:11.456011 [debug] [MainThread]: Command `dbt run` failed at 09:06:11.455614 after 8.62 seconds
[0m09:06:11.457147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327e360650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327c62eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e327c645e20>]}
[0m09:06:11.457995 [debug] [MainThread]: Flushing usage events
[0m09:06:12.653467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:44.364981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1870c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1870d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd1870d130>]}


============================== 09:06:44.369611 | 5c34201e-f0ea-4f01-b42f-b6912e437714 ==============================
[0m09:06:44.369611 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:06:44.369994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:06:44.549535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c34201e-f0ea-4f01-b42f-b6912e437714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd16dc5e20>]}
[0m09:06:44.597937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c34201e-f0ea-4f01-b42f-b6912e437714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd18e5b380>]}
[0m09:06:44.598689 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:44.656563 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:06:44.738436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:06:44.738796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:06:44.765787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c34201e-f0ea-4f01-b42f-b6912e437714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd16e4bfe0>]}
[0m09:06:44.822924 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:06:44.825997 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:06:44.845723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c34201e-f0ea-4f01-b42f-b6912e437714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd16bfdc70>]}
[0m09:06:44.846137 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:06:44.846400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c34201e-f0ea-4f01-b42f-b6912e437714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd16b6e3c0>]}
[0m09:06:44.847636 [info ] [MainThread]: 
[0m09:06:44.848006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:06:44.848437 [info ] [MainThread]: 
[0m09:06:44.848869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:06:44.852567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:06:44.890750 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:06:44.891113 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:06:44.891321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:06:54.014020 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:06:57.676029 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:06:57.676720 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:06:57.677419 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:06:57.677794 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:06:57.678576 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:06:57.680896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:06:57.681615 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:06:57.682529 [info ] [MainThread]: 
[0m09:06:57.684290 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.83 seconds (12.83s).
[0m09:06:57.685529 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:06:57.688262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.684273, "process_in_blocks": "4064", "process_kernel_time": 0.315173, "process_mem_max_rss": "103344", "process_out_blocks": "2472", "process_user_time": 1.731294}
[0m09:06:57.689063 [debug] [MainThread]: Command `dbt run` failed at 09:06:57.688904 after 11.69 seconds
[0m09:06:57.689817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd18e28800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd16c3c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd15df59a0>]}
[0m09:06:57.690588 [debug] [MainThread]: Flushing usage events
[0m09:06:58.709074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:43.472056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711378baa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711378704aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711379117b90>]}


============================== 09:07:43.477082 | 426108c2-f979-4a4b-80a2-1a8e18681b91 ==============================
[0m09:07:43.477082 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:07:43.480365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:07:43.652760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '426108c2-f979-4a4b-80a2-1a8e18681b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711378506780>]}
[0m09:07:43.704086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '426108c2-f979-4a4b-80a2-1a8e18681b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711378a1bbc0>]}
[0m09:07:43.704990 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:07:43.772308 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:07:43.858045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:07:43.858411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:07:43.890464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '426108c2-f979-4a4b-80a2-1a8e18681b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711376bd0fb0>]}
[0m09:07:43.953136 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:07:43.954883 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:07:43.972740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '426108c2-f979-4a4b-80a2-1a8e18681b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113768b71d0>]}
[0m09:07:43.973259 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:07:43.974015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '426108c2-f979-4a4b-80a2-1a8e18681b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711376be7d70>]}
[0m09:07:43.975673 [info ] [MainThread]: 
[0m09:07:43.975936 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:07:43.976120 [info ] [MainThread]: 
[0m09:07:43.976451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:07:43.979570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:07:44.009020 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:07:44.009522 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:07:44.009712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:47.808771 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:07:56.837932 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:07:56.838533 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:07:56.839022 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:07:56.839481 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:07:56.839952 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:07:56.840809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:56.841131 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:07:56.841472 [info ] [MainThread]: 
[0m09:07:56.841821 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.87 seconds (12.87s).
[0m09:07:56.842278 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:07:56.843177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.760515, "process_in_blocks": "0", "process_kernel_time": 0.236289, "process_mem_max_rss": "103360", "process_out_blocks": "2464", "process_user_time": 1.451492}
[0m09:07:56.843613 [debug] [MainThread]: Command `dbt run` failed at 09:07:56.843522 after 11.76 seconds
[0m09:07:56.844070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711378b1e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113768bdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711375b61640>]}
[0m09:07:56.844376 [debug] [MainThread]: Flushing usage events
[0m09:07:57.992827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:44.760317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdaa88db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdaa8374a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdac5883b0>]}


============================== 09:08:44.765190 | be87ed6e-b6ef-4bcf-8c3e-b629ac4ad8f0 ==============================
[0m09:08:44.765190 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:08:44.765556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:08:44.913404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be87ed6e-b6ef-4bcf-8c3e-b629ac4ad8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdaa57d760>]}
[0m09:08:44.985052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be87ed6e-b6ef-4bcf-8c3e-b629ac4ad8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdac446b10>]}
[0m09:08:44.985732 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:08:45.052664 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:08:45.132360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:45.132693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:45.176103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be87ed6e-b6ef-4bcf-8c3e-b629ac4ad8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdab4f9cd0>]}
[0m09:08:45.233097 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:08:45.234940 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:08:45.251185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be87ed6e-b6ef-4bcf-8c3e-b629ac4ad8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcda8abc800>]}
[0m09:08:45.251620 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:08:45.251879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be87ed6e-b6ef-4bcf-8c3e-b629ac4ad8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcda8b719a0>]}
[0m09:08:45.253067 [info ] [MainThread]: 
[0m09:08:45.253344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:08:45.253551 [info ] [MainThread]: 
[0m09:08:45.253913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:08:45.257115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:08:45.289326 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:08:45.289784 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:08:45.290011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:49.180239 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:08:52.833587 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:08:52.834078 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:08:52.834485 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:08:52.834782 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:08:52.835069 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:08:52.836171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:52.836646 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:08:52.837398 [info ] [MainThread]: 
[0m09:08:52.839926 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m09:08:52.841083 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:08:52.842666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.118539, "process_in_blocks": "0", "process_kernel_time": 0.271373, "process_mem_max_rss": "103280", "process_out_blocks": "2472", "process_user_time": 1.501034}
[0m09:08:52.846217 [debug] [MainThread]: Command `dbt run` failed at 09:08:52.845915 after 8.12 seconds
[0m09:08:52.846989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdaa88db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcdada49760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcda8a59e50>]}
[0m09:08:52.847699 [debug] [MainThread]: Flushing usage events
[0m09:08:53.941913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:09:43.786101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cbaf2fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cbaf2eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cbaf2ede0>]}


============================== 09:09:43.793807 | 39a584b1-f4ad-48fa-ab70-1f96a6008382 ==============================
[0m09:09:43.793807 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:09:43.795188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:09:43.959765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39a584b1-f4ad-48fa-ab70-1f96a6008382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cba36f6b0>]}
[0m09:09:44.004661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39a584b1-f4ad-48fa-ab70-1f96a6008382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cba4c0080>]}
[0m09:09:44.005488 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:09:44.077132 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:09:44.153495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:09:44.153841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:09:44.177195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39a584b1-f4ad-48fa-ab70-1f96a6008382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cb8be58b0>]}
[0m09:09:44.240336 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:09:44.242259 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:09:44.268597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39a584b1-f4ad-48fa-ab70-1f96a6008382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cb893dd90>]}
[0m09:09:44.269148 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:09:44.269807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a584b1-f4ad-48fa-ab70-1f96a6008382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cba4c36e0>]}
[0m09:09:44.271124 [info ] [MainThread]: 
[0m09:09:44.271931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:09:44.272634 [info ] [MainThread]: 
[0m09:09:44.273662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:09:44.277083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:09:44.309554 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:09:44.309885 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:09:44.310105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:48.090515 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:09:51.749749 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:09:51.750502 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:09:51.750959 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:09:51.751234 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:09:51.751551 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:09:51.752818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:51.753308 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:09:51.753669 [info ] [MainThread]: 
[0m09:09:51.754107 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m09:09:51.754611 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:09:51.755926 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.003722, "process_in_blocks": "0", "process_kernel_time": 0.260635, "process_mem_max_rss": "103508", "process_out_blocks": "2464", "process_user_time": 1.461265}
[0m09:09:51.756555 [debug] [MainThread]: Command `dbt run` failed at 09:09:51.756437 after 8.00 seconds
[0m09:09:51.756940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cba8ffc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cb87f9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cb8bb8350>]}
[0m09:09:51.757329 [debug] [MainThread]: Flushing usage events
[0m09:09:52.917034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:44.157235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7291354704a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7291339efb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729134070ec0>]}


============================== 09:10:44.162119 | 346a8762-4671-4d31-a77a-61b898dead4b ==============================
[0m09:10:44.162119 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:10:44.163079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:10:44.323504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '346a8762-4671-4d31-a77a-61b898dead4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729133502840>]}
[0m09:10:44.374010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '346a8762-4671-4d31-a77a-61b898dead4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729133447d40>]}
[0m09:10:44.374912 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:10:44.435170 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:10:44.525279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:10:44.525646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:10:44.551527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '346a8762-4671-4d31-a77a-61b898dead4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729131c73c50>]}
[0m09:10:44.611524 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:10:44.613387 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:10:44.636545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '346a8762-4671-4d31-a77a-61b898dead4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7291319f2de0>]}
[0m09:10:44.636964 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:10:44.637408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '346a8762-4671-4d31-a77a-61b898dead4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729134813aa0>]}
[0m09:10:44.638725 [info ] [MainThread]: 
[0m09:10:44.639421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:10:44.640160 [info ] [MainThread]: 
[0m09:10:44.640711 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:10:44.644369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:10:44.697898 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:10:44.698283 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:10:44.698534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:48.549754 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:10:52.219566 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:10:52.220501 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:10:52.221134 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:10:52.221487 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:10:52.222242 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:10:52.223580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:52.223959 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:10:52.224323 [info ] [MainThread]: 
[0m09:10:52.224758 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m09:10:52.225390 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:10:52.227037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.103481, "process_in_blocks": "64", "process_kernel_time": 0.258488, "process_mem_max_rss": "103488", "process_out_blocks": "2480", "process_user_time": 1.550929}
[0m09:10:52.228663 [debug] [MainThread]: Command `dbt run` failed at 09:10:52.228462 after 8.11 seconds
[0m09:10:52.229279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729133894470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729130be9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729131bee720>]}
[0m09:10:52.230060 [debug] [MainThread]: Flushing usage events
[0m09:10:53.444692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:44.767870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5bfeb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5c220ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5c2fe930>]}


============================== 09:11:44.775390 | 2fa3d6e6-5470-4c8c-81f2-e62ac0f11df0 ==============================
[0m09:11:44.775390 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:11:44.776079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:11:45.058056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fa3d6e6-5470-4c8c-81f2-e62ac0f11df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5a1662a0>]}
[0m09:11:45.135117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fa3d6e6-5470-4c8c-81f2-e62ac0f11df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5bf66b40>]}
[0m09:11:45.136157 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:11:45.216148 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:11:45.334120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:11:45.334730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:11:45.380442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fa3d6e6-5470-4c8c-81f2-e62ac0f11df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5a227e00>]}
[0m09:11:45.463681 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:11:45.467012 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:11:45.496440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fa3d6e6-5470-4c8c-81f2-e62ac0f11df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f59efc8c0>]}
[0m09:11:45.497069 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:11:45.497438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fa3d6e6-5470-4c8c-81f2-e62ac0f11df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f59f17e30>]}
[0m09:11:45.499397 [info ] [MainThread]: 
[0m09:11:45.499883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:11:45.501017 [info ] [MainThread]: 
[0m09:11:45.502112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:11:45.507130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:11:45.560297 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:11:45.560799 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:11:45.561138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:49.431368 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:11:53.125787 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:11:53.126184 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:53.126485 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:11:53.126696 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:53.126926 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:11:53.127649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:53.127880 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:11:53.128146 [info ] [MainThread]: 
[0m09:11:53.128418 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m09:11:53.128812 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:11:53.129681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.423489, "process_in_blocks": "424", "process_kernel_time": 0.384353, "process_mem_max_rss": "103604", "process_out_blocks": "2464", "process_user_time": 2.069597}
[0m09:11:53.130076 [debug] [MainThread]: Command `dbt run` failed at 09:11:53.129995 after 8.42 seconds
[0m09:11:53.130351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5c041bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5a227c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f5a227aa0>]}
[0m09:11:53.130632 [debug] [MainThread]: Flushing usage events
[0m09:11:54.018587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:44.107478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e04ccd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e04e63980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e06549fd0>]}


============================== 09:12:44.112201 | 5d3f721f-6fb1-417a-b3d0-50e1be20ded4 ==============================
[0m09:12:44.112201 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:12:44.112974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:12:44.282325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d3f721f-6fb1-417a-b3d0-50e1be20ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e04786990>]}
[0m09:12:44.331208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d3f721f-6fb1-417a-b3d0-50e1be20ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e05c62150>]}
[0m09:12:44.332014 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:12:44.381978 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:12:44.501560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:44.502031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:44.530581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d3f721f-6fb1-417a-b3d0-50e1be20ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e02cb8fe0>]}
[0m09:12:44.590249 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:12:44.592031 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:12:44.607494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d3f721f-6fb1-417a-b3d0-50e1be20ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e02e4f440>]}
[0m09:12:44.607872 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:12:44.608211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d3f721f-6fb1-417a-b3d0-50e1be20ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e046d3a70>]}
[0m09:12:44.609666 [info ] [MainThread]: 
[0m09:12:44.610010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:44.610868 [info ] [MainThread]: 
[0m09:12:44.611599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:44.615261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:12:44.640777 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:12:44.641081 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:12:44.641299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:48.435169 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:12:52.142247 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:12:52.142671 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:12:52.142954 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:12:52.143150 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:12:52.143350 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:12:52.144142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:52.144570 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:12:52.145026 [info ] [MainThread]: 
[0m09:12:52.145446 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.53 seconds (7.53s).
[0m09:12:52.145995 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:12:52.147139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.081355, "process_in_blocks": "0", "process_kernel_time": 0.233568, "process_mem_max_rss": "103544", "process_out_blocks": "2464", "process_user_time": 1.639223}
[0m09:12:52.147678 [debug] [MainThread]: Command `dbt run` failed at 09:12:52.147566 after 8.08 seconds
[0m09:12:52.148024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e046d3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e029cc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e02c062d0>]}
[0m09:12:52.148396 [debug] [MainThread]: Flushing usage events
[0m09:12:53.403541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:44.318653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a06089f0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0608083500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0608693470>]}


============================== 09:13:44.323669 | 3f7847ed-867e-48d5-a79d-94fc54780739 ==============================
[0m09:13:44.323669 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:13:44.324064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:13:44.489537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f7847ed-867e-48d5-a79d-94fc54780739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0607efaed0>]}
[0m09:13:44.539242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f7847ed-867e-48d5-a79d-94fc54780739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0607d97c50>]}
[0m09:13:44.539977 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:13:44.585641 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:13:44.661556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:13:44.662015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:13:44.686765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f7847ed-867e-48d5-a79d-94fc54780739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a06065e85c0>]}
[0m09:13:44.743608 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:13:44.745371 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:13:44.761869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f7847ed-867e-48d5-a79d-94fc54780739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0606277500>]}
[0m09:13:44.762321 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:13:44.762619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f7847ed-867e-48d5-a79d-94fc54780739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0606298950>]}
[0m09:13:44.764282 [info ] [MainThread]: 
[0m09:13:44.764595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:13:44.765232 [info ] [MainThread]: 
[0m09:13:44.765726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:13:44.768558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:13:44.794583 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:13:44.794907 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:13:44.795101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:48.648359 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:13:52.315775 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:13:52.316151 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:13:52.316416 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:13:52.316616 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:13:52.316800 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:13:52.318066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:52.318276 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:13:52.318459 [info ] [MainThread]: 
[0m09:13:52.318686 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m09:13:52.318991 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:13:52.319676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.059453, "process_in_blocks": "0", "process_kernel_time": 0.272915, "process_mem_max_rss": "103532", "process_out_blocks": "2472", "process_user_time": 1.441334}
[0m09:13:52.320033 [debug] [MainThread]: Command `dbt run` failed at 09:13:52.319962 after 8.06 seconds
[0m09:13:52.320284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0607e54590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a060b2b9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0606277770>]}
[0m09:13:52.321367 [debug] [MainThread]: Flushing usage events
[0m09:13:53.272065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:14:45.505036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393e18d5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393dfdc8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393e00589e0>]}


============================== 09:14:45.509491 | eff53efc-d54b-4e33-8c1d-9a000bf9a09d ==============================
[0m09:14:45.509491 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:14:45.509916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:14:45.665479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eff53efc-d54b-4e33-8c1d-9a000bf9a09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393dfa12d50>]}
[0m09:14:45.712660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eff53efc-d54b-4e33-8c1d-9a000bf9a09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393e05b2c90>]}
[0m09:14:45.713384 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:14:45.761732 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:14:45.833426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:14:45.833765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:14:45.858048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eff53efc-d54b-4e33-8c1d-9a000bf9a09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393de225fd0>]}
[0m09:14:45.917069 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:14:45.918956 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:14:45.936130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eff53efc-d54b-4e33-8c1d-9a000bf9a09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393dded2db0>]}
[0m09:14:45.936511 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:14:45.936791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eff53efc-d54b-4e33-8c1d-9a000bf9a09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393ddf16450>]}
[0m09:14:45.937968 [info ] [MainThread]: 
[0m09:14:45.938253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:14:45.938482 [info ] [MainThread]: 
[0m09:14:45.938868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:14:45.941911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:14:45.967637 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:14:45.967959 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:14:45.968153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:49.761738 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:14:53.432384 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:14:53.432847 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:14:53.433156 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:14:53.433371 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:14:53.433599 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:14:53.434573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:53.435005 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:14:53.435406 [info ] [MainThread]: 
[0m09:14:53.435824 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m09:14:53.436368 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:14:53.437509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.9678984, "process_in_blocks": "424", "process_kernel_time": 0.189753, "process_mem_max_rss": "103696", "process_out_blocks": "2464", "process_user_time": 1.336706}
[0m09:14:53.438024 [debug] [MainThread]: Command `dbt run` failed at 09:14:53.437918 after 7.97 seconds
[0m09:14:53.438468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393e005a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393e30634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393ddfa59d0>]}
[0m09:14:53.438968 [debug] [MainThread]: Flushing usage events
[0m09:14:54.319356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:28.812700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7927df9614f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7927dfb58c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7927dfbdf6b0>]}


============================== 09:15:28.817485 | b3cd8a83-648c-40f5-8137-fc8f898e5e56 ==============================
[0m09:15:28.817485 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:15:28.817882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:15:28.819818 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at /root/.dbt/profiles.yml is empty
  
[0m09:15:28.820681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.010378696, "process_in_blocks": "0", "process_kernel_time": 0.176842, "process_mem_max_rss": "86220", "process_out_blocks": "1480", "process_user_time": 0.86316}
[0m09:15:28.821033 [debug] [MainThread]: Command `dbt run` failed at 09:15:28.820960 after 0.01 seconds
[0m09:15:28.821260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7927df91fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7927dfb58c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7927dfb590a0>]}
[0m09:15:28.821506 [debug] [MainThread]: Flushing usage events
[0m09:15:29.681796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:44.113913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f5ae519a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f59410800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f5943a6c0>]}


============================== 09:15:44.121597 | d84266eb-de2a-49e5-9d92-f612af5b5c77 ==============================
[0m09:15:44.121597 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:15:44.122118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:15:44.265352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd84266eb-de2a-49e5-9d92-f612af5b5c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f58f33c80>]}
[0m09:15:44.309130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd84266eb-de2a-49e5-9d92-f612af5b5c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f58fa8cb0>]}
[0m09:15:44.310064 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:44.359301 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:15:44.427423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:44.427787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:44.453577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd84266eb-de2a-49e5-9d92-f612af5b5c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f5775a630>]}
[0m09:15:44.508471 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:15:44.510488 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:15:44.527394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd84266eb-de2a-49e5-9d92-f612af5b5c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f57434aa0>]}
[0m09:15:44.527943 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:15:44.528283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84266eb-de2a-49e5-9d92-f612af5b5c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f5744fd70>]}
[0m09:15:44.529629 [info ] [MainThread]: 
[0m09:15:44.529935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:15:44.530379 [info ] [MainThread]: 
[0m09:15:44.530830 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:15:44.533882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:15:44.560982 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:15:44.561318 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:15:44.561518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:53.633223 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:15:57.291007 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:15:57.291554 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:15:57.291983 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:15:57.292250 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:15:57.292629 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:15:57.293653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:57.293918 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:15:57.294193 [info ] [MainThread]: 
[0m09:15:57.294664 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.76 seconds (12.76s).
[0m09:15:57.296212 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:15:57.298139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.57093, "process_in_blocks": "0", "process_kernel_time": 0.193898, "process_mem_max_rss": "103360", "process_out_blocks": "2472", "process_user_time": 1.348861}
[0m09:15:57.298813 [debug] [MainThread]: Command `dbt run` failed at 09:15:57.298658 after 11.57 seconds
[0m09:15:57.299463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f59881bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f57430980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702f59591610>]}
[0m09:15:57.304654 [debug] [MainThread]: Flushing usage events
[0m09:15:58.181051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:44.498427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f8a19ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f8c3f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f8a1aa50>]}


============================== 09:16:44.503123 | ca45ee06-27ac-4332-ac47-62fb7b83d281 ==============================
[0m09:16:44.503123 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:16:44.503511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:16:44.654369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca45ee06-27ac-4332-ac47-62fb7b83d281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f85069c0>]}
[0m09:16:44.704908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca45ee06-27ac-4332-ac47-62fb7b83d281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f9114bc0>]}
[0m09:16:44.705622 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:44.752423 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:16:44.826317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:16:44.826659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:16:44.853525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca45ee06-27ac-4332-ac47-62fb7b83d281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f6bfd910>]}
[0m09:16:44.902763 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:16:44.904529 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:16:44.920846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca45ee06-27ac-4332-ac47-62fb7b83d281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f8419490>]}
[0m09:16:44.921245 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:16:44.921502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca45ee06-27ac-4332-ac47-62fb7b83d281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f6bccb30>]}
[0m09:16:44.923528 [info ] [MainThread]: 
[0m09:16:44.923855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:16:44.924098 [info ] [MainThread]: 
[0m09:16:44.924487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:16:44.927769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:16:44.955874 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:16:44.956227 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:16:44.956429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:48.741682 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:16:57.721562 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:16:57.721940 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:16:57.722244 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:16:57.722477 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:16:57.722699 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:16:57.723569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:57.723819 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:16:57.724101 [info ] [MainThread]: 
[0m09:16:57.724395 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.80 seconds (12.80s).
[0m09:16:57.724932 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:16:57.726159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.604017, "process_in_blocks": "4016", "process_kernel_time": 0.258347, "process_mem_max_rss": "103428", "process_out_blocks": "2480", "process_user_time": 1.32507}
[0m09:16:57.726611 [debug] [MainThread]: Command `dbt run` failed at 09:16:57.726518 after 11.60 seconds
[0m09:16:57.726965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f8baacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462fb8d1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7462f6749ca0>]}
[0m09:16:57.728971 [debug] [MainThread]: Flushing usage events
[0m09:16:58.516408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:17:44.073425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5666b24e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5667e4aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5666a44aa0>]}


============================== 09:17:44.078331 | fd0a42ca-023a-4ae2-bb29-802db7029c85 ==============================
[0m09:17:44.078331 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:17:44.078764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:17:44.234950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd0a42ca-023a-4ae2-bb29-802db7029c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e566602ebd0>]}
[0m09:17:44.280614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd0a42ca-023a-4ae2-bb29-802db7029c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5667d581a0>]}
[0m09:17:44.281294 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:17:44.326135 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:17:44.398962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:17:44.399293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:17:44.424261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd0a42ca-023a-4ae2-bb29-802db7029c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5664711610>]}
[0m09:17:44.477796 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:17:44.479624 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:17:44.498196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd0a42ca-023a-4ae2-bb29-802db7029c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e56644a55b0>]}
[0m09:17:44.498640 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:17:44.498926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd0a42ca-023a-4ae2-bb29-802db7029c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5665ed6b70>]}
[0m09:17:44.500314 [info ] [MainThread]: 
[0m09:17:44.500994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:17:44.501815 [info ] [MainThread]: 
[0m09:17:44.502563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:17:44.505974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:17:44.535908 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:17:44.536274 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:17:44.536478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:48.015810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57034860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57035d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57036390>]}


============================== 09:17:48.023478 | aa1a6391-b1d0-4b07-9eee-0fdca3336813 ==============================
[0m09:17:48.023478 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:17:48.024278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:17:48.207258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa1a6391-b1d0-4b07-9eee-0fdca3336813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5517b980>]}
[0m09:17:48.253685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa1a6391-b1d0-4b07-9eee-0fdca3336813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad56a679e0>]}
[0m09:17:48.254375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:17:48.314930 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:17:48.330135 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:17:48.401316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:17:48.401643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:17:48.425678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa1a6391-b1d0-4b07-9eee-0fdca3336813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad56c22540>]}
[0m09:17:48.485233 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:17:48.487016 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:17:48.507914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa1a6391-b1d0-4b07-9eee-0fdca3336813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad54ed8950>]}
[0m09:17:48.508302 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:17:48.508633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa1a6391-b1d0-4b07-9eee-0fdca3336813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad550293a0>]}
[0m09:17:48.509973 [info ] [MainThread]: 
[0m09:17:48.510257 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:17:48.510466 [info ] [MainThread]: 
[0m09:17:48.510834 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:17:48.513979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:17:48.560260 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:17:48.560675 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:17:48.560880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:51.967968 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:17:51.968762 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:17:51.969435 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:17:51.969927 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:17:51.970387 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:17:51.971583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:51.972120 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:17:51.972563 [info ] [MainThread]: 
[0m09:17:51.973061 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m09:17:51.973601 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:17:51.976881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.9376774, "process_in_blocks": "2768", "process_kernel_time": 0.213347, "process_mem_max_rss": "103284", "process_out_blocks": "2464", "process_user_time": 1.378225}
[0m09:17:51.977483 [debug] [MainThread]: Command `dbt run` failed at 09:17:51.977359 after 7.94 seconds
[0m09:17:51.977877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5665fb45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5664414590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e56646f7aa0>]}
[0m09:17:51.978195 [debug] [MainThread]: Flushing usage events
[0m09:17:52.205104 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:17:54.502921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:17:55.016759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:55.017441 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:17:55.017882 [info ] [MainThread]: 
[0m09:17:55.018174 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.51 seconds (6.51s).
[0m09:17:55.018555 [error] [MainThread]: Encountered an error:

[0m09:17:55.040192 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 693, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/local/lib/python3.12/threading.py", line 655, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 588, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 526, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run.py", line 981, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 684, in create_schemas
    with dbt_common.utils.executor(self.config) as tpe:  # type: ignore
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 647, in __exit__
    self.shutdown(wait=True)
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 238, in shutdown
    t.join()
  File "/usr/local/lib/python3.12/threading.py", line 1147, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.12/threading.py", line 1167, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m09:17:55.041357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.4017925, "process_in_blocks": "592", "process_kernel_time": 0.321899, "process_mem_max_rss": "103436", "process_out_blocks": "2472", "process_user_time": 1.363838}
[0m09:17:55.041859 [debug] [MainThread]: Command `dbt run` failed at 09:17:55.041755 after 5.40 seconds
[0m09:17:55.042208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad589ec290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad551cf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad540a05c0>]}
[0m09:17:55.042569 [debug] [MainThread]: Flushing usage events
[0m09:17:55.901186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:44.099158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c35c4bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c36116a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c37660530>]}


============================== 09:18:44.105835 | 0b710b23-cfa6-4c58-a951-d7533e95c800 ==============================
[0m09:18:44.105835 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:18:44.106259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:18:44.311573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b710b23-cfa6-4c58-a951-d7533e95c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c35616a50>]}
[0m09:18:44.362048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b710b23-cfa6-4c58-a951-d7533e95c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c35da5af0>]}
[0m09:18:44.362946 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:18:44.437459 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:18:44.542044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:18:44.542434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:18:44.571215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b710b23-cfa6-4c58-a951-d7533e95c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c35c4aa20>]}
[0m09:18:44.642262 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:18:44.645127 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:18:44.670789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b710b23-cfa6-4c58-a951-d7533e95c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c33b388f0>]}
[0m09:18:44.671354 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:18:44.671746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b710b23-cfa6-4c58-a951-d7533e95c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c356afb60>]}
[0m09:18:44.673136 [info ] [MainThread]: 
[0m09:18:44.673426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:18:44.673651 [info ] [MainThread]: 
[0m09:18:44.674044 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:18:44.677298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:18:44.710804 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:18:44.711175 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:18:44.711398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:48.481055 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:18:52.139173 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:18:52.139553 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:18:52.139829 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:18:52.140017 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:18:52.140241 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:18:52.140925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:52.141148 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:18:52.141353 [info ] [MainThread]: 
[0m09:18:52.141599 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m09:18:52.141946 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:18:52.142724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.085314, "process_in_blocks": "10648", "process_kernel_time": 0.269973, "process_mem_max_rss": "103564", "process_out_blocks": "2464", "process_user_time": 1.773516}
[0m09:18:52.143098 [debug] [MainThread]: Command `dbt run` failed at 09:18:52.143021 after 8.09 seconds
[0m09:18:52.143356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c35a866c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c32dd9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c339a84a0>]}
[0m09:18:52.143616 [debug] [MainThread]: Flushing usage events
[0m09:18:53.006158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:36.258218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db61692b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db70eb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db69645c0>]}


============================== 09:23:36.263902 | f099108f-4f4e-4ab6-9b98-18848ce37568 ==============================
[0m09:23:36.263902 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:23:36.264384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:23:36.468521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f099108f-4f4e-4ab6-9b98-18848ce37568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db805b4d0>]}
[0m09:23:36.520022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f099108f-4f4e-4ab6-9b98-18848ce37568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db64fdbe0>]}
[0m09:23:36.520802 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:23:36.602495 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:23:36.688062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:23:36.688511 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:23:36.723415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f099108f-4f4e-4ab6-9b98-18848ce37568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db63ea8d0>]}
[0m09:23:36.799066 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:23:36.801814 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:23:36.826992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f099108f-4f4e-4ab6-9b98-18848ce37568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db748c1a0>]}
[0m09:23:36.827573 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:23:36.828016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f099108f-4f4e-4ab6-9b98-18848ce37568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db4904b30>]}
[0m09:23:36.829771 [info ] [MainThread]: 
[0m09:23:36.830199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:23:36.830559 [info ] [MainThread]: 
[0m09:23:36.831145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:23:36.837284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:23:36.880732 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:23:36.881075 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:23:36.881303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:40.678485 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:23:49.631079 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:23:49.632417 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:23:49.634207 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:23:49.634864 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:23:49.635618 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:23:49.637060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:49.637376 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:23:49.637933 [info ] [MainThread]: 
[0m09:23:49.638923 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.81 seconds (12.81s).
[0m09:23:49.639740 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:23:49.647187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.795332, "process_in_blocks": "488", "process_kernel_time": 0.295148, "process_mem_max_rss": "103336", "process_out_blocks": "2472", "process_user_time": 1.707646}
[0m09:23:49.647833 [debug] [MainThread]: Command `dbt run` failed at 09:23:49.647715 after 11.80 seconds
[0m09:23:49.648252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db6127d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db45b2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743db441deb0>]}
[0m09:23:49.648924 [debug] [MainThread]: Flushing usage events
[0m09:23:50.479628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:40.475237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad62f026f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad62b0dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad62b9b500>]}


============================== 09:25:40.480190 | c2daca06-f302-47b4-a330-9b6344360a2c ==============================
[0m09:25:40.480190 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:25:40.480605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:25:40.663831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2daca06-f302-47b4-a330-9b6344360a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad62933830>]}
[0m09:25:40.710167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2daca06-f302-47b4-a330-9b6344360a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad62f2e450>]}
[0m09:25:40.710931 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:25:40.760938 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:25:40.852329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:25:40.852707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:25:40.881180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2daca06-f302-47b4-a330-9b6344360a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad60f04770>]}
[0m09:25:40.940130 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:25:40.943124 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:25:40.962997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2daca06-f302-47b4-a330-9b6344360a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad60da48f0>]}
[0m09:25:40.963423 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:25:40.963696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2daca06-f302-47b4-a330-9b6344360a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad628e3ec0>]}
[0m09:25:40.964900 [info ] [MainThread]: 
[0m09:25:40.965266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:25:40.965495 [info ] [MainThread]: 
[0m09:25:40.965906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:25:40.968960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:25:41.018812 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:25:41.019276 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:25:41.019675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:44.784206 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:25:53.723497 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:25:53.724122 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:25:53.724581 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:25:53.724886 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:25:53.725330 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:25:53.726299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:53.726559 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:25:53.726774 [info ] [MainThread]: 
[0m09:25:53.727025 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 12.76 seconds (12.76s).
[0m09:25:53.727370 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:25:53.732901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.657637, "process_in_blocks": "4152", "process_kernel_time": 0.270751, "process_mem_max_rss": "103380", "process_out_blocks": "2472", "process_user_time": 1.734503}
[0m09:25:53.733744 [debug] [MainThread]: Command `dbt run` failed at 09:25:53.733508 after 11.66 seconds
[0m09:25:53.734244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad635fe1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad62b37980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ad60da2ba0>]}
[0m09:25:53.735093 [debug] [MainThread]: Flushing usage events
[0m09:25:54.601624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:26:24.761886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71071932f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71071a7ddcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710718f34950>]}


============================== 09:26:24.768574 | 658fc591-8798-4ebe-8aa9-f22f67e801e7 ==============================
[0m09:26:24.768574 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:26:24.769877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:26:24.948801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '658fc591-8798-4ebe-8aa9-f22f67e801e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710717099550>]}
[0m09:26:25.017679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '658fc591-8798-4ebe-8aa9-f22f67e801e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107195af2f0>]}
[0m09:26:25.019246 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:26:25.083569 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:26:25.169175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:26:25.169539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:26:25.196013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658fc591-8798-4ebe-8aa9-f22f67e801e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710717109730>]}
[0m09:26:25.254560 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:26:25.256467 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:26:25.274553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658fc591-8798-4ebe-8aa9-f22f67e801e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710716e58a10>]}
[0m09:26:25.274978 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:26:25.275251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658fc591-8798-4ebe-8aa9-f22f67e801e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710716df4830>]}
[0m09:26:25.276599 [info ] [MainThread]: 
[0m09:26:25.276919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:26:25.277143 [info ] [MainThread]: 
[0m09:26:25.277533 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:26:25.280813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:26:25.313126 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:26:25.313531 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:26:25.314017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:29.111989 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m09:26:32.776191 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:26:32.776701 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:26:32.777113 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:26:32.777406 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:26:32.777681 [debug] [ThreadPool]: On list_db: No close available on handle
[0m09:26:32.778890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:32.779400 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m09:26:32.779846 [info ] [MainThread]: 
[0m09:26:32.780272 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m09:26:32.780806 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m09:26:32.781737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.075812, "process_in_blocks": "3504", "process_kernel_time": 0.298882, "process_mem_max_rss": "103432", "process_out_blocks": "2472", "process_user_time": 1.582813}
[0m09:26:32.782207 [debug] [MainThread]: Command `dbt run` failed at 09:26:32.782126 after 8.08 seconds
[0m09:26:32.782473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710718ca7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710716273ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710717108350>]}
[0m09:26:32.782727 [debug] [MainThread]: Flushing usage events
[0m09:26:33.665870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:14.760244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71175972dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711759b26e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7117593678f0>]}


============================== 09:36:14.782933 | 59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5 ==============================
[0m09:36:14.782933 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:36:14.783613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:15.191448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711759212d20>]}
[0m09:36:15.324397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711759341400>]}
[0m09:36:15.325781 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:36:15.538711 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:36:16.026343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:16.027068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:16.110132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71175b046b40>]}
[0m09:36:16.337734 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:36:16.360481 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:36:16.391770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71175768a990>]}
[0m09:36:16.392405 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:36:16.392873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7117575ddc10>]}
[0m09:36:16.394886 [info ] [MainThread]: 
[0m09:36:16.395393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:36:16.395968 [info ] [MainThread]: 
[0m09:36:16.396706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:36:16.401527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:36:16.487846 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:36:16.488269 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:36:16.488501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:16.513445 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m09:36:16.515297 [debug] [ThreadPool]: On list_db: Close
[0m09:36:16.517423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:36:16.524315 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:36:16.524761 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:36:16.525131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:36:16.534926 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:36:16.535775 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:36:16.536422 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:36:16.564180 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.026 seconds
[0m09:36:16.573340 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:36:16.574752 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:36:16.582324 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:16.582972 [debug] [MainThread]: On master: BEGIN
[0m09:36:16.583439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:16.591467 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:36:16.592048 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:16.592549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:36:16.596142 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m09:36:16.603153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7117576c4ad0>]}
[0m09:36:16.606402 [debug] [MainThread]: On master: ROLLBACK
[0m09:36:16.609819 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:16.610801 [debug] [MainThread]: On master: BEGIN
[0m09:36:16.612971 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:36:16.615167 [debug] [MainThread]: On master: COMMIT
[0m09:36:16.616182 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:16.617020 [debug] [MainThread]: On master: COMMIT
[0m09:36:16.618257 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:16.619066 [debug] [MainThread]: On master: Close
[0m09:36:16.637173 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:36:16.641223 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:36:16.650526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:36:16.656127 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:36:16.667262 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:36:16.668229 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:36:16.757649 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:36:16.759295 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:36:16.760068 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:36:16.760538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:16.769653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:36:16.770780 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:36:16.771902 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:36:16.781781 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m09:36:16.790974 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:36:16.791736 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:36:16.792775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:36:16.817496 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:36:16.818209 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:36:16.818700 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:36:16.860125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m09:36:16.871279 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:36:16.878560 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:36:16.879599 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:36:16.881375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:36:16.883718 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:36:16.887315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71175b0964b0>]}
[0m09:36:16.888018 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.24s]
[0m09:36:16.888607 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:36:16.890004 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:36:16.890580 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:36:16.891199 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:36:16.892036 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:36:16.893069 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:36:16.893848 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:36:16.894510 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:36:16.895084 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:36:16.899179 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:36:16.903253 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:36:16.904408 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:36:16.907134 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:36:16.908215 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:36:16.910986 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:36:16.911771 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:36:16.912308 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:36:16.912948 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:36:16.913473 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:36:16.914043 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:36:16.914563 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:36:16.923634 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m09:36:16.924277 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m09:36:16.924927 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:36:16.925625 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:36:16.926318 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:36:16.927165 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:36:16.935445 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m09:36:16.938689 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:36:16.939697 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:36:16.940672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:16.941329 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m09:36:16.944174 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:36:16.947431 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:36:16.948136 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:36:16.948870 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:36:16.949646 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:36:16.950915 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:36:16.953351 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:36:16.953920 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:36:16.954512 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:36:16.958291 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:36:16.959042 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:36:16.960199 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:36:16.961370 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:36:16.962847 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:36:16.964988 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:36:16.965479 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m09:36:16.966484 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7117569693a0>]}
[0m09:36:16.968931 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:36:16.969658 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m09:36:16.970902 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:36:16.971978 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:36:16.972503 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:36:16.973846 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:36:16.975684 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:36:16.976436 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c8f33a-dcf7-49c1-8cc4-75b01d4b7df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71175468ddf0>]}
[0m09:36:16.977272 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m09:36:16.978054 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:36:16.980868 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:16.981405 [debug] [MainThread]: On master: BEGIN
[0m09:36:16.981886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:16.990688 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:36:16.991333 [debug] [MainThread]: On master: COMMIT
[0m09:36:16.991840 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:16.992256 [debug] [MainThread]: On master: COMMIT
[0m09:36:16.992912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:16.993369 [debug] [MainThread]: On master: Close
[0m09:36:16.994045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:16.994466 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:36:16.994857 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:36:16.995195 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:36:16.995864 [info ] [MainThread]: 
[0m09:36:16.996425 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m09:36:16.998753 [debug] [MainThread]: Command end result
[0m09:36:17.031196 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:36:17.033086 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:36:17.040400 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:36:17.040823 [info ] [MainThread]: 
[0m09:36:17.041361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:36:17.041753 [info ] [MainThread]: 
[0m09:36:17.042133 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:36:17.043222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3856263, "process_in_blocks": "4160", "process_kernel_time": 0.847097, "process_mem_max_rss": "107456", "process_out_blocks": "3384", "process_user_time": 4.408278}
[0m09:36:17.043895 [debug] [MainThread]: Command `dbt run` succeeded at 09:36:17.043765 after 2.39 seconds
[0m09:36:17.044313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711759dbb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71175788eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71175941e1b0>]}
[0m09:36:17.044731 [debug] [MainThread]: Flushing usage events
[0m09:36:17.888117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:48.797805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fe1795b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fcf58b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fd84deb0>]}


============================== 09:45:48.804804 | 33e6591e-7e0e-4d39-8056-76333f339e86 ==============================
[0m09:45:48.804804 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:45:48.805565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:45:49.151638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fcfd0ef0>]}
[0m09:45:49.212707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fd26ba10>]}
[0m09:45:49.213693 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:45:49.324286 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:45:49.452765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:45:49.453379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:45:49.546479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fb25c380>]}
[0m09:45:49.676651 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:45:49.680747 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:45:49.763593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fb0e35c0>]}
[0m09:45:49.766389 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:45:49.770442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fb402b70>]}
[0m09:45:49.779934 [info ] [MainThread]: 
[0m09:45:49.780606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:45:49.781123 [info ] [MainThread]: 
[0m09:45:49.781964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:45:49.787388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:45:50.720814 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:45:50.721341 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:45:50.721653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:50.761366 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m09:45:50.763564 [debug] [ThreadPool]: On list_db: Close
[0m09:45:50.766138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:45:50.785656 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:45:50.788888 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:45:50.790726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:50.801726 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:45:50.802406 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:45:50.803041 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:45:51.652447 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m09:45:51.660765 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:45:51.664680 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:45:51.688816 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:51.689639 [debug] [MainThread]: On master: BEGIN
[0m09:45:51.690123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:51.698363 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:45:51.699298 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:51.700100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:45:51.716162 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m09:45:51.719463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fb279a30>]}
[0m09:45:51.720745 [debug] [MainThread]: On master: ROLLBACK
[0m09:45:51.722904 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:51.726845 [debug] [MainThread]: On master: BEGIN
[0m09:45:51.734077 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:45:51.741241 [debug] [MainThread]: On master: COMMIT
[0m09:45:51.749101 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:51.751582 [debug] [MainThread]: On master: COMMIT
[0m09:45:51.755773 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:45:51.756781 [debug] [MainThread]: On master: Close
[0m09:45:51.762048 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:45:51.763010 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:45:51.764205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:45:51.764785 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:45:51.783576 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:45:51.785574 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:45:51.877709 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:45:51.878481 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:45:51.878912 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:45:51.879507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:51.902407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m09:45:51.903494 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:45:51.904749 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:45:51.932327 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m09:45:51.937711 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:45:51.938185 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:45:51.939254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:45:51.975654 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:45:51.979398 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:45:51.980863 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:45:51.985785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:45:51.992209 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:45:52.000005 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:45:52.000639 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:45:52.001872 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:45:52.008151 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:45:52.015300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fccdc290>]}
[0m09:45:52.016587 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.25s]
[0m09:45:52.018241 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:45:52.020799 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:45:52.023243 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:45:52.025091 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:45:52.026152 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:45:52.028909 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:45:52.031048 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:45:52.032949 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:45:52.036208 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:45:52.056947 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:45:52.054969 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:45:52.058159 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:45:52.058564 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:45:52.061194 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:45:52.073788 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:45:52.076457 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:45:52.078657 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:45:52.081766 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:45:52.084302 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:45:52.086943 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:45:52.091622 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:45:52.106126 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m09:45:52.106900 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:45:52.107512 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:45:52.110254 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m09:45:52.110878 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:45:52.111350 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:45:52.124341 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m09:45:52.129696 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:45:52.131206 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m09:45:52.133645 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:45:52.154935 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:45:52.154460 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:45:52.157773 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:45:52.158383 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:45:52.158919 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:45:52.159583 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:45:52.160033 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:45:52.161957 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:45:52.162450 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:45:52.162969 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:45:52.163611 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:45:52.165830 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:45:52.166298 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:45:52.166956 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:45:52.170228 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:45:52.172585 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:45:52.175180 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:45:52.176346 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:45:52.177205 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:45:52.180077 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:45:52.180865 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:45:52.188591 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021f81c8aa0>]}
[0m09:45:52.191436 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:45:52.193957 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m09:45:52.197619 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e6591e-7e0e-4d39-8056-76333f339e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fa2c7350>]}
[0m09:45:52.202188 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:45:52.207451 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.17s]
[0m09:45:52.210645 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:45:52.214081 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:52.214616 [debug] [MainThread]: On master: BEGIN
[0m09:45:52.214975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:45:52.221783 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:45:52.222199 [debug] [MainThread]: On master: COMMIT
[0m09:45:52.222487 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:52.222769 [debug] [MainThread]: On master: COMMIT
[0m09:45:52.223273 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:45:52.223796 [debug] [MainThread]: On master: Close
[0m09:45:52.224582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:52.225026 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:45:52.225377 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:45:52.225704 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:45:52.226414 [info ] [MainThread]: 
[0m09:45:52.227198 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m09:45:52.231530 [debug] [MainThread]: Command end result
[0m09:45:52.299981 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:45:52.302457 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:45:52.312175 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:45:52.312908 [info ] [MainThread]: 
[0m09:45:52.313773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:45:52.314521 [info ] [MainThread]: 
[0m09:45:52.315323 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:45:52.319585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9689763, "process_in_blocks": "56528", "process_kernel_time": 1.412407, "process_mem_max_rss": "107480", "process_out_blocks": "3392", "process_user_time": 3.738479}
[0m09:45:52.321661 [debug] [MainThread]: Command `dbt run` succeeded at 09:45:52.321297 after 1.97 seconds
[0m09:45:52.323210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fe780410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fccdc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021fb3b3230>]}
[0m09:45:52.324799 [debug] [MainThread]: Flushing usage events
[0m09:45:53.201200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:37.473657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998dd65ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998c467260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998c466030>]}


============================== 09:46:37.498085 | b1e571be-1708-4964-98f8-67a7dd86244f ==============================
[0m09:46:37.498085 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:46:37.499345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:46:37.826732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998c095400>]}
[0m09:46:37.923888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998caa1340>]}
[0m09:46:37.924817 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:46:38.025136 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:46:38.134238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:38.135083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:38.199113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998a6c9190>]}
[0m09:46:38.270769 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:46:38.273117 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:46:38.321018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998a378980>]}
[0m09:46:38.321563 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:46:38.321913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998a377230>]}
[0m09:46:38.324466 [info ] [MainThread]: 
[0m09:46:38.325005 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:46:38.326066 [info ] [MainThread]: 
[0m09:46:38.326754 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:46:38.332833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:46:38.395791 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:46:38.396281 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:46:38.396574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:38.404164 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m09:46:38.405381 [debug] [ThreadPool]: On list_db: Close
[0m09:46:38.407263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:46:38.423189 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:46:38.423978 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:46:38.424465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:38.440903 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m09:46:38.441395 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:46:38.441648 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:46:38.447859 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:46:38.449000 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:46:38.449505 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:46:38.454144 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.454604 [debug] [MainThread]: On master: BEGIN
[0m09:46:38.454976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:38.478298 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m09:46:38.479413 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.480326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:46:38.485600 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:46:38.487521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9989619a90>]}
[0m09:46:38.488039 [debug] [MainThread]: On master: ROLLBACK
[0m09:46:38.488683 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.488963 [debug] [MainThread]: On master: BEGIN
[0m09:46:38.489697 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:46:38.490053 [debug] [MainThread]: On master: COMMIT
[0m09:46:38.490350 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.490666 [debug] [MainThread]: On master: COMMIT
[0m09:46:38.491192 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:38.491510 [debug] [MainThread]: On master: Close
[0m09:46:38.496946 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:46:38.497469 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:46:38.497901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:46:38.498183 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:46:38.505709 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:46:38.507029 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:46:38.562541 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:46:38.569080 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:46:38.572274 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:46:38.574431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:38.584305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:46:38.584839 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:46:38.585203 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:46:38.591259 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m09:46:38.596044 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:46:38.596431 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:46:38.598001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:38.600391 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:46:38.600926 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:46:38.601797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:38.646389 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:46:38.647012 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:46:38.647320 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:46:38.651249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:46:38.658229 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:46:38.675925 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:46:38.679569 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:46:38.692575 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m09:46:38.695779 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:46:38.697603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998c9f62d0>]}
[0m09:46:38.698207 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m09:46:38.698731 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:46:38.699886 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:46:38.700375 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:46:38.700911 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:46:38.701417 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:46:38.701881 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:46:38.702288 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:46:38.702577 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:46:38.702899 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:46:38.706494 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:46:38.710841 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:46:38.713115 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:46:38.716654 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:46:38.717265 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:46:38.721625 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:46:38.723112 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:46:38.724045 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:46:38.724943 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:46:38.725772 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:46:38.727128 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:46:38.729552 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:46:38.755457 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m09:46:38.756302 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:46:38.756890 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:46:38.759543 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m09:46:38.760124 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:46:38.760666 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:46:38.772028 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m09:46:38.775099 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:46:38.775487 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m09:46:38.775801 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:46:38.779188 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:46:38.779832 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:46:38.780313 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:38.784183 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:46:38.784969 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:46:38.785780 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:46:38.791593 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:46:38.793489 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:46:38.795267 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:46:38.797328 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:46:38.812980 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:46:38.816025 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:46:38.816786 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:46:38.817462 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:46:38.818178 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:46:38.818781 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:46:38.823534 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:46:38.824051 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m09:46:38.827001 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:46:38.828623 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:46:38.829112 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:46:38.829554 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:46:38.829864 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:46:38.830143 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:46:38.833464 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:46:38.834985 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:46:38.835389 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:46:38.836164 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9989531f40>]}
[0m09:46:38.840019 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:46:38.841405 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.13s]
[0m09:46:38.842773 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e571be-1708-4964-98f8-67a7dd86244f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99895bff50>]}
[0m09:46:38.843638 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:46:38.844791 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m09:46:38.847451 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:46:38.857162 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.860427 [debug] [MainThread]: On master: BEGIN
[0m09:46:38.863385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:38.887098 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m09:46:38.887757 [debug] [MainThread]: On master: COMMIT
[0m09:46:38.888213 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:38.888585 [debug] [MainThread]: On master: COMMIT
[0m09:46:38.889164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:38.889622 [debug] [MainThread]: On master: Close
[0m09:46:38.890362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:38.890798 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:46:38.891165 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:46:38.891493 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:46:38.891981 [info ] [MainThread]: 
[0m09:46:38.892443 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:46:38.893805 [debug] [MainThread]: Command end result
[0m09:46:38.922544 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:46:38.929075 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:46:38.943444 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:46:38.944026 [info ] [MainThread]: 
[0m09:46:38.944655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:38.945107 [info ] [MainThread]: 
[0m09:46:38.945618 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:46:38.947200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5379434, "process_in_blocks": "2536", "process_kernel_time": 0.553594, "process_mem_max_rss": "107692", "process_out_blocks": "3392", "process_user_time": 3.240654}
[0m09:46:38.947929 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:38.947765 after 1.54 seconds
[0m09:46:38.948464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998c130c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998ca4bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b998f672870>]}
[0m09:46:38.948918 [debug] [MainThread]: Flushing usage events
[0m09:46:39.813851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:00.944881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d687c57fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d687c56330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6874989e0>]}


============================== 11:33:00.957312 | ef71f072-d11c-406e-bd86-6773951fcf62 ==============================
[0m11:33:00.957312 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:33:00.958129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:01.345500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d686f66270>]}
[0m11:33:01.479372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d686fcfec0>]}
[0m11:33:01.482069 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:33:01.632921 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:33:01.841307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:01.841758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:01.870252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d685821730>]}
[0m11:33:01.980522 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:01.984460 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:02.108132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d685576cc0>]}
[0m11:33:02.108727 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:33:02.109113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d68560d3a0>]}
[0m11:33:02.110921 [info ] [MainThread]: 
[0m11:33:02.111368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:02.111683 [info ] [MainThread]: 
[0m11:33:02.112235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:33:02.124494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:33:02.281344 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:33:02.281803 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:33:02.284052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:02.381364 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.097 seconds
[0m11:33:02.382654 [debug] [ThreadPool]: On list_db: Close
[0m11:33:02.384801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:33:02.389067 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:02.389356 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:33:02.389554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:02.413269 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m11:33:02.413664 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:02.413892 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:33:02.430609 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m11:33:02.432300 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:33:02.432878 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:33:02.437245 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:02.437548 [debug] [MainThread]: On master: BEGIN
[0m11:33:02.437768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:02.442909 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:33:02.443198 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:02.443754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:33:02.458973 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m11:33:02.461058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6854d1f70>]}
[0m11:33:02.461702 [debug] [MainThread]: On master: ROLLBACK
[0m11:33:02.462370 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:02.462653 [debug] [MainThread]: On master: BEGIN
[0m11:33:02.463370 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:33:02.463664 [debug] [MainThread]: On master: COMMIT
[0m11:33:02.463902 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:02.464120 [debug] [MainThread]: On master: COMMIT
[0m11:33:02.464783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:33:02.465088 [debug] [MainThread]: On master: Close
[0m11:33:02.468440 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:33:02.468992 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m11:33:02.469422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:33:02.469728 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:33:02.476078 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:33:02.477401 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:33:02.515489 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:33:02.516651 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:02.517289 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:33:02.517796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:02.526167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:33:02.526709 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:02.527047 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m11:33:02.540006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m11:33:02.546041 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:02.546432 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:33:02.547328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:33:02.572622 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:33:02.573300 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:02.573667 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:33:02.577332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:33:02.583517 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:33:02.588788 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:02.589165 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:33:02.591365 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:33:02.594111 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:33:02.596613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d688f724e0>]}
[0m11:33:02.597763 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m11:33:02.599034 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:33:02.601399 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m11:33:02.601905 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:33:02.602472 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m11:33:02.603336 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:33:02.604102 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m11:33:02.604810 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:33:02.605241 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m11:33:02.605640 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:33:02.609750 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m11:33:02.612506 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:33:02.613565 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:33:02.616487 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:33:02.617359 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m11:33:02.620235 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m11:33:02.620782 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:02.621365 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:33:02.621729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:33:02.622567 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:02.622894 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m11:33:02.623317 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:33:02.632957 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m11:33:02.633861 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:02.634464 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m11:33:02.643583 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m11:33:02.644416 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:02.644960 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m11:33:02.648571 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m11:33:02.651520 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:02.652027 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:33:02.652929 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:33:02.654315 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:33:02.654689 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:02.654986 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:33:02.658054 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m11:33:02.660487 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:33:02.661100 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:02.661559 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:33:02.662320 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:33:02.664064 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:33:02.665152 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d68455bfb0>]}
[0m11:33:02.667853 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m11:33:02.671095 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:02.666528 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m11:33:02.671702 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m11:33:02.672389 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:33:02.675802 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:33:02.677583 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:33:02.677972 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:02.678333 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:33:02.680788 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:33:02.683061 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m11:33:02.683840 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:02.684291 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m11:33:02.685127 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:33:02.686362 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m11:33:02.686973 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef71f072-d11c-406e-bd86-6773951fcf62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d684584d70>]}
[0m11:33:02.687511 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m11:33:02.688027 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m11:33:02.690597 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:02.690944 [debug] [MainThread]: On master: BEGIN
[0m11:33:02.691210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:02.697808 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:33:02.698231 [debug] [MainThread]: On master: COMMIT
[0m11:33:02.698644 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:02.698961 [debug] [MainThread]: On master: COMMIT
[0m11:33:02.699408 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:33:02.699709 [debug] [MainThread]: On master: Close
[0m11:33:02.700154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:02.700635 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:33:02.700892 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m11:33:02.701126 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:33:02.701911 [info ] [MainThread]: 
[0m11:33:02.702876 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m11:33:02.705255 [debug] [MainThread]: Command end result
[0m11:33:02.730007 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:02.733221 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:02.741012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:33:02.741472 [info ] [MainThread]: 
[0m11:33:02.741934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:02.742263 [info ] [MainThread]: 
[0m11:33:02.742593 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:33:02.744879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.892566, "process_in_blocks": "110552", "process_kernel_time": 2.306689, "process_mem_max_rss": "107548", "process_out_blocks": "3392", "process_user_time": 2.752733}
[0m11:33:02.745498 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:02.745376 after 1.89 seconds
[0m11:33:02.745955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d68785c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d68a7ca870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6870f2b70>]}
[0m11:33:02.746345 [debug] [MainThread]: Flushing usage events
[0m11:33:07.770421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:41.474655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce62699d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce6378ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce6034b30>]}


============================== 11:33:41.481054 | 745f4522-02bf-43ec-b44d-4202503a712b ==============================
[0m11:33:41.481054 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:33:41.481812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:33:41.667636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce5ce76e0>]}
[0m11:33:41.730725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce5ce4050>]}
[0m11:33:41.733052 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:33:41.793036 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:33:41.922232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:41.923081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:41.953523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce44c0230>]}
[0m11:33:42.016321 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:42.019549 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:42.042054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce42199d0>]}
[0m11:33:42.042765 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:33:42.043128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce4486b70>]}
[0m11:33:42.044865 [info ] [MainThread]: 
[0m11:33:42.045230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:42.045495 [info ] [MainThread]: 
[0m11:33:42.045945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:33:42.049366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:33:42.085529 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:33:42.085972 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:33:42.086415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:42.096973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m11:33:42.098396 [debug] [ThreadPool]: On list_db: Close
[0m11:33:42.100414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:33:42.106753 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:42.107124 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:33:42.107341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:42.125481 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:33:42.125932 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:42.126236 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:33:42.137694 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m11:33:42.139369 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:33:42.139958 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:33:42.144623 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:42.144920 [debug] [MainThread]: On master: BEGIN
[0m11:33:42.145141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:42.151246 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:33:42.151686 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:42.152028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:33:42.166574 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m11:33:42.167926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce43d0170>]}
[0m11:33:42.168392 [debug] [MainThread]: On master: ROLLBACK
[0m11:33:42.168897 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:42.169228 [debug] [MainThread]: On master: BEGIN
[0m11:33:42.169884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:33:42.170221 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.170503 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:42.170743 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.171155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:33:42.171442 [debug] [MainThread]: On master: Close
[0m11:33:42.173969 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:33:42.174454 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m11:33:42.174818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:33:42.175056 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:33:42.180040 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:33:42.180579 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:33:42.208731 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:33:42.210346 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:42.210726 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:33:42.211025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:42.217634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:33:42.217986 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:42.218244 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m11:33:42.227926 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m11:33:42.232849 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:42.233231 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:33:42.233992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:33:42.244029 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:42.244406 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:33:42.245320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:33:42.266735 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:33:42.267132 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:42.267355 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:33:42.270340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:33:42.277126 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:33:42.281685 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:42.282017 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:33:42.286439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:33:42.288396 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:33:42.290205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce681e630>]}
[0m11:33:42.290912 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m11:33:42.291406 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:33:42.292477 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m11:33:42.292824 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:33:42.293285 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m11:33:42.293777 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:33:42.294331 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m11:33:42.294755 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:33:42.295083 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m11:33:42.295405 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:33:42.297517 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m11:33:42.301628 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:33:42.302464 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m11:33:42.302824 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:33:42.304985 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m11:33:42.307502 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:33:42.308235 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:42.308539 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:42.308857 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m11:33:42.309145 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:33:42.309557 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:33:42.309835 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:33:42.315949 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m11:33:42.316490 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:42.316843 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m11:33:42.317176 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m11:33:42.317543 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:42.317899 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m11:33:42.323360 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:33:42.326973 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:42.327345 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m11:33:42.327737 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:33:42.329876 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:42.330397 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m11:33:42.330689 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:33:42.332825 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:42.333112 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:33:42.333362 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:33:42.335256 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:42.335666 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m11:33:42.336028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:33:42.337978 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:33:42.338442 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:33:42.338755 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:42.340640 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:33:42.341271 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:33:42.341688 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:42.342137 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:33:42.344308 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:33:42.346430 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:33:42.346874 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:33:42.347108 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:33:42.348669 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m11:33:42.350415 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m11:33:42.350748 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:33:42.351201 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:33:42.352450 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:33:42.352791 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m11:33:42.353424 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce025bda0>]}
[0m11:33:42.353910 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m11:33:42.354529 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:33:42.356499 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:33:42.357677 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m11:33:42.358238 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '745f4522-02bf-43ec-b44d-4202503a712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce0247200>]}
[0m11:33:42.358750 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m11:33:42.359171 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m11:33:42.360886 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:42.361185 [debug] [MainThread]: On master: BEGIN
[0m11:33:42.361413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:42.366878 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:33:42.367267 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.367507 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:42.367718 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.368095 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:33:42.368361 [debug] [MainThread]: On master: Close
[0m11:33:42.368791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:42.369032 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:33:42.369229 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m11:33:42.369410 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:33:42.369743 [info ] [MainThread]: 
[0m11:33:42.370063 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m11:33:42.370921 [debug] [MainThread]: Command end result
[0m11:33:42.389390 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:42.391112 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:42.396644 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:33:42.397533 [info ] [MainThread]: 
[0m11:33:42.397891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:42.398692 [info ] [MainThread]: 
[0m11:33:42.400235 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:33:42.403153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9680745, "process_in_blocks": "120", "process_kernel_time": 0.381273, "process_mem_max_rss": "107720", "process_out_blocks": "3400", "process_user_time": 1.88979}
[0m11:33:42.404288 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:42.403575 after 0.97 seconds
[0m11:33:42.404737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce6656300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce5f2d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ce7c3e330>]}
[0m11:33:42.405211 [debug] [MainThread]: Flushing usage events
[0m11:33:43.531349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:20.376619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9ace869f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9aafb0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9acd0c620>]}


============================== 11:45:20.392445 | 729bef3c-f9a7-4b8f-9b7e-c974e63f0025 ==============================
[0m11:45:20.392445 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:45:20.393334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:20.715970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9aad40da0>]}
[0m11:45:20.802764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9ab588620>]}
[0m11:45:20.804005 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:45:20.886254 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:45:21.026389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:21.026844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:21.067991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9aad25610>]}
[0m11:45:21.227761 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:45:21.232931 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:45:21.310303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9a91e4b00>]}
[0m11:45:21.310905 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:45:21.311290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9a92dde20>]}
[0m11:45:21.313175 [info ] [MainThread]: 
[0m11:45:21.313636 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:45:21.313947 [info ] [MainThread]: 
[0m11:45:21.314466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:21.320213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:45:21.422908 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:45:21.423783 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:45:21.424356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:21.466650 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m11:45:21.469895 [debug] [ThreadPool]: On list_db: Close
[0m11:45:21.473350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:45:21.482781 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:45:21.484258 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:45:21.484595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:21.501077 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:45:21.501598 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:45:21.501874 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:45:21.513807 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m11:45:21.516410 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:45:21.517300 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:45:21.522653 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:21.523101 [debug] [MainThread]: On master: BEGIN
[0m11:45:21.523399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:21.536052 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:45:21.536556 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:21.536923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:21.553585 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m11:45:21.556078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9a91fff20>]}
[0m11:45:21.556951 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:21.558213 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:21.559286 [debug] [MainThread]: On master: BEGIN
[0m11:45:21.560702 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:45:21.561285 [debug] [MainThread]: On master: COMMIT
[0m11:45:21.561726 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:21.562350 [debug] [MainThread]: On master: COMMIT
[0m11:45:21.563301 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:45:21.564217 [debug] [MainThread]: On master: Close
[0m11:45:21.570533 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:45:21.572364 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m11:45:21.573631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:45:21.574172 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:45:21.584958 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:45:21.586019 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:45:21.629999 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:45:21.630922 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:45:21.631466 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:45:21.631808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:21.643001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:45:21.644334 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:45:21.644702 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m11:45:21.654471 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m11:45:21.661170 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:45:21.661660 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:45:21.662693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:45:21.681526 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:45:21.682112 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:45:21.682447 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:45:21.684887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:45:21.691456 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:45:21.698251 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:45:21.698747 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:45:21.699953 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:45:21.702474 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:45:21.704866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9a8442810>]}
[0m11:45:21.708374 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m11:45:21.709111 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:45:21.710706 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m11:45:21.711388 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:45:21.712194 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m11:45:21.713004 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:45:21.713819 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m11:45:21.714440 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:45:21.714870 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m11:45:21.715264 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:45:21.725390 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:45:21.726140 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m11:45:21.726939 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:45:21.729768 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:45:21.730211 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m11:45:21.733705 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m11:45:21.734196 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:45:21.734822 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:45:21.735381 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:45:21.735814 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:45:21.736474 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m11:45:21.736764 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:45:21.746890 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m11:45:21.747388 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:45:21.747750 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m11:45:21.750981 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m11:45:21.751794 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:45:21.752276 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m11:45:21.754605 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:45:21.758139 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:45:21.758560 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:45:21.759340 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:45:21.760719 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:45:21.761081 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:45:21.761365 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:45:21.763802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:45:21.766352 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:45:21.766836 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m11:45:21.767430 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:45:21.772141 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:45:21.772770 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:45:21.773204 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m11:45:21.774078 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:45:21.774472 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:45:21.776016 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:45:21.777342 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:45:21.778036 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9a829cbc0>]}
[0m11:45:21.778448 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:45:21.779194 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m11:45:21.779793 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:45:21.780602 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:45:21.784106 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m11:45:21.788558 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m11:45:21.789246 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:45:21.789588 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m11:45:21.790268 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:45:21.791550 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m11:45:21.792347 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '729bef3c-f9a7-4b8f-9b7e-c974e63f0025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9a84415e0>]}
[0m11:45:21.792935 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m11:45:21.793448 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m11:45:21.795794 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:21.796283 [debug] [MainThread]: On master: BEGIN
[0m11:45:21.796644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:21.803817 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:45:21.804361 [debug] [MainThread]: On master: COMMIT
[0m11:45:21.804681 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:21.804959 [debug] [MainThread]: On master: COMMIT
[0m11:45:21.805454 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:45:21.805777 [debug] [MainThread]: On master: Close
[0m11:45:21.806244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:21.806515 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:45:21.806747 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m11:45:21.806968 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:45:21.807393 [info ] [MainThread]: 
[0m11:45:21.807740 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m11:45:21.808784 [debug] [MainThread]: Command end result
[0m11:45:21.831061 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:45:21.834758 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:45:21.841835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:45:21.842251 [info ] [MainThread]: 
[0m11:45:21.842652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:21.842971 [info ] [MainThread]: 
[0m11:45:21.843302 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:45:21.844853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5394821, "process_in_blocks": "3984", "process_kernel_time": 1.188061, "process_mem_max_rss": "107156", "process_out_blocks": "3392", "process_user_time": 2.845428}
[0m11:45:21.845434 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:21.845313 after 1.54 seconds
[0m11:45:21.845828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9ace869f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9aacda840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e9a928c5c0>]}
[0m11:45:21.846241 [debug] [MainThread]: Flushing usage events
[0m11:45:22.937840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:00.487025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a999b2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a990da900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a999b2c30>]}


============================== 11:46:00.494739 | 5278545e-e8bb-41d7-ad2a-d6c7353a6e5c ==============================
[0m11:46:00.494739 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:46:00.495710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:46:00.763367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a98e2b920>]}
[0m11:46:00.819104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a996dda00>]}
[0m11:46:00.820100 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:46:00.924535 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:46:01.046947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:01.047696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:01.087693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a98e2aa50>]}
[0m11:46:01.165318 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:01.169125 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:01.199964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a972e4830>]}
[0m11:46:01.200428 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:46:01.200725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a99b58800>]}
[0m11:46:01.202343 [info ] [MainThread]: 
[0m11:46:01.202675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:01.202908 [info ] [MainThread]: 
[0m11:46:01.203325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:01.207909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:46:01.271600 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:46:01.271995 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:46:01.272206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:01.291428 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m11:46:01.293161 [debug] [ThreadPool]: On list_db: Close
[0m11:46:01.295181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:46:01.299280 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:01.299664 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:46:01.299880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:01.305734 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m11:46:01.306464 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:01.306994 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:46:01.315739 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m11:46:01.317259 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:46:01.318348 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:46:01.323598 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:01.323953 [debug] [MainThread]: On master: BEGIN
[0m11:46:01.324162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:01.335686 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:46:01.336108 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:01.336386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:46:01.356002 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m11:46:01.357269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a9a1fac30>]}
[0m11:46:01.357720 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:01.358345 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:01.358823 [debug] [MainThread]: On master: BEGIN
[0m11:46:01.359539 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:46:01.359785 [debug] [MainThread]: On master: COMMIT
[0m11:46:01.359985 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:01.360252 [debug] [MainThread]: On master: COMMIT
[0m11:46:01.360952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:46:01.361223 [debug] [MainThread]: On master: Close
[0m11:46:01.364817 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:46:01.366575 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m11:46:01.367509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:46:01.368065 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:46:01.374991 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:46:01.376318 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:46:01.418720 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:46:01.420369 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:01.421179 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:46:01.421771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:01.439468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:46:01.439896 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:01.440159 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m11:46:01.451223 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m11:46:01.456596 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:01.456956 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:46:01.457891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:01.460576 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:01.460871 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:46:01.461798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:46:01.479840 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:46:01.480459 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:01.480743 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:46:01.484047 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:46:01.494010 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:46:01.498514 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:01.498860 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:46:01.502960 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:46:01.505683 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:46:01.508061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a96581e50>]}
[0m11:46:01.508705 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.14s]
[0m11:46:01.509590 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:46:01.511480 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m11:46:01.512003 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:46:01.512577 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m11:46:01.513610 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m11:46:01.513080 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:46:01.514017 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m11:46:01.514627 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:46:01.517242 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m11:46:01.517693 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:46:01.519934 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:46:01.520612 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m11:46:01.520932 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:46:01.523126 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m11:46:01.525245 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:46:01.526448 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:46:01.526765 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m11:46:01.527227 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:01.527720 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:46:01.528043 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:46:01.528596 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:46:01.536169 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m11:46:01.536599 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:01.536849 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m11:46:01.537808 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m11:46:01.538101 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:46:01.538377 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m11:46:01.546948 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m11:46:01.550352 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:01.550740 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:46:01.551714 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:01.552242 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m11:46:01.554585 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:01.557004 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:46:01.557448 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:46:01.557809 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m11:46:01.558734 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:01.559120 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:46:01.560357 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:46:01.562610 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:46:01.563289 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:01.563650 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m11:46:01.563983 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:46:01.564715 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:46:01.565846 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:46:01.566139 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:46:01.566436 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:46:01.566949 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:46:01.568539 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:46:01.568870 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m11:46:01.569368 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:01.572097 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m11:46:01.572545 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:46:01.573151 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:46:01.573723 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m11:46:01.576640 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:46:01.577811 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:46:01.578427 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:46:01.579514 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a96580860>]}
[0m11:46:01.580739 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m11:46:01.581330 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m11:46:01.582320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5278545e-e8bb-41d7-ad2a-d6c7353a6e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a943bbec0>]}
[0m11:46:01.583132 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:46:01.583950 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.07s]
[0m11:46:01.584911 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m11:46:01.587289 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:01.587742 [debug] [MainThread]: On master: BEGIN
[0m11:46:01.588002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:01.595947 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:46:01.596377 [debug] [MainThread]: On master: COMMIT
[0m11:46:01.596619 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:01.596839 [debug] [MainThread]: On master: COMMIT
[0m11:46:01.597276 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:46:01.597716 [debug] [MainThread]: On master: Close
[0m11:46:01.598216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:01.598461 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:46:01.598648 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m11:46:01.598824 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:46:01.599478 [info ] [MainThread]: 
[0m11:46:01.600048 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:46:01.601000 [debug] [MainThread]: Command end result
[0m11:46:01.620823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:01.622743 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:01.629815 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:46:01.630292 [info ] [MainThread]: 
[0m11:46:01.630755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:01.631188 [info ] [MainThread]: 
[0m11:46:01.631481 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:46:01.632354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1885493, "process_in_blocks": "1000", "process_kernel_time": 0.461396, "process_mem_max_rss": "106956", "process_out_blocks": "3384", "process_user_time": 2.151661}
[0m11:46:01.632796 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:01.632698 after 1.19 seconds
[0m11:46:01.633096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a991a4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a98dc3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a999b0170>]}
[0m11:46:01.633392 [debug] [MainThread]: Flushing usage events
[0m11:46:02.631324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:59.955235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc078d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc1d309b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc078ed50>]}


============================== 11:46:59.968549 | 55a6b7be-c927-40b8-9112-11c967b52701 ==============================
[0m11:46:59.968549 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:46:59.969217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:47:00.253136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc02d3fb0>]}
[0m11:47:00.327381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc01ca810>]}
[0m11:47:00.328421 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:47:00.417704 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:47:00.588848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:00.589360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:00.634561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dbe9f10a0>]}
[0m11:47:00.730557 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:47:00.732853 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:47:00.778273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dbe742b10>]}
[0m11:47:00.781835 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:47:00.782150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dbe672900>]}
[0m11:47:00.783564 [info ] [MainThread]: 
[0m11:47:00.783872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:47:00.784094 [info ] [MainThread]: 
[0m11:47:00.784624 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:47:00.791809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:47:00.879113 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:47:00.879671 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:47:00.880003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:00.903909 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m11:47:00.905884 [debug] [ThreadPool]: On list_db: Close
[0m11:47:00.907762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:47:00.913169 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:47:00.913587 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:47:00.913877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:00.926445 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:47:00.926909 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:47:00.927207 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:47:00.935129 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m11:47:00.936418 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:47:00.937930 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:47:00.944022 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:00.944845 [debug] [MainThread]: On master: BEGIN
[0m11:47:00.946372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:00.955863 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:47:00.956333 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:00.956698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:47:00.972313 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m11:47:00.974078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc01cb380>]}
[0m11:47:00.974589 [debug] [MainThread]: On master: ROLLBACK
[0m11:47:00.975205 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:00.975533 [debug] [MainThread]: On master: BEGIN
[0m11:47:00.976219 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:47:00.976559 [debug] [MainThread]: On master: COMMIT
[0m11:47:00.976834 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:00.977098 [debug] [MainThread]: On master: COMMIT
[0m11:47:00.977594 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:47:00.977898 [debug] [MainThread]: On master: Close
[0m11:47:00.981834 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:47:00.982584 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m11:47:00.983086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:47:00.983406 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:47:00.991795 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:47:00.992579 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:47:01.111134 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:47:01.114187 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:01.114672 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:47:01.114896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:01.129585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:47:01.130010 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:01.130249 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m11:47:01.145470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m11:47:01.151345 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:01.151801 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:47:01.153427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:01.156127 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:01.156825 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:47:01.159000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:01.180752 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:47:01.181228 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:01.181541 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:47:01.184439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:47:01.191714 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:47:01.202110 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:01.202623 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:47:01.207042 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:47:01.209721 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:47:01.212074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc0217e60>]}
[0m11:47:01.212800 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m11:47:01.213938 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:47:01.215480 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m11:47:01.216097 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m11:47:01.216915 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:47:01.217678 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m11:47:01.218253 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:47:01.218903 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m11:47:01.219548 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:47:01.224274 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m11:47:01.225419 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:47:01.229372 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:47:01.230114 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m11:47:01.233096 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m11:47:01.233612 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:47:01.237115 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:47:01.237839 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:01.238268 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m11:47:01.238526 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:47:01.239187 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:01.239448 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:47:01.239662 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:47:01.256948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m11:47:01.257782 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:01.258120 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m11:47:01.261836 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m11:47:01.262312 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:01.262608 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m11:47:01.274143 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m11:47:01.276709 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:01.277170 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m11:47:01.277804 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m11:47:01.281412 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:01.282111 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:47:01.282510 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:01.286564 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:01.286993 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:47:01.287304 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m11:47:01.291178 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:01.291921 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:47:01.292347 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:01.292752 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:47:01.294857 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:47:01.296460 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:47:01.296867 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:01.297349 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:01.298068 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:47:01.298449 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:47:01.301932 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m11:47:01.303636 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m11:47:01.304098 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:01.304362 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m11:47:01.304668 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m11:47:01.308032 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:47:01.309261 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:01.310071 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:47:01.310586 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:47:01.313058 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m11:47:01.314112 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dbd8e4aa0>]}
[0m11:47:01.314890 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.10s]
[0m11:47:01.315509 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m11:47:01.316000 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:47:01.318118 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:47:01.318782 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a6b7be-c927-40b8-9112-11c967b52701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dbd82cdd0>]}
[0m11:47:01.319367 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m11:47:01.319894 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:47:01.322220 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:01.322647 [debug] [MainThread]: On master: BEGIN
[0m11:47:01.322934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:01.335316 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:47:01.335927 [debug] [MainThread]: On master: COMMIT
[0m11:47:01.336319 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:01.336540 [debug] [MainThread]: On master: COMMIT
[0m11:47:01.337152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:47:01.337442 [debug] [MainThread]: On master: Close
[0m11:47:01.337830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:01.338046 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:47:01.338229 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m11:47:01.338401 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:47:01.338780 [info ] [MainThread]: 
[0m11:47:01.339537 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m11:47:01.341857 [debug] [MainThread]: Command end result
[0m11:47:01.368794 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:47:01.371200 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:47:01.382009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:47:01.382797 [info ] [MainThread]: 
[0m11:47:01.383287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:01.383546 [info ] [MainThread]: 
[0m11:47:01.383810 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:47:01.386965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.489505, "process_in_blocks": "3312", "process_kernel_time": 0.710076, "process_mem_max_rss": "105960", "process_out_blocks": "3384", "process_user_time": 2.606447}
[0m11:47:01.387758 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:01.387622 after 1.49 seconds
[0m11:47:01.388203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc0d1e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc02d3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1dc0a557f0>]}
[0m11:47:01.388658 [debug] [MainThread]: Flushing usage events
[0m11:47:01.758207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756076fa59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756075bed7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607596e630>]}


============================== 11:47:01.775673 | 871a78a7-87b9-4040-ad4f-55252a0b5e62 ==============================
[0m11:47:01.775673 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:47:01.778253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:47:02.115268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756077346690>]}
[0m11:47:02.213191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560753a7ce0>]}
[0m11:47:02.214543 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:47:02.303742 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:47:02.424029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:02.442416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:02.444381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:02.486553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756075a9bbc0>]}
[0m11:47:02.581826 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:47:02.584377 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:47:02.630510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7560738c4530>]}
[0m11:47:02.631062 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:47:02.631451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607570e8a0>]}
[0m11:47:02.633145 [info ] [MainThread]: 
[0m11:47:02.633593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:47:02.633881 [info ] [MainThread]: 
[0m11:47:02.634617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:47:02.638943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:47:02.789538 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:47:02.790036 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:47:02.790346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:02.803767 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m11:47:02.807010 [debug] [ThreadPool]: On list_db: Close
[0m11:47:02.809041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:47:02.815094 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:47:02.815623 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:47:02.815978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:02.847811 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m11:47:02.848442 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:47:02.848769 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:47:02.854729 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m11:47:02.859996 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:47:02.860885 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:47:02.868155 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:02.868623 [debug] [MainThread]: On master: BEGIN
[0m11:47:02.869250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:02.886205 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:47:02.886763 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:02.887206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:47:02.891276 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:47:02.892688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756073b28f20>]}
[0m11:47:02.893265 [debug] [MainThread]: On master: ROLLBACK
[0m11:47:02.893864 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:02.894188 [debug] [MainThread]: On master: BEGIN
[0m11:47:02.896867 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:47:02.897714 [debug] [MainThread]: On master: COMMIT
[0m11:47:02.898182 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:02.898639 [debug] [MainThread]: On master: COMMIT
[0m11:47:02.899311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:47:02.899637 [debug] [MainThread]: On master: Close
[0m11:47:02.904066 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:47:02.904874 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m11:47:02.905452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:47:02.905967 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:47:02.916171 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:47:02.917427 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:47:02.962013 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:47:02.964415 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:02.964929 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:47:02.965802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:02.974436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:47:02.975119 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:02.975677 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m11:47:02.983778 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m11:47:02.990233 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:02.990776 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:47:02.991778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:02.996099 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:02.996663 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:47:02.998069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:03.035147 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:47:03.035662 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:03.035993 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:47:03.038955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:47:03.049375 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:47:03.058290 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:47:03.058779 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:47:03.062613 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:47:03.071987 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:47:03.074807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756075f76780>]}
[0m11:47:03.075615 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.17s]
[0m11:47:03.076247 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:47:03.078300 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m11:47:03.079435 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:47:03.080035 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m11:47:03.080755 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:47:03.082282 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m11:47:03.083550 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:47:03.084108 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m11:47:03.084694 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:47:03.096890 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m11:47:03.100293 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:47:03.101495 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:47:03.102259 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m11:47:03.105988 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:47:03.109577 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m11:47:03.111328 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:03.112033 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:03.112637 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m11:47:03.115470 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:47:03.114888 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:47:03.116124 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:47:03.125414 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m11:47:03.125866 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:03.126175 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m11:47:03.130445 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m11:47:03.131247 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:03.131771 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m11:47:03.149442 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.022 seconds
[0m11:47:03.154672 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:03.155294 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m11:47:03.156087 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m11:47:03.163275 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:03.163957 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:47:03.164554 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:47:03.167682 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:03.168518 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m11:47:03.169177 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:03.173190 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:03.174008 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:47:03.174816 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:47:03.177315 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:47:03.178213 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:03.178581 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:47:03.179046 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:47:03.181000 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:47:03.181497 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:03.181831 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:47:03.182268 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m11:47:03.184633 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m11:47:03.185366 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:47:03.185867 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m11:47:03.186506 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m11:47:03.189851 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:47:03.192714 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:47:03.194520 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:47:03.196452 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:47:03.198876 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m11:47:03.201048 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756072aaa5d0>]}
[0m11:47:03.201816 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.12s]
[0m11:47:03.202497 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m11:47:03.209263 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m11:47:03.211107 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:47:03.211876 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871a78a7-87b9-4040-ad4f-55252a0b5e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607019f950>]}
[0m11:47:03.212513 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m11:47:03.216971 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:47:03.221206 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:03.222104 [debug] [MainThread]: On master: BEGIN
[0m11:47:03.222519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:03.239004 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:47:03.240250 [debug] [MainThread]: On master: COMMIT
[0m11:47:03.240962 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:03.241917 [debug] [MainThread]: On master: COMMIT
[0m11:47:03.243222 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:47:03.243829 [debug] [MainThread]: On master: Close
[0m11:47:03.246089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:03.247345 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:47:03.248822 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m11:47:03.249469 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:47:03.249857 [info ] [MainThread]: 
[0m11:47:03.250202 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m11:47:03.251114 [debug] [MainThread]: Command end result
[0m11:47:03.284326 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:47:03.286166 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:47:03.292657 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:47:03.293090 [info ] [MainThread]: 
[0m11:47:03.293690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:03.293997 [info ] [MainThread]: 
[0m11:47:03.295305 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:47:03.297419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6088175, "process_in_blocks": "2128", "process_kernel_time": 1.186289, "process_mem_max_rss": "105732", "process_out_blocks": "3384", "process_user_time": 2.811632}
[0m11:47:03.298319 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:03.298131 after 1.61 seconds
[0m11:47:03.298920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75607608eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756073b6c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756073b28f20>]}
[0m11:47:03.299613 [debug] [MainThread]: Flushing usage events
[0m11:47:04.270806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:45.065987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a72a8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a69b57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a72abb60>]}


============================== 15:41:45.074550 | c99c5a3c-4183-47ca-82fc-6368781c79c6 ==============================
[0m15:41:45.074550 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:41:45.075893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:45.418849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99c5a3c-4183-47ca-82fc-6368781c79c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a6b4f530>]}
[0m15:41:45.503341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99c5a3c-4183-47ca-82fc-6368781c79c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a6564740>]}
[0m15:41:45.510596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:41:45.632151 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:41:45.830035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:45.830531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:45.871186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99c5a3c-4183-47ca-82fc-6368781c79c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a4bd0110>]}
[0m15:41:45.951234 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:41:45.956207 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:41:46.034437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99c5a3c-4183-47ca-82fc-6368781c79c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a4a68590>]}
[0m15:41:46.034859 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:41:46.035118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99c5a3c-4183-47ca-82fc-6368781c79c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a4bd1550>]}
[0m15:41:46.036842 [info ] [MainThread]: 
[0m15:41:46.037405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:46.038128 [info ] [MainThread]: 
[0m15:41:46.039004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:46.043154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:41:46.143992 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:41:46.144726 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:41:46.145278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:50.002036 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m15:41:53.734292 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:41:53.735418 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:41:53.736349 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:41:53.736812 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:41:53.737177 [debug] [ThreadPool]: On list_db: No close available on handle
[0m15:41:53.738026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:53.738337 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m15:41:53.738624 [info ] [MainThread]: 
[0m15:41:53.738985 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m15:41:53.739461 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m15:41:53.741707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.746223, "process_in_blocks": "105040", "process_kernel_time": 0.764738, "process_mem_max_rss": "102868", "process_out_blocks": "2464", "process_user_time": 2.492479}
[0m15:41:53.742332 [debug] [MainThread]: Command `dbt run` failed at 15:41:53.742212 after 8.75 seconds
[0m15:41:53.742736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a7287860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a3cebf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5a48d9c70>]}
[0m15:41:53.743125 [debug] [MainThread]: Flushing usage events
[0m15:41:54.634740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:34.219920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4f2a1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4f180800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4f2a3c20>]}


============================== 15:42:34.225207 | 0fb1ff13-ee9b-4149-b502-699ca319a9ce ==============================
[0m15:42:34.225207 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:42:34.225857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:34.499269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fb1ff13-ee9b-4149-b502-699ca319a9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a50c1b140>]}
[0m15:42:34.576952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fb1ff13-ee9b-4149-b502-699ca319a9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a501a8170>]}
[0m15:42:34.577939 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:42:34.661193 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:42:34.797266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:34.797802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:34.829042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fb1ff13-ee9b-4149-b502-699ca319a9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4d4c8cb0>]}
[0m15:42:34.894025 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:42:34.896251 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:42:34.916666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fb1ff13-ee9b-4149-b502-699ca319a9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4d1e64e0>]}
[0m15:42:34.917505 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:42:34.918027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb1ff13-ee9b-4149-b502-699ca319a9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4d4a2d80>]}
[0m15:42:34.920388 [info ] [MainThread]: 
[0m15:42:34.920822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:34.921045 [info ] [MainThread]: 
[0m15:42:34.921404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:34.925302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:42:35.007497 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:42:35.007827 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:35.009133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.854653 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m15:42:42.668742 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:42.669765 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:42:42.670359 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:42:42.670687 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:42:42.671079 [debug] [ThreadPool]: On list_db: No close available on handle
[0m15:42:42.672380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:42.672785 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m15:42:42.673254 [info ] [MainThread]: 
[0m15:42:42.673690 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m15:42:42.674310 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m15:42:42.678869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.504871, "process_in_blocks": "0", "process_kernel_time": 0.444909, "process_mem_max_rss": "103164", "process_out_blocks": "2472", "process_user_time": 1.95584}
[0m15:42:42.679545 [debug] [MainThread]: Command `dbt run` failed at 15:42:42.679405 after 8.51 seconds
[0m15:42:42.679982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4f695370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4d192570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a4d179a60>]}
[0m15:42:42.680399 [debug] [MainThread]: Flushing usage events
[0m15:42:43.855483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:32.536703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a19b67ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a19e259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a19b67c50>]}


============================== 15:44:32.546091 | 2b407150-6b48-40b9-a746-ab30c8ec2e66 ==============================
[0m15:44:32.546091 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:44:32.547387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:44:32.781676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b407150-6b48-40b9-a746-ab30c8ec2e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a1ba9b380>]}
[0m15:44:32.833913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b407150-6b48-40b9-a746-ab30c8ec2e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a19c4c980>]}
[0m15:44:32.834655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:32.900643 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:44:33.050056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:33.050440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:33.076655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b407150-6b48-40b9-a746-ab30c8ec2e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a18154dd0>]}
[0m15:44:33.131214 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:44:33.133180 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:44:33.153436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b407150-6b48-40b9-a746-ab30c8ec2e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a17ff4890>]}
[0m15:44:33.153793 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:44:33.154070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b407150-6b48-40b9-a746-ab30c8ec2e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a181541a0>]}
[0m15:44:33.155474 [info ] [MainThread]: 
[0m15:44:33.155732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:33.155897 [info ] [MainThread]: 
[0m15:44:33.156205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:33.160197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:44:33.202008 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:44:33.202327 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:44:33.202547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:37.898682 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m15:44:41.658363 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:44:41.659299 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:44:41.659811 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:44:41.660115 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:44:41.660451 [debug] [ThreadPool]: On list_db: No close available on handle
[0m15:44:41.661616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:41.661988 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m15:44:41.662370 [info ] [MainThread]: 
[0m15:44:41.662808 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m15:44:41.663364 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m15:44:41.664767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.252925, "process_in_blocks": "0", "process_kernel_time": 0.381348, "process_mem_max_rss": "103824", "process_out_blocks": "2464", "process_user_time": 1.609644}
[0m15:44:41.665497 [debug] [MainThread]: Command `dbt run` failed at 15:44:41.665364 after 8.25 seconds
[0m15:44:41.665890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a1ab7b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a17ff47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a1800fc50>]}
[0m15:44:41.666254 [debug] [MainThread]: Flushing usage events
[0m15:44:42.916034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:51.591475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827cbdcdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827caa5dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827caa5f3e0>]}


============================== 15:46:51.597636 | fd42f61a-a113-4ce7-9175-de61b55ca545 ==============================
[0m15:46:51.597636 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:46:51.598146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:51.803723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd42f61a-a113-4ce7-9175-de61b55ca545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827ca2104a0>]}
[0m15:46:51.868124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd42f61a-a113-4ce7-9175-de61b55ca545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827caa29ac0>]}
[0m15:46:51.868926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:51.924577 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:46:52.004595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:52.005058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:52.031067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd42f61a-a113-4ce7-9175-de61b55ca545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8734d10>]}
[0m15:46:52.092280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:46:52.094250 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:46:52.113886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd42f61a-a113-4ce7-9175-de61b55ca545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c83e44a0>]}
[0m15:46:52.114409 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:46:52.114893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd42f61a-a113-4ce7-9175-de61b55ca545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c83e0830>]}
[0m15:46:52.116294 [info ] [MainThread]: 
[0m15:46:52.116596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:52.116849 [info ] [MainThread]: 
[0m15:46:52.117255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:52.120441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:46:52.159621 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:46:52.159973 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:52.160218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:55.941867 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m15:46:59.719381 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:59.719802 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:46:59.720158 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:46:59.720370 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:46:59.720561 [debug] [ThreadPool]: On list_db: No close available on handle
[0m15:46:59.721504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:59.721761 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m15:46:59.721993 [info ] [MainThread]: 
[0m15:46:59.722303 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m15:46:59.722765 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m15:46:59.724006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.171486, "process_in_blocks": "0", "process_kernel_time": 0.26083, "process_mem_max_rss": "103772", "process_out_blocks": "2472", "process_user_time": 1.615463}
[0m15:46:59.724725 [debug] [MainThread]: Command `dbt run` failed at 15:46:59.724562 after 8.17 seconds
[0m15:46:59.725108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827cab08f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8283dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827cac23b30>]}
[0m15:46:59.725439 [debug] [MainThread]: Flushing usage events
[0m15:47:00.600376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:07.795128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94cc17860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94ccc8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94e2fdfa0>]}


============================== 15:47:07.803375 | 32992767-d376-41e3-8e66-fed814447b02 ==============================
[0m15:47:07.803375 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:47:07.804396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:08.041167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32992767-d376-41e3-8e66-fed814447b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94c3efd40>]}
[0m15:47:08.114791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32992767-d376-41e3-8e66-fed814447b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94c53d910>]}
[0m15:47:08.116168 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:08.185699 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:47:08.299029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:08.299575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:08.337056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32992767-d376-41e3-8e66-fed814447b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94ac28bc0>]}
[0m15:47:08.459848 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:08.465717 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:08.501572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32992767-d376-41e3-8e66-fed814447b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94a9bf860>]}
[0m15:47:08.502117 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:47:08.502485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32992767-d376-41e3-8e66-fed814447b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94ac0cbc0>]}
[0m15:47:08.504187 [info ] [MainThread]: 
[0m15:47:08.504563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:08.504838 [info ] [MainThread]: 
[0m15:47:08.505317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:08.512067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:47:08.570038 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:47:08.570476 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:47:08.570724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:12.468472 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m15:47:16.253682 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:47:16.254452 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:47:16.255042 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:47:16.255396 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:47:16.255775 [debug] [ThreadPool]: On list_db: No close available on handle
[0m15:47:16.257124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:16.257737 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m15:47:16.258173 [info ] [MainThread]: 
[0m15:47:16.258777 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m15:47:16.259377 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m15:47:16.260496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.526447, "process_in_blocks": "0", "process_kernel_time": 0.416996, "process_mem_max_rss": "103516", "process_out_blocks": "2456", "process_user_time": 2.130852}
[0m15:47:16.261151 [debug] [MainThread]: Command `dbt run` failed at 15:47:16.261023 after 8.53 seconds
[0m15:47:16.261555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94ca83c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94ac2ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a94ac28350>]}
[0m15:47:16.261958 [debug] [MainThread]: Flushing usage events
[0m15:47:17.168464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:20.353378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b80dd4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b7f0284a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b7ee15430>]}


============================== 15:47:20.360720 | 27786ab8-ab17-4c4e-84ce-e4614120b353 ==============================
[0m15:47:20.360720 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:47:20.361325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:20.595827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27786ab8-ab17-4c4e-84ce-e4614120b353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b80d04fb0>]}
[0m15:47:20.676803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27786ab8-ab17-4c4e-84ce-e4614120b353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b80ab9d30>]}
[0m15:47:20.678083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:20.753197 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:47:20.964294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:20.964914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:21.007523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27786ab8-ab17-4c4e-84ce-e4614120b353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b7d36f8c0>]}
[0m15:47:21.698406 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:21.702393 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:21.732945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27786ab8-ab17-4c4e-84ce-e4614120b353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b7ff2c050>]}
[0m15:47:21.733667 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:47:21.734506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27786ab8-ab17-4c4e-84ce-e4614120b353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b7d167e30>]}
[0m15:47:21.737748 [info ] [MainThread]: 
[0m15:47:21.738198 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:21.739126 [info ] [MainThread]: 
[0m15:47:21.739951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:21.744729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:47:21.793524 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:47:21.793983 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:47:21.794273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:25.698550 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m15:47:29.403689 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:47:29.404254 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:47:29.404614 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:47:29.404880 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:47:29.405115 [debug] [ThreadPool]: On list_db: No close available on handle
[0m15:47:29.405986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:29.406262 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m15:47:29.406523 [info ] [MainThread]: 
[0m15:47:29.406811 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m15:47:29.407176 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m15:47:29.408045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.428597, "process_in_blocks": "0", "process_kernel_time": 0.362407, "process_mem_max_rss": "103468", "process_out_blocks": "2464", "process_user_time": 2.20394}
[0m15:47:29.408472 [debug] [MainThread]: Command `dbt run` failed at 15:47:29.408388 after 8.43 seconds
[0m15:47:29.408725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b7f560ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b821af4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b7d043410>]}
[0m15:47:29.408964 [debug] [MainThread]: Flushing usage events
[0m15:47:30.592762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:45.529740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac2f0d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac2df04a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac332af00>]}


============================== 14:23:45.552608 | 2374dc9a-e659-4a5a-a41c-e6412059cd05 ==============================
[0m14:23:45.552608 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:23:45.554704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:45.986781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac3304ef0>]}
[0m14:23:46.113482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac294f620>]}
[0m14:23:46.116668 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:23:46.384661 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:23:46.820316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:46.824810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:46.949931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac2f6ed80>]}
[0m14:23:47.132230 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:23:47.139983 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:23:47.213068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac0e7c2c0>]}
[0m14:23:47.214803 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:23:47.215807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac110b5c0>]}
[0m14:23:47.219689 [info ] [MainThread]: 
[0m14:23:47.220918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:47.221628 [info ] [MainThread]: 
[0m14:23:47.222726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:47.230656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:23:47.350521 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:23:47.351536 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:23:47.352162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:47.390108 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m14:23:47.392417 [debug] [ThreadPool]: On list_db: Close
[0m14:23:47.395647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:23:47.405679 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:23:47.406328 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:23:47.406750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:47.419073 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m14:23:47.420491 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:23:47.421429 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:23:47.448343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.026 seconds
[0m14:23:47.452643 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:23:47.454608 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:23:47.463294 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:47.464091 [debug] [MainThread]: On master: BEGIN
[0m14:23:47.464612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:47.475643 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:23:47.476406 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:47.477094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:47.497995 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m14:23:47.500763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac0f64920>]}
[0m14:23:47.501931 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:47.503406 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:47.504144 [debug] [MainThread]: On master: BEGIN
[0m14:23:47.505892 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:23:47.506889 [debug] [MainThread]: On master: COMMIT
[0m14:23:47.507828 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:47.508749 [debug] [MainThread]: On master: COMMIT
[0m14:23:47.510148 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:23:47.511968 [debug] [MainThread]: On master: Close
[0m14:23:47.523010 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:23:47.524460 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:23:47.525718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:23:47.526835 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:23:47.546475 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:23:47.552532 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:23:47.687407 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:23:47.689651 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:23:47.690763 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:23:47.692215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:47.717265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m14:23:47.719097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:23:47.721628 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:23:47.768586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m14:23:47.780214 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:23:47.781049 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:23:47.782814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:47.812730 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:23:47.813580 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:23:47.814424 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:23:47.819890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:23:47.831523 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:23:47.842016 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:23:47.843304 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:23:47.846591 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:23:47.851109 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:23:47.855984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac4892120>]}
[0m14:23:47.857133 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.33s]
[0m14:23:47.859227 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:23:47.862561 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:23:47.863999 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:23:47.864856 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:23:47.866632 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:23:47.868340 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:23:47.869264 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:23:47.870064 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:23:47.870772 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:23:47.879363 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:23:47.884012 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:23:47.885756 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:23:47.890361 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:23:47.891013 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:23:47.897126 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:23:47.898970 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:23:47.899632 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:23:47.900327 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:23:47.901026 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:23:47.901849 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:23:47.902528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:23:47.915578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m14:23:47.917550 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:23:47.918279 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:23:47.919705 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m14:23:47.920224 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:23:47.920694 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:23:47.941864 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m14:23:47.948334 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:23:47.949192 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:23:47.951099 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:47.955914 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:23:47.956983 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.036 seconds
[0m14:23:47.958783 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:23:47.966343 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:23:47.967172 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:23:47.968139 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:23:47.970027 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:47.972736 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:23:47.973423 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:23:47.973991 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:23:48.000587 [debug] [Thread-4 (]: SQL status: COMMIT in 0.031 seconds
[0m14:23:48.005497 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:23:48.006442 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m14:23:48.007713 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:23:48.012392 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:23:48.013923 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:23:48.015748 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:23:48.017126 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:23:48.018446 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:23:48.019274 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:23:48.023152 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:23:48.026965 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:23:48.029024 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ab8e4b980>]}
[0m14:23:48.031229 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m14:23:48.033117 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2374dc9a-e659-4a5a-a41c-e6412059cd05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac0133830>]}
[0m14:23:48.034883 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:23:48.036871 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.16s]
[0m14:23:48.039164 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:23:48.046037 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:48.046905 [debug] [MainThread]: On master: BEGIN
[0m14:23:48.047730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:48.062259 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:23:48.063429 [debug] [MainThread]: On master: COMMIT
[0m14:23:48.064514 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:48.065525 [debug] [MainThread]: On master: COMMIT
[0m14:23:48.067056 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:23:48.067680 [debug] [MainThread]: On master: Close
[0m14:23:48.069036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:48.070439 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:23:48.071456 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:23:48.072412 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:23:48.073164 [info ] [MainThread]: 
[0m14:23:48.073914 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m14:23:48.077674 [debug] [MainThread]: Command end result
[0m14:23:48.140094 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:23:48.145000 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:23:48.163768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:23:48.164501 [info ] [MainThread]: 
[0m14:23:48.166119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:48.167676 [info ] [MainThread]: 
[0m14:23:48.168736 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:23:48.175415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7800357, "process_in_blocks": "94872", "process_kernel_time": 1.252015, "process_mem_max_rss": "106736", "process_out_blocks": "3384", "process_user_time": 4.971476}
[0m14:23:48.176754 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:48.176500 after 2.78 seconds
[0m14:23:48.177615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac312d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac0eb86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ac34c8170>]}
[0m14:23:48.178452 [debug] [MainThread]: Flushing usage events
[0m14:23:49.077939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:15.637539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bd535ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bd1428d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bdc63c80>]}


============================== 14:24:15.649983 | e3d4ed25-334e-4b94-bc4a-58b543286cd3 ==============================
[0m14:24:15.649983 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:24:15.651378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:24:16.198911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bd30f440>]}
[0m14:24:16.468516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bcf374d0>]}
[0m14:24:16.470955 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:16.614111 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:24:16.812952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:16.813648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:16.875325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bb528710>]}
[0m14:24:17.006206 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:24:17.011923 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:24:17.067037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bb3d8560>]}
[0m14:24:17.068036 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:24:17.069242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bb3f2600>]}
[0m14:24:17.075399 [info ] [MainThread]: 
[0m14:24:17.076541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:24:17.077542 [info ] [MainThread]: 
[0m14:24:17.081077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:17.092120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:24:17.167261 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:24:17.167973 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:24:17.168444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:17.184580 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m14:24:17.187116 [debug] [ThreadPool]: On list_db: Close
[0m14:24:17.191944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:24:17.201536 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:24:17.202097 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:24:17.203407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:17.215745 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m14:24:17.216355 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:24:17.216871 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:24:17.231101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m14:24:17.236060 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:24:17.237317 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:24:17.252493 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:17.253162 [debug] [MainThread]: On master: BEGIN
[0m14:24:17.253637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:17.266013 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:24:17.266747 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:17.267397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:17.273718 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:24:17.276930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bceeb440>]}
[0m14:24:17.278008 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:17.279257 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:17.279910 [debug] [MainThread]: On master: BEGIN
[0m14:24:17.281201 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:24:17.281799 [debug] [MainThread]: On master: COMMIT
[0m14:24:17.282285 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:17.282767 [debug] [MainThread]: On master: COMMIT
[0m14:24:17.283836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:17.284398 [debug] [MainThread]: On master: Close
[0m14:24:17.289597 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:24:17.290830 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:24:17.292006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:24:17.292680 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:24:17.305331 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:24:17.306739 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:24:17.367799 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:24:17.369602 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:24:17.370791 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:24:17.372282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:17.385996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m14:24:17.386716 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:24:17.387476 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:24:17.404568 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m14:24:17.415296 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:24:17.416085 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:24:17.417894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:17.423353 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:24:17.424196 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:24:17.425517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:17.463464 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:24:17.464226 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:24:17.464769 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:24:17.469890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:24:17.484203 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:24:17.493676 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:24:17.494410 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:24:17.506058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m14:24:17.510698 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:24:17.514075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bda6e5a0>]}
[0m14:24:17.515938 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.22s]
[0m14:24:17.517032 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:24:17.519133 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:24:17.520064 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:24:17.520891 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:24:17.521952 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:24:17.523025 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:24:17.524126 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:24:17.524893 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:24:17.525766 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:24:17.531073 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:24:17.535615 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:24:17.536966 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:24:17.537733 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:24:17.542584 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:24:17.547972 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:24:17.549907 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:24:17.550775 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:24:17.551849 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:24:17.552671 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:24:17.553442 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:24:17.554107 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:24:17.568097 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m14:24:17.568879 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:24:17.569529 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:24:17.571685 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m14:24:17.572250 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:24:17.572869 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:24:17.594270 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m14:24:17.600489 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.027 seconds
[0m14:24:17.599960 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:24:17.605456 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:24:17.606539 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:24:17.607434 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:24:17.609519 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:17.611926 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:24:17.631859 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:24:17.636912 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:24:17.637856 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:24:17.639291 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:24:17.641629 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:17.644502 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:24:17.645293 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:24:17.645954 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:24:17.646716 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:24:17.650465 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:24:17.652002 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:24:17.653339 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:24:17.657246 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m14:24:17.661495 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:24:17.662609 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:24:17.663328 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:24:17.664004 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m14:24:17.667666 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:24:17.668703 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:24:17.669275 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:24:17.671950 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:24:17.676102 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:24:17.676866 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:24:17.679466 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:24:17.680922 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664ba595b50>]}
[0m14:24:17.683110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d4ed25-334e-4b94-bc4a-58b543286cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664ba62c140>]}
[0m14:24:17.684750 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m14:24:17.686271 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.16s]
[0m14:24:17.688499 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:24:17.690621 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:24:17.698039 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:17.698673 [debug] [MainThread]: On master: BEGIN
[0m14:24:17.699408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:17.714417 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m14:24:17.715400 [debug] [MainThread]: On master: COMMIT
[0m14:24:17.716344 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:17.717029 [debug] [MainThread]: On master: COMMIT
[0m14:24:17.718247 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:24:17.718835 [debug] [MainThread]: On master: Close
[0m14:24:17.720067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:17.720588 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:24:17.721023 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:24:17.721459 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:24:17.722150 [info ] [MainThread]: 
[0m14:24:17.722767 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m14:24:17.726212 [debug] [MainThread]: Command end result
[0m14:24:17.770681 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:24:17.775536 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:24:17.787657 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:24:17.789342 [info ] [MainThread]: 
[0m14:24:17.791042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:17.792995 [info ] [MainThread]: 
[0m14:24:17.794591 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:24:17.798261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3004427, "process_in_blocks": "0", "process_kernel_time": 0.780338, "process_mem_max_rss": "107864", "process_out_blocks": "3384", "process_user_time": 4.553973}
[0m14:24:17.799320 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:17.799033 after 2.30 seconds
[0m14:24:17.800034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bd88bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664bd1a0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7664c06be8a0>]}
[0m14:24:17.800669 [debug] [MainThread]: Flushing usage events
[0m14:24:18.850160 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:15.258459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b208dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b3a705c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b208dac0>]}


============================== 14:25:15.268980 | e1d596cf-49a1-43a6-8c80-dcc5256ee64b ==============================
[0m14:25:15.268980 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:25:15.269833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:15.575658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b1b012e0>]}
[0m14:25:15.656714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b1a3be60>]}
[0m14:25:15.657902 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:25:15.739423 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:25:15.880473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:15.881034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:15.916882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b0271760>]}
[0m14:25:15.990529 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:25:15.993107 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:25:16.018962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04afed8e60>]}
[0m14:25:16.019516 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:25:16.019884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b1fd7170>]}
[0m14:25:16.021598 [info ] [MainThread]: 
[0m14:25:16.021996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:16.022758 [info ] [MainThread]: 
[0m14:25:16.023686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:16.028043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:25:16.081239 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:25:16.081730 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:25:16.082033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:16.096493 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m14:25:16.099365 [debug] [ThreadPool]: On list_db: Close
[0m14:25:16.102228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:25:16.110220 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:25:16.110665 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:25:16.110938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:16.119121 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:25:16.119914 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:25:16.120477 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:25:16.124289 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m14:25:16.126829 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:25:16.127655 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:25:16.134725 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:16.135210 [debug] [MainThread]: On master: BEGIN
[0m14:25:16.135570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:16.144884 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:25:16.145408 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:16.145813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:16.153307 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:25:16.154868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b1a3b590>]}
[0m14:25:16.155392 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:16.156015 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:16.156408 [debug] [MainThread]: On master: BEGIN
[0m14:25:16.157444 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:25:16.158120 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.158643 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:16.159142 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.159968 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:16.160339 [debug] [MainThread]: On master: Close
[0m14:25:16.165472 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:25:16.166294 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:25:16.166945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:25:16.167361 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:25:16.174567 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:25:16.175367 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:25:16.224113 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:25:16.225119 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:25:16.225518 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:25:16.225837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:16.234564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:25:16.235386 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:25:16.236075 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:25:16.245444 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m14:25:16.252302 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:25:16.252887 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:25:16.253956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:16.256887 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:25:16.257284 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:25:16.258277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:16.278851 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:25:16.279379 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:25:16.279836 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:25:16.284075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:25:16.291666 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:25:16.297500 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:25:16.298012 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:25:16.302636 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:25:16.306801 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:25:16.309727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b25c6570>]}
[0m14:25:16.310857 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.14s]
[0m14:25:16.311700 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:25:16.313546 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:25:16.314379 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:25:16.315177 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:25:16.316125 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:25:16.317141 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:25:16.317863 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:25:16.318352 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:25:16.318833 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:25:16.321859 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:25:16.324676 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:25:16.325876 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:25:16.328912 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:25:16.329362 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:25:16.332601 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:25:16.333557 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:25:16.334025 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:16.334423 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:25:16.334867 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:25:16.335290 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:16.335711 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:16.343794 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m14:25:16.344279 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:25:16.344707 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:25:16.345753 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:25:16.346335 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:16.346997 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:25:16.353466 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:25:16.358807 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:25:16.359435 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:25:16.360135 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:25:16.363389 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:16.364259 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:25:16.364896 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:16.367670 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:25:16.368138 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:25:16.368838 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:25:16.371682 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:16.372461 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:25:16.373170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:16.375054 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:25:16.375565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:25:16.376061 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:25:16.377651 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:25:16.378113 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:25:16.378549 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:16.379105 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:25:16.385232 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m14:25:16.387727 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:25:16.388403 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:25:16.388937 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m14:25:16.389506 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:25:16.393085 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:25:16.394196 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:16.394812 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:25:16.398101 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:25:16.400647 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:25:16.401366 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:25:16.403697 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:25:16.404435 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b048ff4f800>]}
[0m14:25:16.406455 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d596cf-49a1-43a6-8c80-dcc5256ee64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04af1102f0>]}
[0m14:25:16.405711 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m14:25:16.407687 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m14:25:16.408581 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:25:16.409512 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:25:16.412106 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:16.412684 [debug] [MainThread]: On master: BEGIN
[0m14:25:16.413047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:16.421508 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:25:16.422244 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.422737 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:16.423204 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.423886 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:16.424316 [debug] [MainThread]: On master: Close
[0m14:25:16.424924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:16.425259 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:25:16.425567 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:25:16.425839 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:25:16.426257 [info ] [MainThread]: 
[0m14:25:16.426667 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m14:25:16.427829 [debug] [MainThread]: Command end result
[0m14:25:16.455150 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:25:16.457831 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:25:16.464866 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:25:16.465336 [info ] [MainThread]: 
[0m14:25:16.465803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:16.466305 [info ] [MainThread]: 
[0m14:25:16.467109 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:25:16.469194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2860299, "process_in_blocks": "0", "process_kernel_time": 0.584891, "process_mem_max_rss": "107660", "process_out_blocks": "3384", "process_user_time": 2.997066}
[0m14:25:16.470034 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:16.469858 after 1.29 seconds
[0m14:25:16.470600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b25c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b01ec2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b04b01ed4c0>]}
[0m14:25:16.471215 [debug] [MainThread]: Flushing usage events
[0m14:25:17.367813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:14.318116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59fa3a2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59fbde4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59fa071070>]}


============================== 14:26:14.327166 | cd8966e6-3a33-4d88-8010-a5bfe6b91bc1 ==============================
[0m14:26:14.327166 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:26:14.327644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:26:14.732693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59fbd67440>]}
[0m14:26:14.836746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59fa013e30>]}
[0m14:26:14.837977 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:26:14.965590 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:26:15.119080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:15.121795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:15.181070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59f9f18830>]}
[0m14:26:15.303143 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:26:15.307379 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:26:15.347394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59f829f2c0>]}
[0m14:26:15.347823 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:26:15.348191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59f82beba0>]}
[0m14:26:15.352745 [info ] [MainThread]: 
[0m14:26:15.354129 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:26:15.354683 [info ] [MainThread]: 
[0m14:26:15.355915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:26:15.375676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:26:15.435099 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:26:15.437853 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:26:15.440415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:15.460210 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m14:26:15.461759 [debug] [ThreadPool]: On list_db: Close
[0m14:26:15.463437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:26:15.469329 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:26:15.469738 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:26:15.470034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:15.491018 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:26:15.491546 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:26:15.491874 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:26:15.499143 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m14:26:15.500480 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:26:15.501091 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:26:15.506434 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.507004 [debug] [MainThread]: On master: BEGIN
[0m14:26:15.507398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:15.516702 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:26:15.517443 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.518205 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:26:15.536860 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m14:26:15.539191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59f82dbe30>]}
[0m14:26:15.539877 [debug] [MainThread]: On master: ROLLBACK
[0m14:26:15.540766 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.541316 [debug] [MainThread]: On master: BEGIN
[0m14:26:15.542251 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:26:15.542683 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.543043 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.543388 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.544224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:26:15.544635 [debug] [MainThread]: On master: Close
[0m14:26:15.547537 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:26:15.548040 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:26:15.548452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:26:15.548761 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:26:15.554371 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:26:15.555074 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:26:15.610172 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:26:15.614048 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:26:15.618110 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:26:15.621841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:15.636851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:26:15.637382 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:26:15.637725 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:26:15.645150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:26:15.653292 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:26:15.653753 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:26:15.655515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:26:15.663896 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:26:15.665159 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:26:15.666936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:26:15.701982 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:26:15.702507 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:26:15.702933 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:26:15.707736 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:26:15.722476 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:26:15.734261 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:26:15.735030 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:26:15.740266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:26:15.744270 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:26:15.746979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59fa93a810>]}
[0m14:26:15.748039 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m14:26:15.749099 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:26:15.751041 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:26:15.752391 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:26:15.751776 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:26:15.753870 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:26:15.755738 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:26:15.756877 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:26:15.758091 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:26:15.759826 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:26:15.777912 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:26:15.785158 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:26:15.787224 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:26:15.788103 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:26:15.793834 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:26:15.797484 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:26:15.798889 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:26:15.799610 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:26:15.800258 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:26:15.800928 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:26:15.801557 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:26:15.802141 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:26:15.823450 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m14:26:15.827534 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:26:15.831019 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:26:15.832826 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m14:26:15.833939 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:26:15.834707 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:26:15.842355 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:26:15.846764 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:26:15.847217 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:26:15.847753 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:26:15.850106 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:26:15.850664 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:26:15.851217 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:26:15.851709 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:26:15.855335 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:26:15.857595 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:26:15.858150 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:26:15.858653 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:26:15.859814 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:26:15.860241 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:26:15.862449 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:26:15.864631 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:26:15.865362 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:26:15.866070 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:26:15.866852 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:26:15.867647 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:26:15.874728 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m14:26:15.881825 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:26:15.882506 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m14:26:15.883520 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:26:15.886262 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:26:15.886848 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:26:15.887509 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:26:15.888237 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:26:15.891304 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:26:15.892413 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:26:15.892779 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:26:15.893213 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59f438ee40>]}
[0m14:26:15.894295 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:26:15.894823 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.14s]
[0m14:26:15.895670 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:26:15.896689 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd8966e6-3a33-4d88-8010-a5bfe6b91bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59f435c1a0>]}
[0m14:26:15.897546 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m14:26:15.897959 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:26:15.900549 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.901070 [debug] [MainThread]: On master: BEGIN
[0m14:26:15.901423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:15.911015 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:26:15.911760 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.912387 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.913399 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.916020 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:26:15.919037 [debug] [MainThread]: On master: Close
[0m14:26:15.921277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:15.922159 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:26:15.922958 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:26:15.923592 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:26:15.924675 [info ] [MainThread]: 
[0m14:26:15.925532 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m14:26:15.927212 [debug] [MainThread]: Command end result
[0m14:26:15.944872 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:26:15.947278 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:26:15.967026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:26:15.967549 [info ] [MainThread]: 
[0m14:26:15.968091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:15.968493 [info ] [MainThread]: 
[0m14:26:15.969368 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:26:15.970680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7270107, "process_in_blocks": "0", "process_kernel_time": 0.470691, "process_mem_max_rss": "107580", "process_out_blocks": "3384", "process_user_time": 3.14725}
[0m14:26:15.971209 [debug] [MainThread]: Command `dbt run` succeeded at 14:26:15.971097 after 1.73 seconds
[0m14:26:15.971573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59fbcaab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59faada840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d59f43b26f0>]}
[0m14:26:15.971917 [debug] [MainThread]: Flushing usage events
[0m14:26:16.829399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:13.770278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989be29e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989d807f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989be29e80>]}


============================== 14:27:13.777792 | 2c5e74eb-049f-4e5f-8b6f-624c875070de ==============================
[0m14:27:13.777792 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:27:13.778611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:27:13.993858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989b865100>]}
[0m14:27:14.062412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989ba92cc0>]}
[0m14:27:14.063292 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:14.140864 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:27:14.253635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:14.254079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:14.292069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989a04fc80>]}
[0m14:27:14.370894 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:27:14.373556 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:27:14.401510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9899dd0d70>]}
[0m14:27:14.402156 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:27:14.403100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989b7a0a40>]}
[0m14:27:14.408808 [info ] [MainThread]: 
[0m14:27:14.409851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:14.410546 [info ] [MainThread]: 
[0m14:27:14.411491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:14.418254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:27:14.470541 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:27:14.471051 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:27:14.471370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:14.481994 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m14:27:14.483624 [debug] [ThreadPool]: On list_db: Close
[0m14:27:14.485236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:27:14.491062 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:27:14.491559 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:27:14.491846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:14.499110 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:27:14.499592 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:27:14.499923 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:27:14.503335 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m14:27:14.504914 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:27:14.505619 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:27:14.512985 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.513562 [debug] [MainThread]: On master: BEGIN
[0m14:27:14.513889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:14.520991 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:27:14.521733 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.522429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:14.526639 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:27:14.529008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989a01f800>]}
[0m14:27:14.529809 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:14.530895 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.531509 [debug] [MainThread]: On master: BEGIN
[0m14:27:14.532462 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:27:14.532817 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.533778 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.534403 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.535396 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:14.536031 [debug] [MainThread]: On master: Close
[0m14:27:14.539736 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:27:14.540376 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:27:14.540854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:27:14.541215 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:27:14.548310 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:27:14.549239 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:27:14.587343 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:27:14.588275 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:27:14.588685 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:27:14.589011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:14.596933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:27:14.597508 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:27:14.597930 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:27:14.606598 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:27:14.614092 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:27:14.614600 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:27:14.615843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.618351 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:27:14.618698 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:27:14.619740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.641545 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:27:14.642089 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:27:14.642455 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:27:14.646627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:27:14.654759 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:27:14.660928 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:27:14.661444 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:27:14.665199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:27:14.667986 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:27:14.669896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989c3be420>]}
[0m14:27:14.670729 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m14:27:14.671330 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:27:14.672911 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:27:14.673361 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:27:14.673945 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:27:14.674559 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:27:14.675583 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:27:14.676255 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:27:14.676695 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:27:14.677139 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:27:14.680518 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:27:14.683492 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:27:14.684309 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:27:14.686895 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:27:14.687444 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:27:14.690274 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:27:14.690796 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:27:14.691606 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:27:14.692037 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:27:14.692429 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:14.693040 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:27:14.693348 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:27:14.701219 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m14:27:14.702172 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:14.702781 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m14:27:14.703326 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:27:14.703863 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:27:14.704461 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:27:14.716967 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:27:14.722118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:14.722716 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m14:27:14.723266 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:27:14.725925 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:27:14.726556 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:27:14.727154 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.727729 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.730783 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:14.733324 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:27:14.733793 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:27:14.734244 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:27:14.735012 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:14.735630 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.737422 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:27:14.739239 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:27:14.739793 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:14.740223 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:27:14.740645 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:27:14.741042 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:27:14.747695 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m14:27:14.751213 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:27:14.751788 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m14:27:14.752553 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:14.754860 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:27:14.755351 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:27:14.756135 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:27:14.756864 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:27:14.759383 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:27:14.761061 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:27:14.761579 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:27:14.762367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9898ec64e0>]}
[0m14:27:14.765091 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:27:14.765932 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m14:27:14.767235 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:27:14.767913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5e74eb-049f-4e5f-8b6f-624c875070de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a98985fffe0>]}
[0m14:27:14.769127 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m14:27:14.770082 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:27:14.772555 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.772961 [debug] [MainThread]: On master: BEGIN
[0m14:27:14.773287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:14.780890 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:27:14.781308 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.781627 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.781927 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.782401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:14.782735 [debug] [MainThread]: On master: Close
[0m14:27:14.783291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:14.783699 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:27:14.783993 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:27:14.784306 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:27:14.784727 [info ] [MainThread]: 
[0m14:27:14.785160 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m14:27:14.786341 [debug] [MainThread]: Command end result
[0m14:27:14.817505 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:27:14.819489 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:27:14.826894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:27:14.827308 [info ] [MainThread]: 
[0m14:27:14.828189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:14.829040 [info ] [MainThread]: 
[0m14:27:14.829520 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:27:14.831245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1190993, "process_in_blocks": "0", "process_kernel_time": 0.323371, "process_mem_max_rss": "108028", "process_out_blocks": "3392", "process_user_time": 2.405075}
[0m14:27:14.831960 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:14.831818 after 1.12 seconds
[0m14:27:14.832394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989c3be420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9899d23170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a989c468e60>]}
[0m14:27:14.832859 [debug] [MainThread]: Flushing usage events
[0m14:27:15.730802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:13.557825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3cf32240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3c82a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3c29d220>]}


============================== 14:28:13.566322 | 22f7c7b4-7e7c-484b-9a10-da7635268960 ==============================
[0m14:28:13.566322 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:28:13.566979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:13.846247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3c1dc0e0>]}
[0m14:28:13.929720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3a93c770>]}
[0m14:28:13.931666 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:28:14.020139 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:28:14.140992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:14.141466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:14.183221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3a9f4860>]}
[0m14:28:14.270481 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:28:14.273441 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:28:14.311188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3a775d30>]}
[0m14:28:14.311699 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:28:14.312037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3a9e1370>]}
[0m14:28:14.313688 [info ] [MainThread]: 
[0m14:28:14.314068 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:14.314354 [info ] [MainThread]: 
[0m14:28:14.314944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:14.320329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:28:14.367044 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:28:14.367487 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:28:14.367750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:14.378631 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m14:28:14.379860 [debug] [ThreadPool]: On list_db: Close
[0m14:28:14.381467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:28:14.385961 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:28:14.386440 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:28:14.386675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:14.393035 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:28:14.393670 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:28:14.394136 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:28:14.397050 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m14:28:14.398200 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:28:14.398670 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:28:14.404912 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:14.405509 [debug] [MainThread]: On master: BEGIN
[0m14:28:14.405927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:14.414479 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:28:14.415184 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:14.415745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:14.418967 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:28:14.420203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3a6e7890>]}
[0m14:28:14.420682 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:14.421177 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:14.421429 [debug] [MainThread]: On master: BEGIN
[0m14:28:14.422188 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:28:14.422882 [debug] [MainThread]: On master: COMMIT
[0m14:28:14.423378 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:14.423855 [debug] [MainThread]: On master: COMMIT
[0m14:28:14.424593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:14.425034 [debug] [MainThread]: On master: Close
[0m14:28:14.428147 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:28:14.428710 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:28:14.429175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:28:14.429466 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:28:14.437673 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:28:14.440408 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:28:14.481748 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:28:14.482487 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:28:14.482785 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:28:14.483008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:14.489423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:28:14.490002 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:28:14.490488 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:28:14.499798 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m14:28:14.505064 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:28:14.505518 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:28:14.506495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:14.508939 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:28:14.509315 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:28:14.510098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:14.537136 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:28:14.537636 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:28:14.537935 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:28:14.541730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:28:14.547324 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:28:14.551870 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:28:14.552447 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:28:14.555883 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:28:14.557864 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:28:14.559796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3cd628d0>]}
[0m14:28:14.560503 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m14:28:14.561718 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:28:14.563587 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:28:14.563981 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:28:14.564762 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:28:14.565295 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:28:14.566353 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:28:14.567359 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:28:14.567789 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:28:14.568212 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:28:14.570691 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:28:14.572707 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:28:14.573671 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:28:14.575885 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:28:14.576438 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:28:14.578973 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:28:14.579977 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:28:14.580325 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:28:14.580608 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:28:14.581460 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:28:14.581753 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:28:14.581998 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:28:14.588489 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m14:28:14.589297 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:28:14.589862 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:28:14.595670 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:28:14.596377 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:28:14.597002 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:28:14.600451 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m14:28:14.610058 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:28:14.610689 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m14:28:14.611316 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:28:14.614830 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:28:14.615591 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:28:14.616083 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:14.616467 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:14.619115 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:28:14.622614 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:28:14.623043 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:28:14.623354 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:28:14.624008 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:14.624280 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:14.625401 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:28:14.626486 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:28:14.626804 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:28:14.627105 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:28:14.627395 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:28:14.627829 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:28:14.640323 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m14:28:14.642474 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:28:14.642985 [debug] [Thread-4 (]: SQL status: COMMIT in 0.015 seconds
[0m14:28:14.643585 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:28:14.646216 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:28:14.647576 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:28:14.648308 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:28:14.648904 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:28:14.652818 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:28:14.655251 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:28:14.656040 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:28:14.660651 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:28:14.661703 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3991cb90>]}
[0m14:28:14.663569 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22f7c7b4-7e7c-484b-9a10-da7635268960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae399131d0>]}
[0m14:28:14.662906 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.10s]
[0m14:28:14.664694 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m14:28:14.665552 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:28:14.666182 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:28:14.669035 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:14.669499 [debug] [MainThread]: On master: BEGIN
[0m14:28:14.669934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:14.675544 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:28:14.676065 [debug] [MainThread]: On master: COMMIT
[0m14:28:14.676448 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:14.676791 [debug] [MainThread]: On master: COMMIT
[0m14:28:14.677343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:14.677621 [debug] [MainThread]: On master: Close
[0m14:28:14.677995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:14.678214 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:28:14.678423 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:28:14.678604 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:28:14.678973 [info ] [MainThread]: 
[0m14:28:14.679268 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m14:28:14.679958 [debug] [MainThread]: Command end result
[0m14:28:14.697124 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:28:14.699475 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:28:14.716504 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:28:14.716985 [info ] [MainThread]: 
[0m14:28:14.717460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:14.718498 [info ] [MainThread]: 
[0m14:28:14.719244 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:28:14.720772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2126001, "process_in_blocks": "0", "process_kernel_time": 0.327723, "process_mem_max_rss": "107676", "process_out_blocks": "3392", "process_user_time": 2.238112}
[0m14:28:14.721298 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:14.721190 after 1.21 seconds
[0m14:28:14.721666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3d76bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3a80ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ae3cf32240>]}
[0m14:28:14.722013 [debug] [MainThread]: Flushing usage events
[0m14:28:15.620278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:13.697519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef28bdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef28482f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef0e6e600>]}


============================== 14:29:13.702730 | 9c495b1b-2bc3-43e5-beb6-4d3263780c7c ==============================
[0m14:29:13.702730 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:29:13.703185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:29:13.884696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef0956c90>]}
[0m14:29:13.941229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef119f200>]}
[0m14:29:13.942138 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:29:14.038418 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:29:14.161081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:14.161591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:14.192809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef08e10d0>]}
[0m14:29:14.267491 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:29:14.270150 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:29:14.309818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eeee8a390>]}
[0m14:29:14.310267 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:29:14.310553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eeecfa900>]}
[0m14:29:14.312345 [info ] [MainThread]: 
[0m14:29:14.312907 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:14.313326 [info ] [MainThread]: 
[0m14:29:14.314048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:14.318644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:29:14.385173 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:29:14.385579 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:29:14.385810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:14.398996 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m14:29:14.400164 [debug] [ThreadPool]: On list_db: Close
[0m14:29:14.401721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:29:14.405975 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:29:14.406339 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:29:14.406609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:14.412604 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:29:14.413001 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:29:14.413268 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:29:14.417922 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m14:29:14.420082 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:29:14.420791 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:29:14.426750 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.427227 [debug] [MainThread]: On master: BEGIN
[0m14:29:14.427580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:14.434095 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:29:14.434710 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.435351 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:29:14.438418 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:29:14.439550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef0b5f7a0>]}
[0m14:29:14.439951 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:14.440382 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.440606 [debug] [MainThread]: On master: BEGIN
[0m14:29:14.441150 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:29:14.441504 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.441806 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.442472 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.443510 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:14.443956 [debug] [MainThread]: On master: Close
[0m14:29:14.448585 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:29:14.449166 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:29:14.449598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:29:14.449872 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:29:14.455962 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:29:14.456628 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:29:14.489806 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:29:14.490475 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:29:14.490760 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:29:14.490975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:14.498105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:29:14.498487 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:29:14.498751 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:29:14.507769 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m14:29:14.512714 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:29:14.513031 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:29:14.513695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:14.515570 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:29:14.515834 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:29:14.516289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:14.532273 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:29:14.532720 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:29:14.533034 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:29:14.537156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:29:14.544661 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:29:14.550542 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:29:14.550995 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:29:14.554435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:14.556349 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:29:14.558641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef13a6840>]}
[0m14:29:14.559236 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m14:29:14.560138 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:29:14.561481 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:29:14.561796 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:29:14.562561 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:29:14.563308 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:29:14.563789 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:29:14.564312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:29:14.564697 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:29:14.564982 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:29:14.567200 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:29:14.569206 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:29:14.569861 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:29:14.570189 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:29:14.572869 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:29:14.575141 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:29:14.575934 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:29:14.576272 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:29:14.576659 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:29:14.577092 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:29:14.577404 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:29:14.577866 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:29:14.584534 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:29:14.585057 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:29:14.585939 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:29:14.586797 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m14:29:14.587354 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:29:14.587619 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:29:14.598837 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:29:14.601297 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:29:14.601603 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:29:14.602208 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:14.604923 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:29:14.605328 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m14:29:14.605656 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:29:14.607622 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:29:14.608095 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:29:14.608485 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:14.608863 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:14.610772 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:29:14.613283 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:29:14.613688 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:29:14.614103 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:29:14.614485 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:29:14.615272 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:14.616741 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:29:14.617147 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:29:14.617449 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:29:14.617825 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:29:14.619534 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:29:14.620319 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:29:14.620675 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:29:14.622028 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:29:14.624471 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:29:14.624865 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:29:14.625357 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:29:14.626400 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:29:14.627493 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:29:14.629279 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eedf5c650>]}
[0m14:29:14.630545 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.07s]
[0m14:29:14.631318 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:29:14.632879 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:14.633944 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:29:14.634432 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c495b1b-2bc3-43e5-beb6-4d3263780c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797eedeb2e10>]}
[0m14:29:14.634885 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m14:29:14.635334 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:29:14.637651 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.638073 [debug] [MainThread]: On master: BEGIN
[0m14:29:14.638371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:14.643969 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:29:14.645893 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.647357 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.648661 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.650508 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:29:14.652127 [debug] [MainThread]: On master: Close
[0m14:29:14.652626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:14.653567 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:29:14.654060 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:29:14.654490 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:29:14.654986 [info ] [MainThread]: 
[0m14:29:14.655581 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:29:14.657079 [debug] [MainThread]: Command end result
[0m14:29:14.672238 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:29:14.674247 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:29:14.679788 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:29:14.680123 [info ] [MainThread]: 
[0m14:29:14.680463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:14.680737 [info ] [MainThread]: 
[0m14:29:14.681035 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:29:14.682158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.039046, "process_in_blocks": "0", "process_kernel_time": 0.379013, "process_mem_max_rss": "108004", "process_out_blocks": "3392", "process_user_time": 1.950921}
[0m14:29:14.682701 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:14.682586 after 1.04 seconds
[0m14:29:14.683113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef0bafe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef13c4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ef13c5160>]}
[0m14:29:14.683569 [debug] [MainThread]: Flushing usage events
[0m14:29:15.642569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:14.074264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb19305d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb18453800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb181546b0>]}


============================== 14:30:14.079965 | 0c577ccd-027d-440f-b6f2-94c25c8ff066 ==============================
[0m14:30:14.079965 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:30:14.080400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:30:14.270212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb1766d070>]}
[0m14:30:14.328876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb190461b0>]}
[0m14:30:14.329805 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:14.386815 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:30:14.496670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:14.497067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:14.526870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb15c43e00>]}
[0m14:30:14.583991 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:30:14.585885 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:30:14.604645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb15918680>]}
[0m14:30:14.605065 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:30:14.605457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb1748bb60>]}
[0m14:30:14.609644 [info ] [MainThread]: 
[0m14:30:14.610380 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:30:14.610802 [info ] [MainThread]: 
[0m14:30:14.611192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:14.614598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:30:14.651477 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:30:14.651826 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:30:14.652021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:14.665921 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m14:30:14.667020 [debug] [ThreadPool]: On list_db: Close
[0m14:30:14.668643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:30:14.672574 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:30:14.672868 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:30:14.673072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:14.678263 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:30:14.678614 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:30:14.678925 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:30:14.681200 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m14:30:14.682193 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:30:14.682577 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:30:14.686539 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:14.686784 [debug] [MainThread]: On master: BEGIN
[0m14:30:14.686976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:14.692227 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:30:14.692673 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:14.693060 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:14.695988 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:30:14.697332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb174135c0>]}
[0m14:30:14.697811 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:14.698282 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:14.698514 [debug] [MainThread]: On master: BEGIN
[0m14:30:14.699157 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:30:14.699808 [debug] [MainThread]: On master: COMMIT
[0m14:30:14.700119 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:14.700406 [debug] [MainThread]: On master: COMMIT
[0m14:30:14.700830 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:14.701071 [debug] [MainThread]: On master: Close
[0m14:30:14.704008 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:30:14.704855 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:30:14.705474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:30:14.705858 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:30:14.713176 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:30:14.713835 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:30:14.743579 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:30:14.744278 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:30:14.744576 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:30:14.744821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:14.750812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:30:14.751371 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:30:14.751873 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:30:14.765500 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m14:30:14.770098 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:30:14.770458 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:30:14.771043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:14.772862 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:30:14.773200 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:30:14.773655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:14.788078 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:30:14.788430 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:30:14.788692 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:30:14.791256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:30:14.796752 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:30:14.800637 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:30:14.800909 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:30:14.804136 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:30:14.805783 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:30:14.807068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb17f92360>]}
[0m14:30:14.807532 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.10s]
[0m14:30:14.807943 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:30:14.809408 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:30:14.809812 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:30:14.810315 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:30:14.811466 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:30:14.811015 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:30:14.811923 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:30:14.812350 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:30:14.815382 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:30:14.815792 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:30:14.818656 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:30:14.819170 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:30:14.821136 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:30:14.821489 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:30:14.823335 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:30:14.823779 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:30:14.824051 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:30:14.824320 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:30:14.824651 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:30:14.825016 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:30:14.825428 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:30:14.831024 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m14:30:14.831404 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:30:14.831655 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:30:14.831947 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m14:30:14.832437 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:30:14.832808 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:30:14.838116 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:30:14.840460 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:30:14.840741 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:30:14.841333 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:14.843306 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:30:14.843656 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:30:14.844027 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:30:14.846817 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:30:14.847388 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:30:14.847647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:14.848873 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:30:14.849258 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:14.849585 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:30:14.852694 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:30:14.853107 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:30:14.853500 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:30:14.854610 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:14.856122 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:30:14.856515 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:30:14.856878 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:30:14.858644 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:30:14.859047 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:30:14.859484 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:30:14.859955 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:30:14.861637 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:30:14.863949 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:30:14.864330 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:30:14.864765 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:30:14.865788 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:30:14.866087 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:30:14.866739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb141f38c0>]}
[0m14:30:14.867272 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m14:30:14.867648 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:30:14.869668 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:30:14.870701 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:30:14.871102 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c577ccd-027d-440f-b6f2-94c25c8ff066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb14ab6150>]}
[0m14:30:14.871504 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m14:30:14.871868 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:30:14.873397 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:14.873750 [debug] [MainThread]: On master: BEGIN
[0m14:30:14.874040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:14.879757 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:30:14.880165 [debug] [MainThread]: On master: COMMIT
[0m14:30:14.880434 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:14.880708 [debug] [MainThread]: On master: COMMIT
[0m14:30:14.881154 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:14.881495 [debug] [MainThread]: On master: Close
[0m14:30:14.881988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:14.882267 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:30:14.882545 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:30:14.882829 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:30:14.883227 [info ] [MainThread]: 
[0m14:30:14.883600 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:30:14.884659 [debug] [MainThread]: Command end result
[0m14:30:14.905831 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:30:14.907269 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:30:14.912157 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:30:14.912407 [info ] [MainThread]: 
[0m14:30:14.912685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:14.913325 [info ] [MainThread]: 
[0m14:30:14.913572 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:30:14.914337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.88498086, "process_in_blocks": "0", "process_kernel_time": 0.376954, "process_mem_max_rss": "107936", "process_out_blocks": "3392", "process_user_time": 1.920861}
[0m14:30:14.914717 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:14.914639 after 0.89 seconds
[0m14:30:14.914999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb19305d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb17fe5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fb17b81b80>]}
[0m14:30:14.915245 [debug] [MainThread]: Flushing usage events
[0m14:30:15.821431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:13.231419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758275f7c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758274446480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758274902480>]}


============================== 14:31:13.236742 | b5f7ac54-4066-47df-87e9-da361e244c5e ==============================
[0m14:31:13.236742 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:31:13.237822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:31:13.446032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758274236f00>]}
[0m14:31:13.499406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7582741c7e60>]}
[0m14:31:13.500321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:31:13.584337 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:31:13.690986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:13.691623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:13.725543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758272774e00>]}
[0m14:31:13.800774 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:31:13.802942 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:31:13.831775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7582724186e0>]}
[0m14:31:13.832213 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:31:13.832497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758272774bc0>]}
[0m14:31:13.833813 [info ] [MainThread]: 
[0m14:31:13.834113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:13.834554 [info ] [MainThread]: 
[0m14:31:13.835296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:13.838820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:31:13.892433 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:31:13.892960 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:31:13.893273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:13.926827 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m14:31:13.927937 [debug] [ThreadPool]: On list_db: Close
[0m14:31:13.929390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:31:13.935477 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:31:13.935891 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:31:13.936216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:13.941749 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:31:13.942268 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:31:13.943044 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:31:13.945858 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m14:31:13.946871 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:31:13.947304 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:31:13.951432 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:13.951747 [debug] [MainThread]: On master: BEGIN
[0m14:31:13.951959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:13.957246 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:31:13.957728 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:13.958130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:31:13.961203 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:31:13.962268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7582727200e0>]}
[0m14:31:13.962666 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:13.963062 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:13.963402 [debug] [MainThread]: On master: BEGIN
[0m14:31:13.964298 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:31:13.964951 [debug] [MainThread]: On master: COMMIT
[0m14:31:13.965156 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:13.965344 [debug] [MainThread]: On master: COMMIT
[0m14:31:13.965661 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:31:13.965876 [debug] [MainThread]: On master: Close
[0m14:31:13.968872 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:31:13.969365 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:31:13.969747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:31:13.969984 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:31:13.977316 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:31:13.978014 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:31:14.004555 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:31:14.005201 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:31:14.005500 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:31:14.005746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:14.011700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:31:14.012356 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:31:14.012654 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:31:14.023587 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:31:14.028163 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:31:14.028490 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:31:14.029197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:31:14.032012 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:31:14.032419 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:31:14.032985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:31:14.056461 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:31:14.056854 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:31:14.057091 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:31:14.062094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:31:14.067661 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:31:14.073520 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:31:14.074864 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:31:14.078333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:31:14.081265 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:31:14.083410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758274aee630>]}
[0m14:31:14.084230 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m14:31:14.084897 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:31:14.085863 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:31:14.086393 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:31:14.086850 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:31:14.087836 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:31:14.088958 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:31:14.089825 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:31:14.090241 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:31:14.090742 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:31:14.094103 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:31:14.097595 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:31:14.098714 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:31:14.099069 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:31:14.101564 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:31:14.104457 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:31:14.105336 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:31:14.105720 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:31:14.106105 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:31:14.106406 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:31:14.106726 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:31:14.107008 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:31:14.114447 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:31:14.114897 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:31:14.115156 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:31:14.117157 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:31:14.117592 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:31:14.117956 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:31:14.147635 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.032 seconds
[0m14:31:14.148196 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.030 seconds
[0m14:31:14.150571 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:31:14.153519 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:31:14.153981 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:31:14.154330 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:31:14.155172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:31:14.155487 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:31:14.158390 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:31:14.160193 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:31:14.160552 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:31:14.161083 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:31:14.162049 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:31:14.162340 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:31:14.163874 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:31:14.165511 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:31:14.165917 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:31:14.166228 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:31:14.166511 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:31:14.166958 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:31:14.191363 [debug] [Thread-4 (]: SQL status: COMMIT in 0.024 seconds
[0m14:31:14.195092 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:31:14.195571 [debug] [Thread-3 (]: SQL status: COMMIT in 0.028 seconds
[0m14:31:14.196236 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:31:14.198518 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:31:14.198989 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:31:14.199624 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:31:14.200181 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:31:14.203149 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:31:14.204774 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:31:14.205191 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:31:14.206253 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:31:14.206891 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7582716b07a0>]}
[0m14:31:14.208398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f7ac54-4066-47df-87e9-da361e244c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7582715e4890>]}
[0m14:31:14.207900 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m14:31:14.209120 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.12s]
[0m14:31:14.209754 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:31:14.210222 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:31:14.212521 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:14.212817 [debug] [MainThread]: On master: BEGIN
[0m14:31:14.213030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:14.218812 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:31:14.219255 [debug] [MainThread]: On master: COMMIT
[0m14:31:14.219484 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:14.219698 [debug] [MainThread]: On master: COMMIT
[0m14:31:14.220194 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:31:14.220467 [debug] [MainThread]: On master: Close
[0m14:31:14.220909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:14.221139 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:31:14.221341 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:31:14.221523 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:31:14.221842 [info ] [MainThread]: 
[0m14:31:14.222143 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m14:31:14.222966 [debug] [MainThread]: Command end result
[0m14:31:14.242964 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:31:14.244420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:31:14.249169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:31:14.249457 [info ] [MainThread]: 
[0m14:31:14.249757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:14.250123 [info ] [MainThread]: 
[0m14:31:14.250699 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:31:14.251867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0651993, "process_in_blocks": "0", "process_kernel_time": 0.367503, "process_mem_max_rss": "107852", "process_out_blocks": "3392", "process_user_time": 1.841513}
[0m14:31:14.252325 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:14.252232 after 1.07 seconds
[0m14:31:14.252626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758274281a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7582718b18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7582718b1940>]}
[0m14:31:14.252933 [debug] [MainThread]: Flushing usage events
[0m14:31:15.181332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:13.671230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860fb3881d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860fb7d0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860fb389070>]}


============================== 14:32:13.677064 | 1c117bc9-80dd-4dd1-9efd-2121977380b6 ==============================
[0m14:32:13.677064 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:32:13.677442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:32:13.851400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860fb2caa80>]}
[0m14:32:13.901301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860fbff3020>]}
[0m14:32:13.902127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:32:13.951239 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:32:14.038743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:32:14.039101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:32:14.066224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860f9ae2c90>]}
[0m14:32:14.126589 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:32:14.129095 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:32:14.154662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860f97c8ad0>]}
[0m14:32:14.155093 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:32:14.155404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860f9874170>]}
[0m14:32:14.156994 [info ] [MainThread]: 
[0m14:32:14.157303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:14.157559 [info ] [MainThread]: 
[0m14:32:14.158126 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:32:14.161172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:32:14.259971 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:32:14.260327 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:32:14.260540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:14.270308 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m14:32:14.271420 [debug] [ThreadPool]: On list_db: Close
[0m14:32:14.272701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:32:14.276726 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:32:14.277037 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:32:14.277227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:14.281803 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:32:14.282055 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:32:14.282254 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:32:14.284222 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m14:32:14.285175 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:32:14.285549 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:32:14.289284 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:14.289647 [debug] [MainThread]: On master: BEGIN
[0m14:32:14.289865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:14.295497 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:32:14.295880 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:14.296177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:32:14.298891 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:32:14.299925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860f97a0830>]}
[0m14:32:14.300282 [debug] [MainThread]: On master: ROLLBACK
[0m14:32:14.300642 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:14.300891 [debug] [MainThread]: On master: BEGIN
[0m14:32:14.301371 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:32:14.301642 [debug] [MainThread]: On master: COMMIT
[0m14:32:14.301974 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:14.302191 [debug] [MainThread]: On master: COMMIT
[0m14:32:14.302573 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:32:14.302814 [debug] [MainThread]: On master: Close
[0m14:32:14.305241 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:32:14.305733 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:32:14.306100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:32:14.306340 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:32:14.311304 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:32:14.311875 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:32:14.337799 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:32:14.338397 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:32:14.338681 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:32:14.338911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:14.345251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:32:14.345593 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:32:14.345828 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:32:14.373613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m14:32:14.379045 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:32:14.379376 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:32:14.380398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:32:14.382234 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:32:14.382485 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:32:14.382997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:14.395583 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:32:14.395883 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:32:14.396118 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:32:14.476737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.080 seconds
[0m14:32:14.484972 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:32:14.488584 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:32:14.489001 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:32:14.494158 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:32:14.495898 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:32:14.497245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860fbe7a720>]}
[0m14:32:14.497748 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.19s]
[0m14:32:14.498161 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:32:14.499769 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:32:14.500345 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:32:14.500799 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:32:14.501468 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:32:14.502232 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:32:14.502862 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:32:14.503372 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:32:14.505767 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:32:14.506104 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:32:14.509276 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:32:14.509723 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:32:14.511603 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:32:14.511978 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:32:14.513989 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:32:14.514433 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:32:14.514745 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:14.514985 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:32:14.515247 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:32:14.515507 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:32:14.515766 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:32:14.521154 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m14:32:14.521639 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:14.521919 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:32:14.522200 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:32:14.522534 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:32:14.522778 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:32:14.528218 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:32:14.530716 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:14.531031 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:32:14.531659 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:14.533734 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:14.534119 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:32:14.534397 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:32:14.536264 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:32:14.536712 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:32:14.537102 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:14.537384 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:14.540252 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:32:14.542469 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:32:14.542840 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:14.543313 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:32:14.543817 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:32:14.544659 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:14.546849 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:32:14.547298 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:32:14.547776 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:32:14.549625 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:32:14.550022 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:32:14.550505 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:14.550924 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:32:14.552891 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:32:14.554666 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:32:14.555116 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:32:14.555380 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:32:14.555681 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:32:14.556803 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:32:14.557509 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860f80b7650>]}
[0m14:32:14.557975 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m14:32:14.558397 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:32:14.560784 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:32:14.562145 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:32:14.562749 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c117bc9-80dd-4dd1-9efd-2121977380b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860f89acce0>]}
[0m14:32:14.563291 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m14:32:14.563812 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:32:14.565778 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:14.566153 [debug] [MainThread]: On master: BEGIN
[0m14:32:14.566430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:14.572638 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:32:14.573069 [debug] [MainThread]: On master: COMMIT
[0m14:32:14.573301 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:14.573510 [debug] [MainThread]: On master: COMMIT
[0m14:32:14.573892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:32:14.574170 [debug] [MainThread]: On master: Close
[0m14:32:14.574568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:14.574780 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:32:14.574970 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:32:14.575147 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:32:14.575431 [info ] [MainThread]: 
[0m14:32:14.575734 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m14:32:14.576559 [debug] [MainThread]: Command end result
[0m14:32:14.593779 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:32:14.595480 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:32:14.600610 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:32:14.600972 [info ] [MainThread]: 
[0m14:32:14.601335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:14.601617 [info ] [MainThread]: 
[0m14:32:14.602177 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:32:14.603169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.97465575, "process_in_blocks": "0", "process_kernel_time": 0.367754, "process_mem_max_rss": "107928", "process_out_blocks": "3392", "process_user_time": 1.671611}
[0m14:32:14.603603 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:14.603512 after 0.98 seconds
[0m14:32:14.603935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860fb547830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860feaf28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7860feaf2870>]}
[0m14:32:14.604262 [debug] [MainThread]: Flushing usage events
[0m14:32:15.483579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:13.475125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3370db770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a337d24170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a337db9b50>]}


============================== 14:38:13.481685 | dcbe02d0-8838-4eb4-af30-aad277cae674 ==============================
[0m14:38:13.481685 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:38:13.482110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:13.660451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a336871d30>]}
[0m14:38:13.717621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a336a13e00>]}
[0m14:38:13.718495 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:38:13.797686 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:38:13.909157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:13.909943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:13.947099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a33451fef0>]}
[0m14:38:14.029591 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:38:14.031952 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:38:14.070931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a334296090>]}
[0m14:38:14.071851 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:38:14.072558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a33445eba0>]}
[0m14:38:14.077093 [info ] [MainThread]: 
[0m14:38:14.078228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:38:14.079026 [info ] [MainThread]: 
[0m14:38:14.080268 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:38:14.088157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:38:14.160508 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:38:14.161057 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:38:14.161352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:14.173440 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m14:38:14.175892 [debug] [ThreadPool]: On list_db: Close
[0m14:38:14.178754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:38:14.186481 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:38:14.187078 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:38:14.187542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:14.194733 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:38:14.195567 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:38:14.196172 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:38:14.201101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m14:38:14.202421 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:38:14.203211 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:38:14.208642 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:14.209333 [debug] [MainThread]: On master: BEGIN
[0m14:38:14.210027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:14.218121 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:38:14.218633 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:14.219012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:38:14.223299 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:38:14.225153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a335cd0560>]}
[0m14:38:14.225816 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:14.226516 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:14.226849 [debug] [MainThread]: On master: BEGIN
[0m14:38:14.227691 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:38:14.228213 [debug] [MainThread]: On master: COMMIT
[0m14:38:14.228714 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:14.229174 [debug] [MainThread]: On master: COMMIT
[0m14:38:14.230063 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:38:14.230536 [debug] [MainThread]: On master: Close
[0m14:38:14.235078 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:38:14.236522 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m14:38:14.237625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:38:14.238337 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:38:14.251855 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:38:14.252787 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:38:14.293516 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:38:14.294967 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:38:14.295611 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:38:14.296086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:14.302597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:38:14.303037 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:38:14.303321 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m14:38:14.313884 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:38:14.319300 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:38:14.319933 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m14:38:14.321000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:38:14.326137 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:38:14.327029 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:38:14.328548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:38:14.344980 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:38:14.345423 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:38:14.345693 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:38:14.350016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:38:14.355791 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:38:14.361041 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:38:14.361671 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:38:14.365945 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:38:14.369828 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:38:14.372499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a337ca23f0>]}
[0m14:38:14.373106 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m14:38:14.373675 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:38:14.374928 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m14:38:14.375827 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:38:14.376490 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m14:38:14.377366 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:38:14.378177 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m14:38:14.378628 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:38:14.378984 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m14:38:14.379433 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:38:14.381942 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m14:38:14.384608 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:38:14.385436 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m14:38:14.387576 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m14:38:14.387903 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:38:14.390086 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:38:14.391052 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:38:14.391621 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m14:38:14.392280 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:38:14.392830 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:38:14.393581 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:38:14.394170 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:38:14.402386 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m14:38:14.403224 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m14:38:14.403964 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:38:14.404578 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:38:14.405088 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m14:38:14.405638 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m14:38:14.412785 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:38:14.416097 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:38:14.416551 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:38:14.417076 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:38:14.417459 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:38:14.420030 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:38:14.424003 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:38:14.424583 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m14:38:14.425016 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:38:14.425897 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:38:14.426237 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:38:14.430395 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:38:14.431966 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:38:14.432344 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m14:38:14.432679 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:38:14.433101 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:38:14.433362 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:38:14.434556 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:38:14.434832 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:38:14.435073 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m14:38:14.435703 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:38:14.438840 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:38:14.439338 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:38:14.439835 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:38:14.441545 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m14:38:14.441887 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:38:14.442339 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m14:38:14.442910 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m14:38:14.445461 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:38:14.446698 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:38:14.447163 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:38:14.448805 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m14:38:14.449730 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a33343c950>]}
[0m14:38:14.450269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcbe02d0-8838-4eb4-af30-aad277cae674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3302b3fe0>]}
[0m14:38:14.450842 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m14:38:14.451799 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.07s]
[0m14:38:14.452452 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:38:14.452912 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m14:38:14.455117 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:14.455441 [debug] [MainThread]: On master: BEGIN
[0m14:38:14.455691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:14.462852 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:38:14.463596 [debug] [MainThread]: On master: COMMIT
[0m14:38:14.464103 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:14.464597 [debug] [MainThread]: On master: COMMIT
[0m14:38:14.465205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:38:14.465548 [debug] [MainThread]: On master: Close
[0m14:38:14.465987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:14.466232 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:38:14.466441 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m14:38:14.466647 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:38:14.467053 [info ] [MainThread]: 
[0m14:38:14.467747 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m14:38:14.469338 [debug] [MainThread]: Command end result
[0m14:38:14.498423 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:38:14.500991 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:38:14.509762 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:38:14.510526 [info ] [MainThread]: 
[0m14:38:14.511212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:14.511793 [info ] [MainThread]: 
[0m14:38:14.512397 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:38:14.514026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0816436, "process_in_blocks": "0", "process_kernel_time": 0.411864, "process_mem_max_rss": "107648", "process_out_blocks": "3392", "process_user_time": 1.991346}
[0m14:38:14.514795 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:14.514646 after 1.08 seconds
[0m14:38:14.515327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a3360d5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a336339c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a335fa5280>]}
[0m14:38:14.515876 [debug] [MainThread]: Flushing usage events
[0m14:38:15.396150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:30.693001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62d5b33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62ee0c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62d4216a0>]}


============================== 15:03:30.720206 | 461cbbfa-ab75-4ed2-87c0-ea2fa570ff91 ==============================
[0m15:03:30.720206 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:03:30.722222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:03:31.120394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62d9a8350>]}
[0m15:03:31.234616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62cddbfb0>]}
[0m15:03:31.239329 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:03:31.356567 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:03:31.576861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:31.577756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:31.638543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62cf0eb10>]}
[0m15:03:31.769233 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:03:31.774176 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:03:31.823020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62b37f2f0>]}
[0m15:03:31.824009 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:03:31.824723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62b44c3b0>]}
[0m15:03:31.828199 [info ] [MainThread]: 
[0m15:03:31.828939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:03:31.829481 [info ] [MainThread]: 
[0m15:03:31.830320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:03:31.837270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:03:31.960460 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:03:31.961278 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:03:31.961761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:31.987859 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m15:03:31.990899 [debug] [ThreadPool]: On list_db: Close
[0m15:03:31.995062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:03:32.004928 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:03:32.005831 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:03:32.006563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:32.019702 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m15:03:32.020673 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:03:32.021275 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:03:32.030829 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m15:03:32.033620 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:03:32.034788 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:03:32.044021 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:32.044695 [debug] [MainThread]: On master: BEGIN
[0m15:03:32.045154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:32.054777 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:03:32.055563 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:32.056247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:03:32.064485 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:03:32.067140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62b5d3ef0>]}
[0m15:03:32.068145 [debug] [MainThread]: On master: ROLLBACK
[0m15:03:32.069041 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:32.069633 [debug] [MainThread]: On master: BEGIN
[0m15:03:32.070707 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:03:32.071255 [debug] [MainThread]: On master: COMMIT
[0m15:03:32.072045 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:32.072584 [debug] [MainThread]: On master: COMMIT
[0m15:03:32.073484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:03:32.074255 [debug] [MainThread]: On master: Close
[0m15:03:32.080196 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m15:03:32.081240 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m15:03:32.082163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m15:03:32.082772 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m15:03:32.093549 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m15:03:32.095269 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m15:03:32.150736 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m15:03:32.152354 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:03:32.153030 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m15:03:32.153588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:32.164538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:03:32.165328 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:03:32.166079 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m15:03:32.189810 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m15:03:32.200261 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:03:32.200846 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m15:03:32.202157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:32.208045 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:03:32.208866 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m15:03:32.210321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:32.247366 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:03:32.248156 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:03:32.248689 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:03:32.252707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:03:32.265077 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m15:03:32.273939 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:03:32.274549 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m15:03:32.280762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:03:32.284718 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m15:03:32.287517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62ed7e150>]}
[0m15:03:32.288576 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m15:03:32.289544 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m15:03:32.292036 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m15:03:32.292738 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:03:32.293645 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m15:03:32.294696 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:03:32.295740 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m15:03:32.296646 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:03:32.297306 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m15:03:32.297980 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:03:32.302442 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m15:03:32.306333 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:03:32.308012 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:03:32.312232 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:03:32.312787 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m15:03:32.317036 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m15:03:32.318398 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:03:32.318974 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:03:32.319567 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m15:03:32.320237 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:03:32.320813 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:03:32.321380 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:03:32.331503 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m15:03:32.332314 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:03:32.332916 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m15:03:32.334454 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m15:03:32.335049 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:03:32.335581 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m15:03:32.343979 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m15:03:32.349036 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:03:32.349915 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m15:03:32.350557 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:03:32.354439 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:03:32.355356 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m15:03:32.355985 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:32.360277 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:03:32.360957 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:03:32.361556 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:03:32.365227 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:03:32.366036 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m15:03:32.366621 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:32.369155 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:03:32.369704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:03:32.370322 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:03:32.372592 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:03:32.373306 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:03:32.374147 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:03:32.375078 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:03:32.379323 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m15:03:32.382564 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:03:32.383274 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:03:32.384380 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:03:32.387488 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m15:03:32.388245 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:03:32.389149 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:03:32.390029 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m15:03:32.393399 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:03:32.395607 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:03:32.396207 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:03:32.398290 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m15:03:32.399132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62cdbaa50>]}
[0m15:03:32.400201 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461cbbfa-ab75-4ed2-87c0-ea2fa570ff91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62a4a4140>]}
[0m15:03:32.401244 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m15:03:32.402358 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.10s]
[0m15:03:32.403536 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:03:32.404499 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m15:03:32.408443 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:32.408974 [debug] [MainThread]: On master: BEGIN
[0m15:03:32.409424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:32.420093 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:03:32.420824 [debug] [MainThread]: On master: COMMIT
[0m15:03:32.421545 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:32.422142 [debug] [MainThread]: On master: COMMIT
[0m15:03:32.423500 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:03:32.424241 [debug] [MainThread]: On master: Close
[0m15:03:32.425156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:32.425726 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m15:03:32.426206 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m15:03:32.427358 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:03:32.428635 [info ] [MainThread]: 
[0m15:03:32.429468 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:03:32.432254 [debug] [MainThread]: Command end result
[0m15:03:32.464449 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:03:32.466778 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:03:32.477230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:03:32.477768 [info ] [MainThread]: 
[0m15:03:32.478365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:32.478912 [info ] [MainThread]: 
[0m15:03:32.479477 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:03:32.481694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9502152, "process_in_blocks": "0", "process_kernel_time": 1.190448, "process_mem_max_rss": "107680", "process_out_blocks": "3392", "process_user_time": 3.921478}
[0m15:03:32.482568 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:32.482385 after 1.95 seconds
[0m15:03:32.483149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62ce53a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62d192d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba6283d8290>]}
[0m15:03:32.483867 [debug] [MainThread]: Flushing usage events
[0m15:03:33.329851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:23.708229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91023b8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102926a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102bf4ef0>]}


============================== 15:04:23.715648 | 160e13e3-52e3-4ed1-a978-25944c4c09d9 ==============================
[0m15:04:23.715648 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:04:23.716091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:04:23.930341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102577830>]}
[0m15:04:24.005991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102fb7500>]}
[0m15:04:24.007010 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:04:24.081933 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:04:24.195340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:24.195773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:24.230106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9100af7bc0>]}
[0m15:04:24.297879 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:04:24.302821 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:04:24.343424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9100a5e1e0>]}
[0m15:04:24.343887 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:04:24.344185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102e71bb0>]}
[0m15:04:24.345652 [info ] [MainThread]: 
[0m15:04:24.346012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:24.346312 [info ] [MainThread]: 
[0m15:04:24.346804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:04:24.353978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:04:24.417490 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:04:24.417924 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:04:24.418213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:24.427293 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m15:04:24.428304 [debug] [ThreadPool]: On list_db: Close
[0m15:04:24.430160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:04:24.437414 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:04:24.438022 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:04:24.438366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:24.458557 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:04:24.459080 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:04:24.459976 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:04:24.463350 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m15:04:24.464667 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:04:24.465213 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:04:24.469664 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:24.470019 [debug] [MainThread]: On master: BEGIN
[0m15:04:24.470244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:24.476698 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:04:24.480779 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:24.485587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:04:24.496679 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:04:24.498596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91022fb590>]}
[0m15:04:24.499151 [debug] [MainThread]: On master: ROLLBACK
[0m15:04:24.499752 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:24.500083 [debug] [MainThread]: On master: BEGIN
[0m15:04:24.500923 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:04:24.501307 [debug] [MainThread]: On master: COMMIT
[0m15:04:24.501631 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:24.501922 [debug] [MainThread]: On master: COMMIT
[0m15:04:24.502461 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:24.502773 [debug] [MainThread]: On master: Close
[0m15:04:24.505368 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m15:04:24.505890 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m15:04:24.506347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m15:04:24.506638 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m15:04:24.523684 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m15:04:24.525020 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m15:04:24.560623 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m15:04:24.561544 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:04:24.561884 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m15:04:24.562148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:24.575919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:04:24.577069 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:04:24.578019 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m15:04:24.596226 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m15:04:24.601049 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:04:24.601425 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m15:04:24.602218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:24.604126 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:04:24.604391 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m15:04:24.605141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:04:24.635008 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:04:24.635845 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:04:24.636341 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:04:24.639609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:04:24.649330 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m15:04:24.657247 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:04:24.657902 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m15:04:24.668730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:04:24.673130 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m15:04:24.676136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102eaa6f0>]}
[0m15:04:24.677191 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.17s]
[0m15:04:24.678299 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m15:04:24.683252 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m15:04:24.685911 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:04:24.690155 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m15:04:24.693327 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:04:24.695020 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m15:04:24.696016 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:04:24.696760 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m15:04:24.697688 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:04:24.701253 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m15:04:24.703864 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:04:24.704771 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:04:24.705138 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m15:04:24.708500 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:04:24.711250 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m15:04:24.712205 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:04:24.712647 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:04:24.713379 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:04:24.713703 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m15:04:24.713999 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:04:24.714291 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:04:24.721351 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m15:04:24.722106 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:04:24.722762 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m15:04:24.729997 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m15:04:24.730992 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:04:24.731833 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m15:04:24.740000 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m15:04:24.750727 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:04:24.751408 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:04:24.752035 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:04:24.755213 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:04:24.756065 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m15:04:24.756521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:24.760327 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:04:24.761025 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:04:24.761581 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:04:24.764119 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:04:24.764917 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m15:04:24.765460 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:24.766921 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:04:24.767253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:24.767536 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:04:24.768628 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:04:24.770555 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:04:24.773005 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:04:24.774097 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:04:24.778023 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m15:04:24.783418 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:04:24.784224 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m15:04:24.787896 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:04:24.797048 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m15:04:24.798479 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:04:24.799901 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:04:24.800961 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m15:04:24.808403 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:04:24.810017 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:04:24.810413 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:04:24.811623 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m15:04:24.812158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90fc8e3d40>]}
[0m15:04:24.813420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160e13e3-52e3-4ed1-a978-25944c4c09d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90ff9bce30>]}
[0m15:04:24.812892 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m15:04:24.814235 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.12s]
[0m15:04:24.815194 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:04:24.815872 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m15:04:24.818233 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:24.818548 [debug] [MainThread]: On master: BEGIN
[0m15:04:24.818775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:24.825704 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:04:24.826728 [debug] [MainThread]: On master: COMMIT
[0m15:04:24.827670 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:24.828423 [debug] [MainThread]: On master: COMMIT
[0m15:04:24.829810 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:24.830833 [debug] [MainThread]: On master: Close
[0m15:04:24.832409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:24.832750 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m15:04:24.833157 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m15:04:24.833400 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:04:24.833764 [info ] [MainThread]: 
[0m15:04:24.834084 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:04:24.834948 [debug] [MainThread]: Command end result
[0m15:04:24.853042 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:04:24.854862 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:04:24.863481 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:04:24.864229 [info ] [MainThread]: 
[0m15:04:24.865004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:24.865524 [info ] [MainThread]: 
[0m15:04:24.866094 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:04:24.867807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2341825, "process_in_blocks": "0", "process_kernel_time": 0.425119, "process_mem_max_rss": "107876", "process_out_blocks": "3392", "process_user_time": 2.370242}
[0m15:04:24.868622 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:24.868461 after 1.24 seconds
[0m15:04:24.869236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102ec8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9102ec9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e910257a120>]}
[0m15:04:24.869773 [debug] [MainThread]: Flushing usage events
[0m15:04:25.752482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:23.485729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec7922a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec793230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec6c6e10>]}


============================== 15:05:23.492767 | 3fcf1345-a796-4f52-8f90-14e69ea8553d ==============================
[0m15:05:23.492767 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:05:23.493468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:23.714531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec33a510>]}
[0m15:05:23.772453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec153f20>]}
[0m15:05:23.773657 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:05:23.833475 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:05:23.947471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:23.947995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:23.995352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ea9149e0>]}
[0m15:05:24.072444 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:05:24.076464 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:05:24.104405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ea62b0b0>]}
[0m15:05:24.104802 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:05:24.105054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec153a70>]}
[0m15:05:24.106378 [info ] [MainThread]: 
[0m15:05:24.106695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:24.106926 [info ] [MainThread]: 
[0m15:05:24.107337 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:24.111141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:05:24.181940 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:05:24.182489 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:05:24.182845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:24.194751 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m15:05:24.195878 [debug] [ThreadPool]: On list_db: Close
[0m15:05:24.197854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:05:24.204872 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:05:24.206409 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:05:24.208900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:24.223836 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m15:05:24.224286 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:05:24.224575 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:05:24.227464 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m15:05:24.232610 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:05:24.235570 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:05:24.244459 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.245126 [debug] [MainThread]: On master: BEGIN
[0m15:05:24.246005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:24.259454 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:05:24.259993 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.260405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:24.266053 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:05:24.267263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ea8bbdd0>]}
[0m15:05:24.267691 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:24.268155 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.268391 [debug] [MainThread]: On master: BEGIN
[0m15:05:24.268978 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:05:24.269689 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.270095 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.270400 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.270848 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:24.271165 [debug] [MainThread]: On master: Close
[0m15:05:24.277862 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m15:05:24.281740 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m15:05:24.283146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m15:05:24.283858 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m15:05:24.300192 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m15:05:24.301065 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m15:05:24.360693 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m15:05:24.362039 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:05:24.362649 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m15:05:24.363105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:24.388496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m15:05:24.389768 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:05:24.390339 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m15:05:24.400214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m15:05:24.407813 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:05:24.408332 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m15:05:24.409189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:24.411379 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:05:24.411689 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m15:05:24.412296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:24.440924 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:05:24.441383 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:05:24.441639 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:05:24.444127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:05:24.462794 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m15:05:24.473053 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:05:24.473822 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m15:05:24.479476 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:05:24.481962 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m15:05:24.483469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ecc5a840>]}
[0m15:05:24.484057 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m15:05:24.484612 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m15:05:24.485993 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m15:05:24.487201 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:05:24.486833 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m15:05:24.487757 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:05:24.488462 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m15:05:24.488920 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:05:24.489332 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m15:05:24.489692 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:05:24.493824 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m15:05:24.496418 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:05:24.497288 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:05:24.497649 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m15:05:24.501192 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:05:24.504040 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m15:05:24.505132 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:05:24.505779 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:05:24.506281 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m15:05:24.506893 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:05:24.507528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:24.508179 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:24.525167 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m15:05:24.526072 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:05:24.526680 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m15:05:24.527198 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m15:05:24.527737 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:05:24.528371 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m15:05:24.534486 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:05:24.534916 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:05:24.542557 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:05:24.543527 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:05:24.543805 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:05:24.545367 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m15:05:24.547236 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:24.547690 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:24.550324 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:05:24.553660 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:05:24.555514 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m15:05:24.557885 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:05:24.561074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:24.562783 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:05:24.566440 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:05:24.568584 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:05:24.569149 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:05:24.569659 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:05:24.570098 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:05:24.570512 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:05:24.574380 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:05:24.576623 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:05:24.577313 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:05:24.577660 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:05:24.579578 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m15:05:24.581933 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m15:05:24.582270 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:05:24.583287 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:05:24.584725 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:05:24.585642 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m15:05:24.586778 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9e8693500>]}
[0m15:05:24.587536 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m15:05:24.587930 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:05:24.590373 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:05:24.591314 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m15:05:24.591754 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcf1345-a796-4f52-8f90-14e69ea8553d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9e865d160>]}
[0m15:05:24.592210 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.10s]
[0m15:05:24.592877 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m15:05:24.597199 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.597762 [debug] [MainThread]: On master: BEGIN
[0m15:05:24.598139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:24.614670 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:05:24.615284 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.615905 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:24.616377 [debug] [MainThread]: On master: COMMIT
[0m15:05:24.616974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:24.617374 [debug] [MainThread]: On master: Close
[0m15:05:24.617917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:24.618231 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m15:05:24.618488 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m15:05:24.618758 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:05:24.619136 [info ] [MainThread]: 
[0m15:05:24.619478 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m15:05:24.620670 [debug] [MainThread]: Command end result
[0m15:05:24.641558 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:05:24.643449 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:05:24.662476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:05:24.662964 [info ] [MainThread]: 
[0m15:05:24.663437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:24.663811 [info ] [MainThread]: 
[0m15:05:24.664543 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:05:24.665914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2538763, "process_in_blocks": "0", "process_kernel_time": 0.390554, "process_mem_max_rss": "107740", "process_out_blocks": "3392", "process_user_time": 2.250719}
[0m15:05:24.666474 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:24.666353 after 1.25 seconds
[0m15:05:24.666887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec3580e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ed4b3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f9ec38d280>]}
[0m15:05:24.667291 [debug] [MainThread]: Flushing usage events
[0m15:05:25.534783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:23.828159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe26c64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe39b4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe39b6c30>]}


============================== 15:06:23.836264 | e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c ==============================
[0m15:06:23.836264 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:06:23.836735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:24.016103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe1ab2600>]}
[0m15:06:24.071569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe1ab0470>]}
[0m15:06:24.072470 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:06:24.173574 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:06:24.283351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:24.283790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:24.321671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe33376b0>]}
[0m15:06:24.392191 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:06:24.395857 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:06:24.430868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe1962f00>]}
[0m15:06:24.431519 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:06:24.432015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfdfe902f0>]}
[0m15:06:24.434265 [info ] [MainThread]: 
[0m15:06:24.434766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:24.435181 [info ] [MainThread]: 
[0m15:06:24.435899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:24.441058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:06:24.483060 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:06:24.483846 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:06:24.484454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:24.499035 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m15:06:24.500713 [debug] [ThreadPool]: On list_db: Close
[0m15:06:24.502215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:06:24.506050 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:06:24.506311 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:06:24.506503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:24.513946 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:06:24.514280 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:06:24.514513 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:06:24.516583 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m15:06:24.517704 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:06:24.518106 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:06:24.522691 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:24.523040 [debug] [MainThread]: On master: BEGIN
[0m15:06:24.523324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:24.529055 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:06:24.530333 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:24.531254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:24.535942 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m15:06:24.537119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe1962900>]}
[0m15:06:24.537533 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:24.538086 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:24.538438 [debug] [MainThread]: On master: BEGIN
[0m15:06:24.539160 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:06:24.539532 [debug] [MainThread]: On master: COMMIT
[0m15:06:24.539859 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:24.540183 [debug] [MainThread]: On master: COMMIT
[0m15:06:24.540986 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:06:24.541645 [debug] [MainThread]: On master: Close
[0m15:06:24.546159 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m15:06:24.546799 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m15:06:24.547266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m15:06:24.547550 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m15:06:24.554553 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m15:06:24.555889 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m15:06:24.600344 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m15:06:24.601742 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:06:24.602320 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m15:06:24.602822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:24.609560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:06:24.610137 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:06:24.610449 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m15:06:24.619088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m15:06:24.626035 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:06:24.626494 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m15:06:24.627337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:24.630320 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:06:24.630958 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m15:06:24.631783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:24.665094 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:06:24.665701 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:06:24.666144 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:06:24.670120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:06:24.675873 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m15:06:24.680943 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:06:24.681424 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m15:06:24.737139 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.055 seconds
[0m15:06:24.741221 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m15:06:24.743181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe2502840>]}
[0m15:06:24.744463 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.19s]
[0m15:06:24.745593 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m15:06:24.747306 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m15:06:24.748017 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:06:24.748471 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m15:06:24.748932 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:06:24.749426 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m15:06:24.749813 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:06:24.750103 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m15:06:24.750627 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:06:24.753214 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m15:06:24.757669 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:06:24.758625 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m15:06:24.763416 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m15:06:24.764023 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:06:24.766277 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:06:24.766711 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:06:24.767068 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m15:06:24.767349 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:06:24.767639 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:06:24.768111 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:06:24.768316 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:06:24.773834 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m15:06:24.775020 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:06:24.776384 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m15:06:24.777005 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m15:06:24.777769 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:06:24.778366 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m15:06:24.849201 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.072 seconds
[0m15:06:24.852805 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:06:24.853292 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.074 seconds
[0m15:06:24.853921 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:06:24.856538 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:06:24.857011 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m15:06:24.857548 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:24.857896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:24.859739 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:06:24.862741 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:06:24.863166 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m15:06:24.863819 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:06:24.864691 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:24.864959 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:24.866165 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:06:24.867227 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:06:24.867535 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:06:24.867807 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:06:24.868071 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:06:24.868330 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:06:24.870595 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:06:24.870974 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:06:24.872375 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:06:24.873826 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m15:06:24.874301 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:06:24.874761 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:06:24.875077 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:06:24.875361 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m15:06:24.878401 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:06:24.879466 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m15:06:24.880015 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfbff3ffe0>]}
[0m15:06:24.880827 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:06:24.880535 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.13s]
[0m15:06:24.882098 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:06:24.882553 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m15:06:24.883101 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5876ba6-9d35-4a0e-9aa1-d8a32a0c7d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfdf0458e0>]}
[0m15:06:24.884003 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m15:06:24.884668 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:06:24.886789 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:24.887201 [debug] [MainThread]: On master: BEGIN
[0m15:06:24.887532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:24.894014 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:06:24.894471 [debug] [MainThread]: On master: COMMIT
[0m15:06:24.894800 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:24.895096 [debug] [MainThread]: On master: COMMIT
[0m15:06:24.895612 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:06:24.896011 [debug] [MainThread]: On master: Close
[0m15:06:24.896590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:24.896911 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m15:06:24.897211 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m15:06:24.897478 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:06:24.897915 [info ] [MainThread]: 
[0m15:06:24.898315 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m15:06:24.899466 [debug] [MainThread]: Command end result
[0m15:06:24.916923 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:06:24.919009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:06:24.923863 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:06:24.924152 [info ] [MainThread]: 
[0m15:06:24.924482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:24.924824 [info ] [MainThread]: 
[0m15:06:24.925163 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:06:24.926197 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1400648, "process_in_blocks": "0", "process_kernel_time": 0.468634, "process_mem_max_rss": "107572", "process_out_blocks": "3392", "process_user_time": 2.148254}
[0m15:06:24.926624 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:24.926535 after 1.14 seconds
[0m15:06:24.926917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe21ed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe1f6b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe2d5bb90>]}
[0m15:06:24.927210 [debug] [MainThread]: Flushing usage events
[0m15:06:25.788083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:46.405556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c277fd82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c277722030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c277e89520>]}


============================== 15:13:46.416146 | fe7800b1-e5ab-459f-95d9-7abb5d835655 ==============================
[0m15:13:46.416146 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:13:46.416653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:46.625905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c2791fef60>]}
[0m15:13:46.701820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c2772774d0>]}
[0m15:13:46.702732 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:13:46.764755 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:13:46.869918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:46.870507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:46.908508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c278e48380>]}
[0m15:13:46.999501 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:13:47.004295 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:13:47.037903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c275818a70>]}
[0m15:13:47.038475 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:13:47.038816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c275853020>]}
[0m15:13:47.040418 [info ] [MainThread]: 
[0m15:13:47.040832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:13:47.042613 [info ] [MainThread]: 
[0m15:13:47.043631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:13:47.051806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:13:47.087733 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:13:47.088353 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:13:47.088752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:47.105601 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m15:13:47.106836 [debug] [ThreadPool]: On list_db: Close
[0m15:13:47.109622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:13:47.114105 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:13:47.114459 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:13:47.114657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:47.126611 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:13:47.127277 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:13:47.127796 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:13:47.133460 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m15:13:47.135050 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:13:47.135526 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:13:47.139683 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:47.139952 [debug] [MainThread]: On master: BEGIN
[0m15:13:47.140176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:47.148100 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:13:47.148548 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:47.149215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:13:47.156927 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:13:47.158260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c275a25040>]}
[0m15:13:47.158723 [debug] [MainThread]: On master: ROLLBACK
[0m15:13:47.159350 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:47.159616 [debug] [MainThread]: On master: BEGIN
[0m15:13:47.160482 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:13:47.160732 [debug] [MainThread]: On master: COMMIT
[0m15:13:47.160929 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:47.161129 [debug] [MainThread]: On master: COMMIT
[0m15:13:47.161437 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:13:47.161668 [debug] [MainThread]: On master: Close
[0m15:13:47.166855 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m15:13:47.167919 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m15:13:47.168749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m15:13:47.169339 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m15:13:47.179005 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m15:13:47.181726 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m15:13:47.230448 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m15:13:47.233467 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:13:47.235512 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m15:13:47.236998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:47.255728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:13:47.257877 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:13:47.260677 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m15:13:47.280586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m15:13:47.289373 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:13:47.290093 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m15:13:47.291752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:47.295580 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:13:47.296143 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m15:13:47.297005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:47.316762 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:13:47.317500 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:13:47.318027 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:13:47.322693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:13:47.328163 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m15:13:47.331887 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:13:47.332176 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m15:13:47.335366 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:13:47.338319 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m15:13:47.339726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c277dddd60>]}
[0m15:13:47.340251 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.17s]
[0m15:13:47.340696 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m15:13:47.341815 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m15:13:47.342161 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:13:47.342614 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m15:13:47.343220 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:13:47.344036 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m15:13:47.344537 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:13:47.344838 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m15:13:47.345640 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:13:47.348412 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m15:13:47.351686 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:13:47.352834 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m15:13:47.355741 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m15:13:47.356639 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:13:47.356954 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:13:47.357210 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m15:13:47.365495 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:13:47.366193 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:13:47.367189 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:13:47.367440 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:13:47.367652 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:13:47.374904 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m15:13:47.375527 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:13:47.376093 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m15:13:47.376986 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m15:13:47.377254 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:13:47.377790 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m15:13:47.384603 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m15:13:47.388997 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:13:47.389593 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:13:47.391184 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:47.397713 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:13:47.398895 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:13:47.400976 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:13:47.401381 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:13:47.401982 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m15:13:47.402839 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:47.403289 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:47.405156 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:13:47.407475 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:13:47.408419 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:13:47.409377 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m15:13:47.409864 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:13:47.410876 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:47.412698 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:13:47.413115 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:13:47.413405 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:13:47.414291 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:13:47.415898 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:13:47.416796 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:13:47.417014 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:13:47.418701 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:13:47.421848 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m15:13:47.422766 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:13:47.423914 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:13:47.428344 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:13:47.429215 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m15:13:47.430558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c274912330>]}
[0m15:13:47.431565 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m15:13:47.432619 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:13:47.433063 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:13:47.434453 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m15:13:47.434950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe7800b1-e5ab-459f-95d9-7abb5d835655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c26d727f20>]}
[0m15:13:47.435396 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m15:13:47.436165 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m15:13:47.438279 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:47.438543 [debug] [MainThread]: On master: BEGIN
[0m15:13:47.438721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:47.448603 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:13:47.448999 [debug] [MainThread]: On master: COMMIT
[0m15:13:47.449240 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:47.449473 [debug] [MainThread]: On master: COMMIT
[0m15:13:47.450572 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:13:47.451261 [debug] [MainThread]: On master: Close
[0m15:13:47.452578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:47.452830 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m15:13:47.453039 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m15:13:47.453323 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:13:47.453634 [info ] [MainThread]: 
[0m15:13:47.453930 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:13:47.455239 [debug] [MainThread]: Command end result
[0m15:13:47.502289 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:13:47.505046 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:13:47.514551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:13:47.514968 [info ] [MainThread]: 
[0m15:13:47.515682 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:47.516595 [info ] [MainThread]: 
[0m15:13:47.517237 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:13:47.518947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1686444, "process_in_blocks": "16552", "process_kernel_time": 0.403962, "process_mem_max_rss": "107588", "process_out_blocks": "3392", "process_user_time": 2.352486}
[0m15:13:47.519436 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:47.519325 after 1.17 seconds
[0m15:13:47.519766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c277a23200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c277b08530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c2776b4a40>]}
[0m15:13:47.520086 [debug] [MainThread]: Flushing usage events
[0m15:13:48.404376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:35.259491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb673a85a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6754442f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb673a92810>]}


============================== 15:14:35.266035 | a7649100-8321-4094-92e5-f04c5dd911e4 ==============================
[0m15:14:35.266035 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:14:35.266489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:14:35.479401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb67377a9c0>]}
[0m15:14:35.554472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb673572ed0>]}
[0m15:14:35.555408 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:14:35.628547 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:14:35.723725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:35.724086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:35.753610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb671c1fd10>]}
[0m15:14:35.815200 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:14:35.818597 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:14:35.837770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6719d3e60>]}
[0m15:14:35.838213 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:14:35.838653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb671a409e0>]}
[0m15:14:35.839990 [info ] [MainThread]: 
[0m15:14:35.840305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:35.841653 [info ] [MainThread]: 
[0m15:14:35.842991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:35.849315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:14:35.907356 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:14:35.907815 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:14:35.908105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:35.920287 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m15:14:35.922043 [debug] [ThreadPool]: On list_db: Close
[0m15:14:35.924388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:14:35.932749 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:14:35.933892 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:14:35.934785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:35.944278 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:14:35.944689 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:14:35.944933 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:14:35.949870 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m15:14:35.952727 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:14:35.954300 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:14:35.963621 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:35.966338 [debug] [MainThread]: On master: BEGIN
[0m15:14:35.967842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:35.978270 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:14:35.980362 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:35.981306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:35.987558 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:14:35.990343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb671a78200>]}
[0m15:14:35.991382 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:35.992457 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:35.993116 [debug] [MainThread]: On master: BEGIN
[0m15:14:35.994214 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:14:35.994774 [debug] [MainThread]: On master: COMMIT
[0m15:14:35.995215 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:35.995618 [debug] [MainThread]: On master: COMMIT
[0m15:14:35.996428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:14:35.996856 [debug] [MainThread]: On master: Close
[0m15:14:36.001653 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m15:14:36.002569 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m15:14:36.003226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m15:14:36.003756 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m15:14:36.016164 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m15:14:36.017714 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m15:14:36.071088 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m15:14:36.072203 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:14:36.072716 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m15:14:36.073122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:36.081887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:14:36.082785 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:14:36.083597 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m15:14:36.093035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m15:14:36.097790 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:14:36.098140 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m15:14:36.098813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:36.101207 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:14:36.101505 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m15:14:36.102841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:36.135079 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:14:36.135627 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:14:36.135990 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:14:36.140052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:14:36.145498 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m15:14:36.149780 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:14:36.150351 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m15:14:36.154847 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:14:36.156740 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m15:14:36.158025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6701d4da0>]}
[0m15:14:36.158583 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.15s]
[0m15:14:36.159025 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m15:14:36.160655 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m15:14:36.161709 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:14:36.163010 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m15:14:36.164831 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:14:36.165802 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m15:14:36.166959 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:14:36.167848 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m15:14:36.168701 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:14:36.171946 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m15:14:36.178175 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:14:36.179080 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m15:14:36.181172 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m15:14:36.181535 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:14:36.182267 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:14:36.185064 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:14:36.185501 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m15:14:36.185935 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:14:36.186438 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:36.186797 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:14:36.187100 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:14:36.193785 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m15:14:36.194349 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:14:36.195073 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m15:14:36.196122 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m15:14:36.196781 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:36.197372 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m15:14:36.206629 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m15:14:36.208934 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:14:36.209217 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m15:14:36.209926 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m15:14:36.210200 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:36.212164 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:36.218034 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:14:36.219102 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:14:36.219730 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m15:14:36.220804 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:36.221328 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:36.223385 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:14:36.228383 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:36.228901 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:14:36.229410 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:14:36.229997 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:14:36.230895 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:36.232025 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:14:36.232293 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:36.232548 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:14:36.241373 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m15:14:36.244380 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m15:14:36.245052 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:14:36.245398 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m15:14:36.245710 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m15:14:36.248431 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:14:36.249147 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:36.249487 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:14:36.249815 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:14:36.250890 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m15:14:36.251664 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb670b815b0>]}
[0m15:14:36.252114 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m15:14:36.252519 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m15:14:36.254194 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:14:36.255546 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:14:36.256201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7649100-8321-4094-92e5-f04c5dd911e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6701c8830>]}
[0m15:14:36.256783 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m15:14:36.257358 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:14:36.259941 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:36.260738 [debug] [MainThread]: On master: BEGIN
[0m15:14:36.261469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:36.270132 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:14:36.271271 [debug] [MainThread]: On master: COMMIT
[0m15:14:36.271673 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:36.271924 [debug] [MainThread]: On master: COMMIT
[0m15:14:36.272515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:14:36.273293 [debug] [MainThread]: On master: Close
[0m15:14:36.274456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:36.275165 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m15:14:36.275872 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m15:14:36.276628 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:14:36.277664 [info ] [MainThread]: 
[0m15:14:36.279230 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:14:36.282185 [debug] [MainThread]: Command end result
[0m15:14:36.298245 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:14:36.299998 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:14:36.306056 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:14:36.307265 [info ] [MainThread]: 
[0m15:14:36.308022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:36.308582 [info ] [MainThread]: 
[0m15:14:36.309199 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:14:36.310717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0959028, "process_in_blocks": "0", "process_kernel_time": 0.296885, "process_mem_max_rss": "108048", "process_out_blocks": "3392", "process_user_time": 2.118317}
[0m15:14:36.311327 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:36.311187 after 1.10 seconds
[0m15:14:36.311800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb673a85a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6756b4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6718b8d40>]}
[0m15:14:36.312204 [debug] [MainThread]: Flushing usage events
[0m15:14:37.170401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:35.255944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fb152db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fb3f85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fae9db80>]}


============================== 15:15:35.262895 | e09aebd4-b529-4d06-ae2f-e19e6fdcae0a ==============================
[0m15:15:35.262895 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:15:35.263478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:15:35.457464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fac26a80>]}
[0m15:15:35.509059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fadc3f50>]}
[0m15:15:35.509943 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:15:35.563729 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:15:35.653947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:35.654419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:35.687137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514f92de450>]}
[0m15:15:35.764673 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:15:35.767322 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:15:35.788849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514f9070500>]}
[0m15:15:35.789327 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:15:35.789617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514f939bd70>]}
[0m15:15:35.791007 [info ] [MainThread]: 
[0m15:15:35.791367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:35.791612 [info ] [MainThread]: 
[0m15:15:35.792291 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:15:35.797380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:15:35.833419 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:15:35.833905 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:15:35.834192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:35.842710 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m15:15:35.844369 [debug] [ThreadPool]: On list_db: Close
[0m15:15:35.846312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:15:35.851174 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:15:35.851504 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:15:35.851733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:35.857176 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:15:35.857619 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:15:35.858030 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:15:35.860529 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m15:15:35.861985 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:15:35.862504 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:15:35.867501 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:35.868021 [debug] [MainThread]: On master: BEGIN
[0m15:15:35.868310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:35.873951 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:15:35.874592 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:35.874946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:35.878155 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:15:35.879551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fab4bef0>]}
[0m15:15:35.880125 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:35.880757 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:35.881054 [debug] [MainThread]: On master: BEGIN
[0m15:15:35.881839 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:15:35.882401 [debug] [MainThread]: On master: COMMIT
[0m15:15:35.882885 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:35.883359 [debug] [MainThread]: On master: COMMIT
[0m15:15:35.884146 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:35.884630 [debug] [MainThread]: On master: Close
[0m15:15:35.888364 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m15:15:35.888911 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m15:15:35.889342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m15:15:35.889640 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m15:15:35.895584 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m15:15:35.896632 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m15:15:35.946680 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m15:15:35.947632 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:15:35.948082 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m15:15:35.948454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:35.962436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m15:15:35.963521 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:15:35.964547 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m15:15:35.990840 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m15:15:36.001149 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:15:36.001997 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m15:15:36.003268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:36.007932 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:15:36.008617 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m15:15:36.009993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:36.034574 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:15:36.035110 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:15:36.035660 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m15:15:36.039089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:15:36.051163 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m15:15:36.062373 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m15:15:36.063246 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m15:15:36.068446 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:15:36.071883 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m15:15:36.074378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fb6ea7b0>]}
[0m15:15:36.075225 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m15:15:36.076082 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m15:15:36.077368 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m15:15:36.077800 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:15:36.078370 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m15:15:36.079082 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:15:36.080152 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m15:15:36.080868 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:15:36.081267 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m15:15:36.081611 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:15:36.084543 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m15:15:36.086672 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:15:36.087302 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m15:15:36.087689 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:15:36.089999 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m15:15:36.091855 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:15:36.092438 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:15:36.092715 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m15:15:36.092964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:15:36.093261 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:15:36.093632 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:15:36.093876 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:15:36.102987 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m15:15:36.103446 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m15:15:36.103873 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:15:36.104397 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:15:36.104956 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m15:15:36.105347 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m15:15:36.114362 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m15:15:36.117300 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:15:36.117774 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m15:15:36.118149 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m15:15:36.120277 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:15:36.120714 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:15:36.121189 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:36.121521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:36.123526 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:15:36.125442 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:15:36.126074 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m15:15:36.126607 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:15:36.127683 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:15:36.128002 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:36.130342 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:15:36.131793 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:15:36.132202 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:15:36.132553 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:15:36.132876 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:15:36.133187 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m15:15:36.135858 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:15:36.138877 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:15:36.139408 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m15:15:36.139895 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:15:36.142735 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m15:15:36.143204 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:15:36.143684 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m15:15:36.144240 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m15:15:36.147090 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:15:36.148375 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:15:36.148756 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:15:36.149945 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m15:15:36.150468 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514f82c4410>]}
[0m15:15:36.151063 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e09aebd4-b529-4d06-ae2f-e19e6fdcae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514f82be9c0>]}
[0m15:15:36.151795 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m15:15:36.152520 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.07s]
[0m15:15:36.153091 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:15:36.153546 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m15:15:36.155904 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:36.156343 [debug] [MainThread]: On master: BEGIN
[0m15:15:36.156712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:36.162329 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:15:36.162803 [debug] [MainThread]: On master: COMMIT
[0m15:15:36.163064 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:36.163290 [debug] [MainThread]: On master: COMMIT
[0m15:15:36.163679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:36.163940 [debug] [MainThread]: On master: Close
[0m15:15:36.164385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:36.164627 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m15:15:36.164826 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m15:15:36.165017 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:15:36.165356 [info ] [MainThread]: 
[0m15:15:36.165645 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:15:36.166436 [debug] [MainThread]: Command end result
[0m15:15:36.187312 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:15:36.189852 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:15:36.194397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:15:36.194661 [info ] [MainThread]: 
[0m15:15:36.195035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:36.195331 [info ] [MainThread]: 
[0m15:15:36.195829 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:15:36.196704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9837887, "process_in_blocks": "0", "process_kernel_time": 0.334702, "process_mem_max_rss": "107728", "process_out_blocks": "3400", "process_user_time": 1.677544}
[0m15:15:36.197139 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:36.197049 after 0.98 seconds
[0m15:15:36.197453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fb20b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514f9317470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7514fb1dcec0>]}
[0m15:15:36.197796 [debug] [MainThread]: Flushing usage events
[0m15:15:37.121943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:27:33.097349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e497fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e43266c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e458ecf0>]}


============================== 06:27:33.107546 | d670fbe2-5bef-4848-9a75-9759ebeef857 ==============================
[0m06:27:33.107546 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:27:33.108122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:27:33.565858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e40caa50>]}
[0m06:27:33.674304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e4017bc0>]}
[0m06:27:33.675972 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:27:33.781635 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:27:33.965003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:27:33.965746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:27:34.025667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e27d4050>]}
[0m06:27:34.133049 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:27:34.144314 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:27:34.197565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e3fc6a80>]}
[0m06:27:34.198216 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:27:34.199209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e2486c60>]}
[0m06:27:34.201118 [info ] [MainThread]: 
[0m06:27:34.202244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:27:34.207897 [info ] [MainThread]: 
[0m06:27:34.209188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:27:34.215808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:27:34.309947 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:27:34.310467 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:27:34.310999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:27:34.334311 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m06:27:34.336032 [debug] [ThreadPool]: On list_db: Close
[0m06:27:34.338189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:27:34.343928 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:27:34.344324 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:27:34.344614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:27:34.352117 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:27:34.352817 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:27:34.353139 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:27:34.371350 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m06:27:34.373366 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:27:34.374159 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:27:34.380184 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:34.380616 [debug] [MainThread]: On master: BEGIN
[0m06:27:34.380930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:27:34.387536 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:27:34.387928 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:34.388324 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:27:34.398323 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m06:27:34.399914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e24ec710>]}
[0m06:27:34.400439 [debug] [MainThread]: On master: ROLLBACK
[0m06:27:34.400967 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:34.401284 [debug] [MainThread]: On master: BEGIN
[0m06:27:34.401942 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:27:34.402251 [debug] [MainThread]: On master: COMMIT
[0m06:27:34.402535 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:34.402803 [debug] [MainThread]: On master: COMMIT
[0m06:27:34.403289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:34.403602 [debug] [MainThread]: On master: Close
[0m06:27:34.407672 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:27:34.408524 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:27:34.409084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:27:34.409446 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:27:34.417953 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:27:34.419189 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:27:34.459136 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:27:34.460173 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:34.460696 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:27:34.461208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:34.468936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m06:27:34.469340 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:34.469650 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:27:34.498660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m06:27:34.505152 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:34.507245 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:27:34.509969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:27:34.515326 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:34.516128 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:27:34.517309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:34.544333 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:27:34.545081 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:34.545620 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:27:34.553046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m06:27:34.561090 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:27:34.569720 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:34.570536 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:27:34.579842 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:27:34.583324 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:27:34.585779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e4b1e720>]}
[0m06:27:34.586799 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m06:27:34.587687 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:27:34.589583 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:27:34.590189 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:27:34.590943 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:27:34.591757 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:27:34.592983 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:27:34.593706 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:27:34.594133 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:27:34.594868 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:27:34.598619 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:27:34.602527 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:27:34.604013 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:27:34.608292 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:27:34.609183 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:27:34.609554 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:27:34.610016 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:27:34.610729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:27:34.614015 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:27:34.615214 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:27:34.615542 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:27:34.615804 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:27:34.624124 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m06:27:34.624625 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:27:34.624966 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:27:34.629190 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m06:27:34.630059 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:27:34.630789 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:27:34.638164 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m06:27:34.644979 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:27:34.645556 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:27:34.648332 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:27:34.657824 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m06:27:34.661796 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:27:34.656866 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:27:34.662788 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:27:34.663263 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:27:34.664903 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:34.665328 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:34.667457 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:27:34.670872 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:27:34.671566 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:27:34.672021 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:27:34.672528 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:27:34.673817 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:34.675355 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:27:34.675739 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:27:34.676053 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:27:34.676415 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:27:34.679092 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:27:34.680011 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:27:34.680664 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m06:27:34.681226 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:27:34.684033 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:27:34.684926 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:27:34.685387 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:27:34.689441 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m06:27:34.691105 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:27:34.691484 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:27:34.692903 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:27:34.693620 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e050fb90>]}
[0m06:27:34.694465 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd670fbe2-5bef-4848-9a75-9759ebeef857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e052a030>]}
[0m06:27:34.695183 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m06:27:34.696546 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:27:34.695868 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.10s]
[0m06:27:34.697407 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:27:34.700856 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:34.701587 [debug] [MainThread]: On master: BEGIN
[0m06:27:34.702119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:27:34.710898 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m06:27:34.711394 [debug] [MainThread]: On master: COMMIT
[0m06:27:34.711715 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:34.712002 [debug] [MainThread]: On master: COMMIT
[0m06:27:34.712516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:34.712893 [debug] [MainThread]: On master: Close
[0m06:27:34.713412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:27:34.713712 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:27:34.713971 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:27:34.714836 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:27:34.715327 [info ] [MainThread]: 
[0m06:27:34.715706 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m06:27:34.717105 [debug] [MainThread]: Command end result
[0m06:27:34.742258 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:27:34.744072 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:27:34.751531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:27:34.751947 [info ] [MainThread]: 
[0m06:27:34.752398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:27:34.752990 [info ] [MainThread]: 
[0m06:27:34.754075 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:27:34.757023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7293413, "process_in_blocks": "104976", "process_kernel_time": 0.919727, "process_mem_max_rss": "107052", "process_out_blocks": "3392", "process_user_time": 2.903138}
[0m06:27:34.757764 [debug] [MainThread]: Command `dbt run` succeeded at 06:27:34.757533 after 1.73 seconds
[0m06:27:34.758173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e40583b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e45e4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7942e058b200>]}
[0m06:27:34.758623 [debug] [MainThread]: Flushing usage events
[0m06:27:36.084834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:28:29.186987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada5913d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada5931cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada5931ecc0>]}


============================== 06:28:29.198223 | c7eea1c8-535b-4111-bb8f-c71807a1127a ==============================
[0m06:28:29.198223 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:28:29.199416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:28:29.394121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada58ed6180>]}
[0m06:28:29.452448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada596ca000>]}
[0m06:28:29.453166 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:28:29.510330 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:28:29.612711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:28:29.613242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:28:29.641534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada57130470>]}
[0m06:28:29.710471 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:29.712481 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:29.733953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada57085d00>]}
[0m06:28:29.734337 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:28:29.734595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada572f5130>]}
[0m06:28:29.736527 [info ] [MainThread]: 
[0m06:28:29.736860 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:29.737233 [info ] [MainThread]: 
[0m06:28:29.737796 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:28:29.741366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:28:29.789717 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:28:29.790092 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:28:29.790307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:29.809980 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m06:28:29.811086 [debug] [ThreadPool]: On list_db: Close
[0m06:28:29.812812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:28:29.816849 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:29.817109 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:28:29.817321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:29.825013 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:28:29.826905 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:29.828386 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:28:29.833205 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:28:29.834502 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:28:29.835116 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:28:29.840009 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:29.840272 [debug] [MainThread]: On master: BEGIN
[0m06:28:29.840475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:28:29.847015 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:28:29.847532 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:29.849088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:28:29.852714 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:28:29.854642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada58b22f00>]}
[0m06:28:29.855729 [debug] [MainThread]: On master: ROLLBACK
[0m06:28:29.856485 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:29.856721 [debug] [MainThread]: On master: BEGIN
[0m06:28:29.857399 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:28:29.857643 [debug] [MainThread]: On master: COMMIT
[0m06:28:29.857853 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:29.858050 [debug] [MainThread]: On master: COMMIT
[0m06:28:29.858395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:29.858621 [debug] [MainThread]: On master: Close
[0m06:28:29.861344 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:28:29.861797 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:28:29.862157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:28:29.862409 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:28:29.867608 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:28:29.868273 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:28:29.900600 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:28:29.901282 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:29.901569 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:28:29.901786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:29.907962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:28:29.908370 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:29.909065 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:28:29.923708 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m06:28:29.932072 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:29.932613 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:28:29.933544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:28:29.936180 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:29.936496 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:28:29.937112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:28:29.954454 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:28:29.954771 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:29.954997 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:28:29.960067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:28:29.967748 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:28:29.972698 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:29.973050 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:28:29.977204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:28:29.980040 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:28:29.981721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada59676660>]}
[0m06:28:29.982427 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.12s]
[0m06:28:29.984043 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:28:29.986612 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:28:29.988229 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:28:29.987709 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:28:29.989643 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:28:29.989985 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:28:29.992602 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:28:29.989125 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:28:29.993850 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:28:29.994300 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:28:29.994664 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:28:29.996926 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:28:30.000205 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:28:30.000850 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:28:30.001314 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:28:30.001748 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:28:30.004561 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:28:30.005066 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:28:30.005554 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:28:30.006092 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:28:30.006347 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:28:30.012417 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m06:28:30.014507 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:28:30.014941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m06:28:30.015291 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:28:30.015598 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:28:30.016008 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:28:30.024594 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:28:30.027120 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:28:30.027439 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:28:30.028058 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:28:30.029978 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:28:30.030246 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:28:30.030737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:28:30.031926 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:28:30.032179 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:28:30.032390 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:28:30.033053 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m06:28:30.034797 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:28:30.035077 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:28:30.035401 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:28:30.036915 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:28:30.037422 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:28:30.037687 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:28:30.038108 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:28:30.040249 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:28:30.040653 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:28:30.041213 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:28:30.042895 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:28:30.043436 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:28:30.043771 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:28:30.044868 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:28:30.045836 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:28:30.046310 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada561a20f0>]}
[0m06:28:30.047147 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:28:30.049582 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:28:30.046825 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m06:28:30.050383 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:28:30.050857 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:28:30.051192 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:28:30.054365 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:28:30.055677 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:28:30.056192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7eea1c8-535b-4111-bb8f-c71807a1127a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada56307590>]}
[0m06:28:30.056664 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.07s]
[0m06:28:30.057100 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:28:30.058575 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:30.058992 [debug] [MainThread]: On master: BEGIN
[0m06:28:30.059272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:28:30.065732 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:28:30.066070 [debug] [MainThread]: On master: COMMIT
[0m06:28:30.066323 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:30.066537 [debug] [MainThread]: On master: COMMIT
[0m06:28:30.067088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:30.067354 [debug] [MainThread]: On master: Close
[0m06:28:30.067721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:30.067944 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:28:30.068132 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:28:30.068313 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:28:30.068589 [info ] [MainThread]: 
[0m06:28:30.068867 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m06:28:30.069609 [debug] [MainThread]: Command end result
[0m06:28:30.086687 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:30.088316 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:30.093262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:28:30.093527 [info ] [MainThread]: 
[0m06:28:30.093824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:28:30.094365 [info ] [MainThread]: 
[0m06:28:30.095019 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:28:30.096379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.95243835, "process_in_blocks": "0", "process_kernel_time": 0.400887, "process_mem_max_rss": "107632", "process_out_blocks": "3392", "process_user_time": 1.692208}
[0m06:28:30.096801 [debug] [MainThread]: Command `dbt run` succeeded at 06:28:30.096714 after 0.95 seconds
[0m06:28:30.097080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada5aafc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada591ad2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada56e7ff80>]}
[0m06:28:30.097352 [debug] [MainThread]: Flushing usage events
[0m06:28:31.328875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:29:28.905483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618de0b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618de09cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618de08b90>]}


============================== 06:29:28.914475 | 6dbd8fd6-e502-432a-a2a9-f49c94891b7a ==============================
[0m06:29:28.914475 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:29:28.915125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:29.181134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618d8f6a50>]}
[0m06:29:29.233610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618e2e6b40>]}
[0m06:29:29.234392 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:29:29.297721 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:29:29.416920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:29.417316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:29.460085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618c010230>]}
[0m06:29:29.522068 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:29.524346 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:29.544177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618eb97ce0>]}
[0m06:29:29.544632 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:29:29.544921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618bcdffe0>]}
[0m06:29:29.546207 [info ] [MainThread]: 
[0m06:29:29.546523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:29:29.546755 [info ] [MainThread]: 
[0m06:29:29.547157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:29:29.550636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:29:29.590735 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:29:29.591352 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:29:29.591745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:29.603266 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m06:29:29.605547 [debug] [ThreadPool]: On list_db: Close
[0m06:29:29.608597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:29:29.616061 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:29.616465 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:29:29.616752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:29.626038 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:29:29.626428 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:29.626675 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:29:29.630555 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m06:29:29.632325 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:29:29.632927 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:29:29.638432 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:29.638821 [debug] [MainThread]: On master: BEGIN
[0m06:29:29.639071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:29.652787 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:29:29.653204 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:29.653494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:29:29.656329 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:29:29.657535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618d7eab40>]}
[0m06:29:29.657980 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:29.658435 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:29.658682 [debug] [MainThread]: On master: BEGIN
[0m06:29:29.659186 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:29:29.659424 [debug] [MainThread]: On master: COMMIT
[0m06:29:29.659602 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:29.659767 [debug] [MainThread]: On master: COMMIT
[0m06:29:29.660161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:29.660374 [debug] [MainThread]: On master: Close
[0m06:29:29.663118 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:29:29.663618 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:29:29.664098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:29:29.664367 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:29:29.669825 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:29:29.670833 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:29:29.705215 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:29:29.705938 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:29.706234 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:29:29.706458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:29.713508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:29:29.714469 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:29.714801 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:29:29.723302 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:29:29.728504 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:29.728847 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:29:29.729496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:29.731457 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:29.731850 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:29:29.732703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:29.746823 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:29:29.747228 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:29.747471 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:29:29.772554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m06:29:29.780299 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:29:29.787280 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:29.788290 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:29:29.791664 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:29:29.794173 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:29:29.796034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618e3426c0>]}
[0m06:29:29.796750 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m06:29:29.797356 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:29:29.798660 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:29:29.799147 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:29:29.799714 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:29:29.801161 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:29:29.800443 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:29:29.801880 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:29:29.802178 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:29:29.801426 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:29:29.804434 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:29:29.807077 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:29:29.807880 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:29:29.810823 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:29:29.811347 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:29:29.814001 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:29:29.814673 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:29:29.815074 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:29.815411 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:29:29.815761 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:29:29.816244 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:29:29.816912 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:29:29.822841 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m06:29:29.823195 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:29:29.823480 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:29:29.824195 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m06:29:29.824460 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:29.824686 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:29:29.830203 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:29:29.832776 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:29:29.833084 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:29:29.833652 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:29.835539 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:29:29.835807 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:29:29.836467 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:29.837741 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:29:29.838050 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m06:29:29.838334 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:29:29.840374 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:29.840709 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:29:29.840996 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:29:29.841627 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:29.843396 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:29.843704 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:29:29.844118 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:29:29.845574 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:29:29.846244 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:29:29.846589 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:29.846917 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:29:29.848179 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:29:29.848683 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:29.849050 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:29:29.850884 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:29:29.851897 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:29:29.852149 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:29:29.853702 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:29:29.854362 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618ae7d700>]}
[0m06:29:29.854874 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:29.855447 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.05s]
[0m06:29:29.856121 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:29:29.856702 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:29:29.859256 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:29:29.860296 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:29:29.860724 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dbd8fd6-e502-432a-a2a9-f49c94891b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618858f140>]}
[0m06:29:29.861181 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m06:29:29.861587 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:29:29.863038 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:29.863289 [debug] [MainThread]: On master: BEGIN
[0m06:29:29.863491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:29.869328 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:29:29.869646 [debug] [MainThread]: On master: COMMIT
[0m06:29:29.869870 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:29.870065 [debug] [MainThread]: On master: COMMIT
[0m06:29:29.870450 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:29.870747 [debug] [MainThread]: On master: Close
[0m06:29:29.871172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:29.871407 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:29:29.871611 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:29:29.871804 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:29:29.872115 [info ] [MainThread]: 
[0m06:29:29.872390 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m06:29:29.873125 [debug] [MainThread]: Command end result
[0m06:29:29.890071 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:29.891656 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:29.896370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:29:29.896732 [info ] [MainThread]: 
[0m06:29:29.897267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:29.898499 [info ] [MainThread]: 
[0m06:29:29.898903 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:29:29.900648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0413848, "process_in_blocks": "0", "process_kernel_time": 0.34919, "process_mem_max_rss": "107904", "process_out_blocks": "3392", "process_user_time": 1.861024}
[0m06:29:29.901171 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:29.901074 after 1.04 seconds
[0m06:29:29.901582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618e00fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618e3426c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74618eb94680>]}
[0m06:29:29.901875 [debug] [MainThread]: Flushing usage events
[0m06:29:31.142217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:30:28.961991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b36e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b61d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b06f500>]}


============================== 06:30:28.976486 | d227139d-1088-4a65-94c1-5f7d2705a746 ==============================
[0m06:30:28.976486 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:30:28.978667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:30:29.228500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b13d460>]}
[0m06:30:29.280135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b72bc80>]}
[0m06:30:29.281176 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:30:29.346462 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:30:29.437025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:30:29.437426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:30:29.467103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b3d5e50>]}
[0m06:30:29.535717 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:30:29.537778 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:30:29.556256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3931c890>]}
[0m06:30:29.556709 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:30:29.557002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3956eb10>]}
[0m06:30:29.558372 [info ] [MainThread]: 
[0m06:30:29.558680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:30:29.558862 [info ] [MainThread]: 
[0m06:30:29.560969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:30:29.564434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:30:29.602774 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:30:29.603202 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:30:29.603402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:29.616203 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m06:30:29.617478 [debug] [ThreadPool]: On list_db: Close
[0m06:30:29.619126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:30:29.628787 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:30:29.629151 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:30:29.629391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:29.636834 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:30:29.637427 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:30:29.638093 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:30:29.642118 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:30:29.643760 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:30:29.644456 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:30:29.650647 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:29.651018 [debug] [MainThread]: On master: BEGIN
[0m06:30:29.651320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:30:29.658794 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:30:29.660412 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:29.661161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:30:29.665798 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:30:29.667150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3927a000>]}
[0m06:30:29.667652 [debug] [MainThread]: On master: ROLLBACK
[0m06:30:29.668315 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:29.668734 [debug] [MainThread]: On master: BEGIN
[0m06:30:29.669475 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:30:29.669765 [debug] [MainThread]: On master: COMMIT
[0m06:30:29.670003 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:29.670222 [debug] [MainThread]: On master: COMMIT
[0m06:30:29.670605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:30:29.670866 [debug] [MainThread]: On master: Close
[0m06:30:29.674892 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:30:29.675531 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:30:29.675959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:30:29.676250 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:30:29.681481 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:30:29.682226 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:30:29.712018 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:30:29.712657 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:30:29.712984 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:30:29.713210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:30:29.721051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m06:30:29.721383 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:30:29.721626 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:30:29.746363 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m06:30:29.752977 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:30:29.753461 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:30:29.755081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:29.759439 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:30:29.759793 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:30:29.760699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:30:29.775065 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:30:29.775628 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:30:29.776153 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:30:29.779678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:30:29.786579 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:30:29.790786 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:30:29.791115 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:30:29.795296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:30:29.797780 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:30:29.799249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b90dfa0>]}
[0m06:30:29.800045 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.12s]
[0m06:30:29.801477 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:30:29.802928 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:30:29.803276 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:30:29.803765 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:30:29.804242 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:30:29.804796 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:30:29.805374 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:30:29.805818 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:30:29.806109 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:30:29.808337 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:30:29.810400 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:30:29.811053 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:30:29.811364 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:30:29.813442 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:30:29.815326 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:30:29.816104 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:30:29.816498 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:30:29.816842 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:30:29.817203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:30:29.817553 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:30:29.818012 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:30:29.823485 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m06:30:29.823810 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:30:29.824129 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m06:30:29.824521 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:30:29.824927 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:30:29.825362 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:30:29.830961 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:30:29.831400 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:30:29.833928 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:30:29.835944 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:30:29.836306 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:30:29.836798 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:30:29.837583 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:30:29.837843 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:29.840245 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:30:29.842188 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:30:29.842543 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:30:29.842963 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:30:29.843810 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:30:29.844151 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:29.845390 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:30:29.846687 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:30:29.847071 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:30:29.847380 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:30:29.847669 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:30:29.847962 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:30:29.850243 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:30:29.851846 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:30:29.852185 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m06:30:29.852631 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:30:29.854092 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:30:29.854515 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:30:29.855032 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:30:29.855509 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:30:29.858017 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:30:29.859103 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:30:29.859612 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e38359160>]}
[0m06:30:29.859974 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:30:29.860688 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.05s]
[0m06:30:29.862305 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:30:29.862785 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:30:29.863328 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd227139d-1088-4a65-94c1-5f7d2705a746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e384360c0>]}
[0m06:30:29.863968 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m06:30:29.864385 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:30:29.865972 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:29.866243 [debug] [MainThread]: On master: BEGIN
[0m06:30:29.866458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:30:29.871701 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:30:29.872062 [debug] [MainThread]: On master: COMMIT
[0m06:30:29.872308 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:29.872548 [debug] [MainThread]: On master: COMMIT
[0m06:30:29.872952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:30:29.873187 [debug] [MainThread]: On master: Close
[0m06:30:29.873552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:30:29.873750 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:30:29.873927 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:30:29.874116 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:30:29.874414 [info ] [MainThread]: 
[0m06:30:29.874673 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m06:30:29.875407 [debug] [MainThread]: Command end result
[0m06:30:29.896395 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:30:29.898559 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:30:29.907952 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:30:29.908603 [info ] [MainThread]: 
[0m06:30:29.909424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:30:29.910100 [info ] [MainThread]: 
[0m06:30:29.910735 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:30:29.912304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0514461, "process_in_blocks": "0", "process_kernel_time": 0.321564, "process_mem_max_rss": "107696", "process_out_blocks": "3392", "process_user_time": 1.831696}
[0m06:30:29.913258 [debug] [MainThread]: Command `dbt run` succeeded at 06:30:29.913058 after 1.05 seconds
[0m06:30:29.913870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3b2586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e393912b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e3ccb1ca0>]}
[0m06:30:29.914472 [debug] [MainThread]: Flushing usage events
[0m06:30:31.071936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:31:30.644278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae8d12ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae8e633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae8ba3980>]}


============================== 06:31:30.653288 | 0ec016bb-8151-4e1b-a9bd-1f62067814fa ==============================
[0m06:31:30.653288 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:31:30.653711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:31:30.838490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae86f0a10>]}
[0m06:31:30.895112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae87fc560>]}
[0m06:31:30.895970 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:31:30.949275 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:31:31.037746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:31:31.038095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:31:31.071978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae86f2bd0>]}
[0m06:31:31.140832 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:31:31.143058 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:31:31.168960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae6b93470>]}
[0m06:31:31.169822 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:31:31.170266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae87ffe30>]}
[0m06:31:31.171893 [info ] [MainThread]: 
[0m06:31:31.172209 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:31:31.172414 [info ] [MainThread]: 
[0m06:31:31.172791 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:31:31.176681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:31:31.212745 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:31:31.213110 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:31:31.213382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:31:31.219937 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m06:31:31.221471 [debug] [ThreadPool]: On list_db: Close
[0m06:31:31.223956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:31:31.228270 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:31:31.228555 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:31:31.228754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:31:31.233686 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:31:31.233973 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:31:31.234177 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:31:31.236176 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m06:31:31.237239 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:31:31.237705 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:31:31.241769 [debug] [MainThread]: Using postgres connection "master"
[0m06:31:31.242054 [debug] [MainThread]: On master: BEGIN
[0m06:31:31.242274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:31:31.247551 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:31:31.248326 [debug] [MainThread]: Using postgres connection "master"
[0m06:31:31.248613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:31:31.251344 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:31:31.252349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae6e26f30>]}
[0m06:31:31.252735 [debug] [MainThread]: On master: ROLLBACK
[0m06:31:31.253075 [debug] [MainThread]: Using postgres connection "master"
[0m06:31:31.253353 [debug] [MainThread]: On master: BEGIN
[0m06:31:31.253922 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:31:31.254252 [debug] [MainThread]: On master: COMMIT
[0m06:31:31.254444 [debug] [MainThread]: Using postgres connection "master"
[0m06:31:31.254624 [debug] [MainThread]: On master: COMMIT
[0m06:31:31.255013 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:31:31.255249 [debug] [MainThread]: On master: Close
[0m06:31:31.257920 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:31:31.258351 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:31:31.258708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:31:31.258945 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:31:31.264292 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:31:31.264783 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:31:31.310365 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:31:31.311086 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:31:31.311394 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:31:31.311620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:31.317588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:31:31.317969 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:31:31.318241 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:31:31.325534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:31:31.330458 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:31:31.330815 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:31:31.332407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:31:31.334656 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:31:31.334990 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:31:31.336969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:31:31.351771 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:31:31.352185 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:31:31.352435 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:31:31.357399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m06:31:31.363129 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:31:31.367110 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:31:31.367445 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:31:31.370964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:31:31.372702 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:31:31.374163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbaea6562d0>]}
[0m06:31:31.374702 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m06:31:31.375188 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:31:31.376930 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:31:31.377345 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:31:31.377753 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:31:31.378057 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:31:31.378346 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:31:31.378866 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:31:31.383744 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:31:31.384500 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:31:31.385310 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:31:31.385594 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:31:31.388610 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:31:31.390723 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:31:31.391732 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:31:31.394986 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:31:31.395620 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:31:31.396168 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:31:31.396442 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:31:31.397262 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:31:31.397586 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:31:31.397857 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:31:31.403845 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m06:31:31.404633 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:31:31.405442 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m06:31:31.405921 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:31:31.406250 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:31:31.407075 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:31:31.415201 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:31:31.415783 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:31:31.419015 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:31:31.421429 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:31:31.422151 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:31:31.422708 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:31:31.423855 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:31:31.424349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:31:31.426820 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:31:31.428962 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:31:31.429464 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:31:31.429810 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:31:31.430860 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:31:31.431466 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:31:31.433056 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:31:31.434309 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:31:31.434759 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:31:31.435090 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:31:31.435527 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:31:31.435853 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:31:31.451660 [debug] [Thread-4 (]: SQL status: COMMIT in 0.015 seconds
[0m06:31:31.455560 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:31:31.456334 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m06:31:31.457271 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:31:31.459503 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:31:31.460149 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:31:31.460859 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:31:31.461559 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:31:31.465500 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:31:31.467323 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:31:31.468038 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:31:31.469044 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae5d4ec90>]}
[0m06:31:31.470912 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:31:31.471800 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.08s]
[0m06:31:31.472600 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ec016bb-8151-4e1b-a9bd-1f62067814fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae5ecfb30>]}
[0m06:31:31.473403 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:31:31.474080 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m06:31:31.475589 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:31:31.478139 [debug] [MainThread]: Using postgres connection "master"
[0m06:31:31.478472 [debug] [MainThread]: On master: BEGIN
[0m06:31:31.478735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:31:31.487312 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:31:31.487765 [debug] [MainThread]: On master: COMMIT
[0m06:31:31.488042 [debug] [MainThread]: Using postgres connection "master"
[0m06:31:31.488297 [debug] [MainThread]: On master: COMMIT
[0m06:31:31.488870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:31:31.489362 [debug] [MainThread]: On master: Close
[0m06:31:31.490008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:31:31.490366 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:31:31.490686 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:31:31.490962 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:31:31.491364 [info ] [MainThread]: 
[0m06:31:31.491956 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m06:31:31.493459 [debug] [MainThread]: Command end result
[0m06:31:31.509192 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:31:31.511196 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:31:31.518285 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:31:31.518610 [info ] [MainThread]: 
[0m06:31:31.518912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:31:31.519714 [info ] [MainThread]: 
[0m06:31:31.520212 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:31:31.521535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.91815346, "process_in_blocks": "0", "process_kernel_time": 0.399999, "process_mem_max_rss": "107640", "process_out_blocks": "3392", "process_user_time": 2.046151}
[0m06:31:31.522149 [debug] [MainThread]: Command `dbt run` succeeded at 06:31:31.522021 after 0.92 seconds
[0m06:31:31.522548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae9143e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbaea6562d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbae89fe120>]}
[0m06:31:31.522954 [debug] [MainThread]: Flushing usage events
[0m06:31:32.809650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:32:29.181861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad2657cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad2657e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad2657ce00>]}


============================== 06:32:29.187176 | 1ce980e0-63ee-4392-bd65-e5fcb8f26028 ==============================
[0m06:32:29.187176 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:32:29.187597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:32:29.413109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad258b4740>]}
[0m06:32:29.475931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad25d9e090>]}
[0m06:32:29.477292 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:32:29.538990 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:32:29.653701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:32:29.654111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:32:29.689647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad24169070>]}
[0m06:32:29.756698 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:32:29.759167 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:32:29.783127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad23ec0c80>]}
[0m06:32:29.783616 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:32:29.783930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad25a0dac0>]}
[0m06:32:29.785463 [info ] [MainThread]: 
[0m06:32:29.785816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:32:29.786053 [info ] [MainThread]: 
[0m06:32:29.786503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:32:29.790691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:32:29.839553 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:32:29.839957 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:32:29.840183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:29.852492 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m06:32:29.855651 [debug] [ThreadPool]: On list_db: Close
[0m06:32:29.858251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:32:29.865448 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:32:29.865862 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:32:29.866180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:29.874873 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:32:29.875327 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:32:29.875645 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:32:29.880069 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:32:29.881636 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:32:29.882252 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:32:29.888994 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:29.889526 [debug] [MainThread]: On master: BEGIN
[0m06:32:29.889834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:32:29.898971 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m06:32:29.899387 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:29.899683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:32:29.902590 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:32:29.904153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad23e6c2f0>]}
[0m06:32:29.904764 [debug] [MainThread]: On master: ROLLBACK
[0m06:32:29.905443 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:29.906037 [debug] [MainThread]: On master: BEGIN
[0m06:32:29.907037 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:32:29.907391 [debug] [MainThread]: On master: COMMIT
[0m06:32:29.907674 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:29.907933 [debug] [MainThread]: On master: COMMIT
[0m06:32:29.908427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:32:29.908833 [debug] [MainThread]: On master: Close
[0m06:32:29.912143 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:32:29.912563 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:32:29.913159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:32:29.913437 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:32:29.919721 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:32:29.921514 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:32:29.952972 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:32:29.953728 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:32:29.953996 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:32:29.954221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:29.964267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m06:32:29.965216 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:32:29.965870 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:32:29.977773 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:32:29.983313 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:32:29.983693 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:32:29.984496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:32:29.987356 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:32:29.987728 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:32:29.989671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:32:30.012464 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:32:30.012874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:32:30.013174 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:32:30.022854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m06:32:30.032275 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:32:30.038465 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:32:30.038840 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:32:30.044307 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m06:32:30.049395 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:32:30.052020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad264d2090>]}
[0m06:32:30.052829 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.14s]
[0m06:32:30.053564 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:32:30.054874 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:32:30.055487 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:32:30.056310 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:32:30.057049 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:32:30.057777 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:32:30.058515 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:32:30.059144 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:32:30.059795 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:32:30.064045 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:32:30.067381 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:32:30.068562 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:32:30.071349 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:32:30.071918 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:32:30.075709 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:32:30.076616 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:32:30.077483 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:32:30.078349 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:32:30.080309 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:32:30.082939 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:32:30.083494 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:32:30.091523 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m06:32:30.091967 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:32:30.092538 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:32:30.098736 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m06:32:30.099402 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:32:30.099661 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:32:30.104841 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m06:32:30.107402 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:32:30.107713 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:32:30.108360 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:32:30.110331 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:32:30.110732 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:32:30.111036 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:32:30.113272 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:32:30.113747 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:32:30.114033 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:32:30.115279 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:32:30.115576 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:32:30.115858 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:32:30.116147 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:32:30.118483 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:32:30.118920 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:32:30.119538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:32:30.120602 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:32:30.120859 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:32:30.121121 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:32:30.122286 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:32:30.124311 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:32:30.124794 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:32:30.125071 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:32:30.125561 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m06:32:30.127164 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:32:30.127750 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:32:30.128601 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:32:30.129134 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:32:30.130351 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:32:30.131055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad20743d40>]}
[0m06:32:30.131577 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m06:32:30.132005 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:32:30.133522 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:32:30.134666 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:32:30.135118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce980e0-63ee-4392-bd65-e5fcb8f26028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad2300e4e0>]}
[0m06:32:30.135583 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m06:32:30.135970 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:32:30.137458 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:30.137717 [debug] [MainThread]: On master: BEGIN
[0m06:32:30.137936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:32:30.142394 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:32:30.142655 [debug] [MainThread]: On master: COMMIT
[0m06:32:30.142863 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:30.143060 [debug] [MainThread]: On master: COMMIT
[0m06:32:30.143422 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:32:30.143704 [debug] [MainThread]: On master: Close
[0m06:32:30.144045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:32:30.144250 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:32:30.144434 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:32:30.144604 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:32:30.144875 [info ] [MainThread]: 
[0m06:32:30.145292 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m06:32:30.146467 [debug] [MainThread]: Command end result
[0m06:32:30.161098 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:32:30.162449 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:32:30.169960 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:32:30.170329 [info ] [MainThread]: 
[0m06:32:30.170697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:32:30.170966 [info ] [MainThread]: 
[0m06:32:30.171548 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:32:30.172914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0370964, "process_in_blocks": "0", "process_kernel_time": 0.40319, "process_mem_max_rss": "108044", "process_out_blocks": "3392", "process_user_time": 1.860879}
[0m06:32:30.173364 [debug] [MainThread]: Command `dbt run` succeeded at 06:32:30.173275 after 1.04 seconds
[0m06:32:30.173647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad25a0d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad25932a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dad266fc7d0>]}
[0m06:32:30.173932 [debug] [MainThread]: Flushing usage events
[0m06:32:31.352528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:33:29.229027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bee8ac080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bee8ad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bee8ac260>]}


============================== 06:33:29.236072 | 90cfcdb8-b513-4755-a680-e309f6ed6c88 ==============================
[0m06:33:29.236072 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:33:29.236647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:33:29.419220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bee7f36b0>]}
[0m06:33:29.469327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708becf6c800>]}
[0m06:33:29.470130 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:33:29.554388 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:33:29.652616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:33:29.653010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:33:29.682263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bed044e60>]}
[0m06:33:29.743121 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:33:29.745312 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:33:29.767508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bee83e1b0>]}
[0m06:33:29.767944 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:33:29.768228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bef370b30>]}
[0m06:33:29.769678 [info ] [MainThread]: 
[0m06:33:29.770021 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:33:29.770245 [info ] [MainThread]: 
[0m06:33:29.770638 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:29.774298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:33:29.816357 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:33:29.816730 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:33:29.816950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:29.825759 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m06:33:29.826980 [debug] [ThreadPool]: On list_db: Close
[0m06:33:29.828341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:33:29.832412 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:33:29.832704 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:33:29.832917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:29.837706 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:33:29.837999 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:33:29.838237 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:33:29.840973 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m06:33:29.842042 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:33:29.842496 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:33:29.846665 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:29.847013 [debug] [MainThread]: On master: BEGIN
[0m06:33:29.847233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:33:29.852981 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:33:29.853341 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:29.853625 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:33:29.856689 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:33:29.858007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bee83edb0>]}
[0m06:33:29.858782 [debug] [MainThread]: On master: ROLLBACK
[0m06:33:29.859877 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:29.860155 [debug] [MainThread]: On master: BEGIN
[0m06:33:29.861063 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:33:29.861881 [debug] [MainThread]: On master: COMMIT
[0m06:33:29.862446 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:29.862764 [debug] [MainThread]: On master: COMMIT
[0m06:33:29.863268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:29.863532 [debug] [MainThread]: On master: Close
[0m06:33:29.866663 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:33:29.867143 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:33:29.867533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:33:29.867779 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:33:29.875406 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:33:29.876065 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:33:29.903345 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:33:29.903979 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:29.904258 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:33:29.904480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:29.911182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:33:29.911604 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:29.911862 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:33:29.918896 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:33:29.923880 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:29.924213 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:33:29.925018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:29.927238 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:29.927518 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:33:29.928041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:29.941918 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:33:29.942513 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:29.942833 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:33:29.950723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:33:29.956434 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:33:29.960754 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:29.961139 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:33:29.964841 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:33:29.966813 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:33:29.968918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bef3721b0>]}
[0m06:33:29.969457 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.10s]
[0m06:33:29.970334 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:33:29.971360 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:33:29.971720 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:33:29.972162 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:33:29.972626 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:33:29.973157 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:33:29.973553 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:33:29.973894 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:33:29.974250 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:33:29.976386 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:33:29.978434 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:33:29.979171 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:33:29.979480 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:33:29.982512 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:33:29.984712 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:33:29.985510 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:33:29.985806 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:33:29.986149 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:33:29.986484 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:33:29.986768 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:33:29.987040 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:33:29.992306 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:33:29.992732 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:33:29.992968 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:33:29.993254 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m06:33:29.993486 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:33:29.993685 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:33:30.002249 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:33:30.004791 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:33:30.005066 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:33:30.005357 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:33:30.007555 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:33:30.007871 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:33:30.008155 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:33:30.010025 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:33:30.010489 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:33:30.010790 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:30.013018 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:33:30.013346 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:33:30.013629 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:33:30.014901 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:33:30.015493 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:33:30.015804 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:30.016101 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:33:30.017406 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:33:30.018694 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:33:30.019006 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:33:30.020592 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:33:30.022353 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:33:30.022693 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:33:30.023119 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:33:30.024686 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:33:30.025011 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:33:30.025449 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:33:30.025820 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:33:30.028427 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:33:30.029595 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:33:30.030101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708be4d172f0>]}
[0m06:33:30.030627 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m06:33:30.031080 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:33:30.032049 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:33:30.033185 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:33:30.033660 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90cfcdb8-b513-4755-a680-e309f6ed6c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708be7e325a0>]}
[0m06:33:30.034093 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m06:33:30.034765 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:33:30.036213 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:30.036474 [debug] [MainThread]: On master: BEGIN
[0m06:33:30.036677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:33:30.041417 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:33:30.041708 [debug] [MainThread]: On master: COMMIT
[0m06:33:30.041920 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:30.042126 [debug] [MainThread]: On master: COMMIT
[0m06:33:30.042546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:30.042807 [debug] [MainThread]: On master: Close
[0m06:33:30.043202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:30.043412 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:33:30.043587 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:33:30.043755 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:33:30.044091 [info ] [MainThread]: 
[0m06:33:30.044558 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m06:33:30.045654 [debug] [MainThread]: Command end result
[0m06:33:30.068516 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:33:30.070061 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:33:30.074987 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:33:30.075298 [info ] [MainThread]: 
[0m06:33:30.075608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:33:30.075833 [info ] [MainThread]: 
[0m06:33:30.076072 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:33:30.077178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.88582706, "process_in_blocks": "0", "process_kernel_time": 0.375272, "process_mem_max_rss": "107608", "process_out_blocks": "3392", "process_user_time": 2.224272}
[0m06:33:30.077626 [debug] [MainThread]: Command `dbt run` succeeded at 06:33:30.077535 after 0.89 seconds
[0m06:33:30.078002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708befb84170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708befc45460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708bee7d2d50>]}
[0m06:33:30.078312 [debug] [MainThread]: Flushing usage events
[0m06:33:31.858102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:29.085590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3609d8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3609d9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3609d8590>]}


============================== 06:34:29.091441 | 94758e3a-4a68-4ba3-bc8b-47ca7be831bc ==============================
[0m06:34:29.091441 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:29.091809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:34:29.319357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3609d8320>]}
[0m06:34:29.370091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df360a4f410>]}
[0m06:34:29.370837 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:29.420718 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:34:29.511114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:29.511471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:29.542253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35f134fb0>]}
[0m06:34:29.606306 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:29.608170 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:29.626265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3609684d0>]}
[0m06:34:29.626662 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:34:29.626955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35ee208c0>]}
[0m06:34:29.628166 [info ] [MainThread]: 
[0m06:34:29.628490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:29.628672 [info ] [MainThread]: 
[0m06:34:29.629021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:29.634993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:34:29.684223 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:34:29.685209 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:34:29.685427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:29.702350 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:34:29.704688 [debug] [ThreadPool]: On list_db: Close
[0m06:34:29.706960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:34:29.715087 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:29.715414 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:34:29.715631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:29.725324 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m06:34:29.725689 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:29.725950 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:34:29.730178 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:34:29.731530 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:34:29.731983 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:34:29.737031 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:29.737367 [debug] [MainThread]: On master: BEGIN
[0m06:34:29.737564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:29.746305 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m06:34:29.746938 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:29.747524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:29.750981 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:34:29.753355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df360a4d880>]}
[0m06:34:29.754069 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:29.754820 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:29.755488 [debug] [MainThread]: On master: BEGIN
[0m06:34:29.757232 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:34:29.758131 [debug] [MainThread]: On master: COMMIT
[0m06:34:29.758470 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:29.758677 [debug] [MainThread]: On master: COMMIT
[0m06:34:29.759357 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:29.759617 [debug] [MainThread]: On master: Close
[0m06:34:29.764434 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:34:29.764965 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:34:29.765355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:34:29.765621 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:34:29.770654 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:34:29.771595 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:34:29.803555 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:34:29.804246 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:29.804584 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:34:29.804821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:29.812942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m06:34:29.814045 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:29.814367 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:34:29.825389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:34:29.833938 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:29.834389 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:34:29.835402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:29.839828 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:29.840392 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:34:29.841223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:29.856686 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:29.857312 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:29.857567 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:29.861926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m06:34:29.872882 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:34:29.878284 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:29.878641 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:34:29.883020 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:34:29.886242 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:34:29.888389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3608fac30>]}
[0m06:34:29.889132 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.12s]
[0m06:34:29.889763 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:34:29.890910 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:34:29.891398 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:34:29.891889 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:34:29.892179 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:34:29.894558 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:34:29.894956 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:34:29.895527 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:34:29.895968 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:34:29.896379 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:34:29.898818 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:34:29.899180 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:34:29.901402 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:34:29.901920 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:34:29.902229 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:34:29.902531 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:34:29.904620 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:34:29.904948 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:34:29.905679 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:29.905916 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:34:29.906122 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:34:29.911400 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:29.911752 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:29.911977 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:34:29.913178 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m06:34:29.913455 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:34:29.913662 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:34:29.923281 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:34:29.925987 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:29.926416 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m06:34:29.926874 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:34:29.929111 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:34:29.929511 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:34:29.929821 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:29.930105 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:29.931983 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:29.933942 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:34:29.934267 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:34:29.934671 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:34:29.935412 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:29.936612 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:34:29.936890 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:34:29.937379 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:34:29.937649 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:34:29.938706 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:34:29.939209 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:29.939482 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:34:29.941692 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:34:29.943283 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:34:29.943640 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m06:34:29.944217 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:34:29.945763 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:34:29.946202 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:34:29.946652 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:29.947128 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:34:29.949597 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:34:29.950688 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:34:29.951207 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35dfda690>]}
[0m06:34:29.951665 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m06:34:29.952070 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:34:29.954635 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:34:29.955711 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:34:29.956242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94758e3a-4a68-4ba3-bc8b-47ca7be831bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35ee3a510>]}
[0m06:34:29.956751 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m06:34:29.957155 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:34:29.958644 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:29.958894 [debug] [MainThread]: On master: BEGIN
[0m06:34:29.959097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:29.964222 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:34:29.964537 [debug] [MainThread]: On master: COMMIT
[0m06:34:29.964756 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:29.964968 [debug] [MainThread]: On master: COMMIT
[0m06:34:29.965321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:29.965559 [debug] [MainThread]: On master: Close
[0m06:34:29.965893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:29.966090 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:34:29.966244 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:34:29.966382 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:34:29.966624 [info ] [MainThread]: 
[0m06:34:29.966881 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m06:34:29.967584 [debug] [MainThread]: Command end result
[0m06:34:29.987148 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:29.989321 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:29.994127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:34:29.994532 [info ] [MainThread]: 
[0m06:34:29.995781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:29.996797 [info ] [MainThread]: 
[0m06:34:29.997762 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:34:29.998729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9607026, "process_in_blocks": "0", "process_kernel_time": 0.340642, "process_mem_max_rss": "108044", "process_out_blocks": "3392", "process_user_time": 1.695382}
[0m06:34:29.999142 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:29.999058 after 0.96 seconds
[0m06:34:29.999422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df360dfedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3609d95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df360e12360>]}
[0m06:34:29.999691 [debug] [MainThread]: Flushing usage events
[0m06:34:29.994028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:35:27.831616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60a8b6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60aa86f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60a8b6ff0>]}


============================== 06:35:27.836840 | 09d40a4a-cb86-4c54-a520-dad5d22aa2d2 ==============================
[0m06:35:27.836840 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:35:27.838639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:35:28.033557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60adf3d70>]}
[0m06:35:27.409942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60a60a8d0>]}
[0m06:35:27.421691 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:35:27.491555 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:35:27.581752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:35:27.582501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:35:27.609611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca608affd40>]}
[0m06:35:27.667102 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:35:27.674133 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:35:27.697041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6087b3a10>]}
[0m06:35:27.697437 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:35:27.697700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60a3f4bc0>]}
[0m06:35:27.700453 [info ] [MainThread]: 
[0m06:35:27.700871 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:35:27.701294 [info ] [MainThread]: 
[0m06:35:27.701710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:35:27.705716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:35:27.743869 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:35:27.744228 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:35:27.744416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:27.760451 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m06:35:27.761620 [debug] [ThreadPool]: On list_db: Close
[0m06:35:27.763915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:35:27.774806 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:35:27.775406 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:35:27.775623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:35:27.783271 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m06:35:27.783595 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:35:27.783853 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:35:27.786241 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m06:35:27.788662 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:35:27.789459 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:35:27.793665 [debug] [MainThread]: Using postgres connection "master"
[0m06:35:27.793970 [debug] [MainThread]: On master: BEGIN
[0m06:35:27.794191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:35:27.804140 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m06:35:27.804584 [debug] [MainThread]: Using postgres connection "master"
[0m06:35:27.804879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:35:27.812861 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m06:35:27.814127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca607a797c0>]}
[0m06:35:27.814552 [debug] [MainThread]: On master: ROLLBACK
[0m06:35:27.815068 [debug] [MainThread]: Using postgres connection "master"
[0m06:35:27.815391 [debug] [MainThread]: On master: BEGIN
[0m06:35:27.815976 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:35:27.816241 [debug] [MainThread]: On master: COMMIT
[0m06:35:27.816450 [debug] [MainThread]: Using postgres connection "master"
[0m06:35:27.816644 [debug] [MainThread]: On master: COMMIT
[0m06:35:27.817009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:35:27.817252 [debug] [MainThread]: On master: Close
[0m06:35:27.820212 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:35:27.820653 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:35:27.821005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:35:27.821240 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:35:27.826488 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:35:27.827320 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:35:27.868822 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:35:27.869638 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:35:27.869953 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:35:27.870192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:27.882323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m06:35:27.882838 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:35:27.883131 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:35:27.898600 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m06:35:27.903486 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:35:27.903865 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:35:27.904881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:35:27.907431 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:35:27.907748 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:35:27.908483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:35:27.942444 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:35:27.942895 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:35:27.943206 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:35:27.946708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:35:27.959676 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:35:27.967879 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:35:27.969444 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:35:27.981032 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:35:27.983894 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:35:27.985813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60a7c0860>]}
[0m06:35:27.986426 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.16s]
[0m06:35:27.987000 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:35:27.988059 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:35:27.988589 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:35:27.989162 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:35:27.989884 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:35:27.990616 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:35:27.991298 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:35:27.991761 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:35:27.992245 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:35:27.994858 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:35:27.999938 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:35:27.999009 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:35:28.002659 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:35:28.005229 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:35:28.005783 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:35:28.006202 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:35:28.006664 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:35:28.010522 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:35:28.011974 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:35:28.012475 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:35:28.012825 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:35:28.030886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m06:35:28.031391 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:35:28.031698 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:35:28.034865 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m06:35:28.035875 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:35:28.036230 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:35:28.039752 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:35:28.042101 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:35:28.042402 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:35:28.042864 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:35:28.043339 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:35:28.045197 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:35:28.047064 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:35:28.047551 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:35:28.047943 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:35:28.048663 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:35:28.049888 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:35:28.050252 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:35:28.050608 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:35:28.052874 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:35:28.053280 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:35:28.053684 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:35:28.054521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:35:28.055794 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:35:28.056142 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:35:28.056472 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:35:28.058009 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:35:28.058340 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:35:28.058787 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:35:28.059233 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:35:28.061372 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:35:28.062822 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:35:28.063133 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:35:28.063623 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:35:28.064642 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:35:28.064987 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:35:28.065525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca6048a3800>]}
[0m06:35:28.066357 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.07s]
[0m06:35:28.066949 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:35:28.069994 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:35:28.071102 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:35:28.071573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d40a4a-cb86-4c54-a520-dad5d22aa2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca604869f40>]}
[0m06:35:28.072026 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.08s]
[0m06:35:28.072412 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:35:28.073958 [debug] [MainThread]: Using postgres connection "master"
[0m06:35:28.074211 [debug] [MainThread]: On master: BEGIN
[0m06:35:28.074421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:35:28.079201 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:35:28.079477 [debug] [MainThread]: On master: COMMIT
[0m06:35:28.079683 [debug] [MainThread]: Using postgres connection "master"
[0m06:35:28.079877 [debug] [MainThread]: On master: COMMIT
[0m06:35:28.080221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:35:28.080486 [debug] [MainThread]: On master: Close
[0m06:35:28.080842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:35:28.081059 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:35:28.081243 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:35:28.081416 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:35:28.081697 [info ] [MainThread]: 
[0m06:35:28.081965 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m06:35:28.082650 [debug] [MainThread]: Command end result
[0m06:35:28.097670 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:35:28.099188 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:35:28.104424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:35:28.104773 [info ] [MainThread]: 
[0m06:35:28.105211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:35:28.105747 [info ] [MainThread]: 
[0m06:35:28.106646 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:35:28.107740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9908738, "process_in_blocks": "0", "process_kernel_time": 0.355844, "process_mem_max_rss": "107876", "process_out_blocks": "3392", "process_user_time": 1.701867}
[0m06:35:28.108174 [debug] [MainThread]: Command `dbt run` succeeded at 06:35:28.108085 after 0.99 seconds
[0m06:35:28.108460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca60a6855b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca608a7be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca608a7bf50>]}
[0m06:35:28.108736 [debug] [MainThread]: Flushing usage events
[0m06:35:29.314015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:48:46.180946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a25924aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a256146b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a25926930>]}


============================== 06:48:46.189002 | 825f59a7-d83e-4184-ad86-4053598f950c ==============================
[0m06:48:46.189002 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:48:46.189653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:48:46.469669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a23a57bc0>]}
[0m06:48:46.550802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a26269100>]}
[0m06:48:46.551984 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:48:46.645524 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:48:46.776055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:48:46.776639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:48:46.818312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a252dc410>]}
[0m06:48:46.904688 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:48:46.910925 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:48:46.943626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a237e0b90>]}
[0m06:48:46.944225 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:48:46.944702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a238c9fa0>]}
[0m06:48:46.946500 [info ] [MainThread]: 
[0m06:48:46.946988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:48:46.947343 [info ] [MainThread]: 
[0m06:48:46.947900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:48:46.953226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:48:47.019620 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:48:47.020153 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:48:47.020544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:48:47.037566 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:48:47.041133 [debug] [ThreadPool]: On list_db: Close
[0m06:48:47.045288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:48:47.051418 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:48:47.051846 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:48:47.052103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:48:47.064765 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:48:47.065338 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:48:47.065669 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:48:47.075527 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:48:47.077687 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:48:47.078811 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:48:47.086575 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:47.087058 [debug] [MainThread]: On master: BEGIN
[0m06:48:47.087335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:48:47.101630 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:48:47.102610 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:47.103109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:48:47.107881 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:48:47.109744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a2713c440>]}
[0m06:48:47.110504 [debug] [MainThread]: On master: ROLLBACK
[0m06:48:47.111327 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:47.111683 [debug] [MainThread]: On master: BEGIN
[0m06:48:47.112792 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:48:47.113967 [debug] [MainThread]: On master: COMMIT
[0m06:48:47.114897 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:47.115778 [debug] [MainThread]: On master: COMMIT
[0m06:48:47.116844 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:48:47.117217 [debug] [MainThread]: On master: Close
[0m06:48:47.124254 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:48:47.125086 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:48:47.125695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:48:47.126096 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:48:47.135246 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:48:47.136234 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:48:47.199266 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:48:47.201349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:48:47.202416 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:48:47.204239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:48:47.213572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m06:48:47.214158 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:48:47.214552 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:48:47.244063 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m06:48:47.251796 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:48:47.252591 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:48:47.254350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:48:47.258719 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:48:47.259347 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:48:47.260528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:48:47.288162 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:48:47.288746 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:48:47.289105 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:48:47.297941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:48:47.307279 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:48:47.315068 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:48:47.316417 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:48:47.326344 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:48:47.329391 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:48:47.331234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a2728a4e0>]}
[0m06:48:47.332178 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m06:48:47.333144 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:48:47.334548 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:48:47.335374 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:48:47.335997 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:48:47.336372 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:48:47.339407 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:48:47.340141 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:48:47.344128 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:48:47.346013 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:48:47.346865 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:48:47.351216 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:48:47.352391 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:48:47.355665 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:48:47.356630 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:48:47.357061 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:48:47.357456 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:48:47.357977 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:48:47.362071 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:48:47.362735 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:48:47.363087 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:48:47.363405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:48:47.369684 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m06:48:47.370908 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:48:47.371653 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:48:47.378804 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m06:48:47.379268 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:48:47.379618 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:48:47.391246 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m06:48:47.396240 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:48:47.396917 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m06:48:47.397418 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:48:47.400839 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:48:47.401689 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:48:47.402409 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:48:47.407102 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:48:47.407647 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:48:47.408048 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:48:47.412018 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:48:47.413039 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:48:47.413619 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:48:47.416035 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:48:47.416606 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:48:47.417023 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:48:47.418612 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:48:47.419092 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:48:47.419579 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:48:47.420075 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:48:47.430218 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m06:48:47.432970 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:48:47.433642 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:48:47.434071 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:48:47.434466 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m06:48:47.436902 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:48:47.437521 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:48:47.437832 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:48:47.438242 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:48:47.439813 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:48:47.440671 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a200abf50>]}
[0m06:48:47.441420 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.10s]
[0m06:48:47.442680 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:48:47.443132 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m06:48:47.445997 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:48:47.446787 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825f59a7-d83e-4184-ad86-4053598f950c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a22a5b5f0>]}
[0m06:48:47.447634 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m06:48:47.449166 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:48:47.451337 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:47.451696 [debug] [MainThread]: On master: BEGIN
[0m06:48:47.451983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:48:47.458936 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:48:47.459408 [debug] [MainThread]: On master: COMMIT
[0m06:48:47.459855 [debug] [MainThread]: Using postgres connection "master"
[0m06:48:47.460167 [debug] [MainThread]: On master: COMMIT
[0m06:48:47.460736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:48:47.461177 [debug] [MainThread]: On master: Close
[0m06:48:47.461673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:48:47.461956 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:48:47.462205 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:48:47.462474 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:48:47.463004 [info ] [MainThread]: 
[0m06:48:47.463414 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m06:48:47.465022 [debug] [MainThread]: Command end result
[0m06:48:47.488571 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:48:47.490684 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:48:47.497268 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:48:47.497648 [info ] [MainThread]: 
[0m06:48:47.498351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:48:47.498929 [info ] [MainThread]: 
[0m06:48:47.499558 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:48:47.501015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4005548, "process_in_blocks": "256", "process_kernel_time": 0.551436, "process_mem_max_rss": "107936", "process_out_blocks": "3392", "process_user_time": 2.51253}
[0m06:48:47.501575 [debug] [MainThread]: Command `dbt run` succeeded at 06:48:47.501457 after 1.40 seconds
[0m06:48:47.501972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a25598e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a25b06ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a28ada8a0>]}
[0m06:48:47.502378 [debug] [MainThread]: Flushing usage events
[0m06:48:48.542749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:49:27.080562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370e5aef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370ebde300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370e5d4500>]}


============================== 06:49:27.087814 | b26d58a9-f9f3-49b2-b3d4-61994a436457 ==============================
[0m06:49:27.087814 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:49:27.088800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:49:27.308034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370ff675c0>]}
[0m06:49:27.359089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370fe0c320>]}
[0m06:49:27.359856 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:49:27.451412 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:49:27.548853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:49:27.549214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:49:27.578901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370c7a48f0>]}
[0m06:49:27.662308 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:49:27.664347 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:49:27.684073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370c484770>]}
[0m06:49:27.684790 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:49:27.685105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370c49fe30>]}
[0m06:49:27.688042 [info ] [MainThread]: 
[0m06:49:27.688758 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:49:27.689257 [info ] [MainThread]: 
[0m06:49:27.689893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:49:27.693169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:49:27.756983 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:49:27.757697 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:49:27.758080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:49:27.769668 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m06:49:27.770932 [debug] [ThreadPool]: On list_db: Close
[0m06:49:27.772359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:49:27.777676 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:49:27.777953 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:49:27.778166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:49:27.790010 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:49:27.790378 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:49:27.790569 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:49:27.795036 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:49:27.796203 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:49:27.796709 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:49:27.803372 [debug] [MainThread]: Using postgres connection "master"
[0m06:49:27.803698 [debug] [MainThread]: On master: BEGIN
[0m06:49:27.803914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:49:27.809346 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:49:27.809685 [debug] [MainThread]: Using postgres connection "master"
[0m06:49:27.810047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:49:27.814737 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:49:27.815855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370c7a6150>]}
[0m06:49:27.816283 [debug] [MainThread]: On master: ROLLBACK
[0m06:49:27.816803 [debug] [MainThread]: Using postgres connection "master"
[0m06:49:27.817040 [debug] [MainThread]: On master: BEGIN
[0m06:49:27.834704 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m06:49:27.835118 [debug] [MainThread]: On master: COMMIT
[0m06:49:27.835346 [debug] [MainThread]: Using postgres connection "master"
[0m06:49:27.835526 [debug] [MainThread]: On master: COMMIT
[0m06:49:27.836010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:49:27.836274 [debug] [MainThread]: On master: Close
[0m06:49:27.851682 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:49:27.852431 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:49:27.852932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:49:27.853185 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:49:27.860006 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:49:27.860984 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:49:27.898984 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:49:27.899950 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:49:27.900225 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:49:27.900602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:49:27.907365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:49:27.907750 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:49:27.907984 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:49:27.922477 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m06:49:27.927583 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:49:27.927896 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:49:27.928582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:49:27.936272 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:49:27.936723 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:49:27.937481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:49:27.958269 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:49:27.958814 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:49:27.959086 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:49:27.964471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:49:27.973351 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:49:27.981881 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:49:27.982722 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:49:27.991938 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:49:27.995066 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:49:27.997268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370ff66750>]}
[0m06:49:27.998213 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.14s]
[0m06:49:27.998887 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:49:28.001808 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:49:28.002430 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:49:28.003154 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:49:28.003942 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:49:28.004633 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:49:28.005308 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:49:28.005798 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:49:28.006230 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:49:28.009852 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:49:28.012403 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:49:28.013314 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:49:28.013640 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:49:28.016527 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:49:28.018805 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:49:28.019489 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:49:28.019832 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:49:28.020131 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:49:28.020554 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:49:28.020919 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:49:28.021240 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:49:28.027810 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m06:49:28.028228 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:49:28.028570 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:49:28.028911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m06:49:28.029290 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:49:28.029548 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:49:28.048552 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m06:49:28.049177 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m06:49:28.052449 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:49:28.055751 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:49:28.056315 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:49:28.056804 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:49:28.057821 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:49:28.062558 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:49:28.065670 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:49:28.069358 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:49:28.069869 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:49:28.070290 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:49:28.071258 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:49:28.071623 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:49:28.073224 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:49:28.074703 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:49:28.075111 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:49:28.075582 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:49:28.076008 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:49:28.076473 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:49:28.080760 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m06:49:28.081231 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m06:49:28.083267 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:49:28.085719 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:49:28.087590 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:49:28.088278 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:49:28.088792 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:49:28.089295 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:49:28.093972 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:49:28.095766 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:49:28.096176 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:49:28.097498 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:49:28.098037 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370b6d4a40>]}
[0m06:49:28.099210 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b26d58a9-f9f3-49b2-b3d4-61994a436457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370b818170>]}
[0m06:49:28.098764 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m06:49:28.099802 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m06:49:28.100631 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:49:28.101088 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:49:28.104106 [debug] [MainThread]: Using postgres connection "master"
[0m06:49:28.104470 [debug] [MainThread]: On master: BEGIN
[0m06:49:28.104701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:49:28.110240 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:49:28.110606 [debug] [MainThread]: On master: COMMIT
[0m06:49:28.110851 [debug] [MainThread]: Using postgres connection "master"
[0m06:49:28.111079 [debug] [MainThread]: On master: COMMIT
[0m06:49:28.111447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:49:28.111752 [debug] [MainThread]: On master: Close
[0m06:49:28.112142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:49:28.112432 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:49:28.112646 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:49:28.112831 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:49:28.113121 [info ] [MainThread]: 
[0m06:49:28.113401 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m06:49:28.114096 [debug] [MainThread]: Command end result
[0m06:49:28.129830 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:49:28.131507 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:49:28.136444 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:49:28.136721 [info ] [MainThread]: 
[0m06:49:28.137531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:49:28.137844 [info ] [MainThread]: 
[0m06:49:28.138149 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:49:28.139010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1115234, "process_in_blocks": "0", "process_kernel_time": 0.429783, "process_mem_max_rss": "107820", "process_out_blocks": "3392", "process_user_time": 1.914491}
[0m06:49:28.139467 [debug] [MainThread]: Command `dbt run` succeeded at 06:49:28.139359 after 1.11 seconds
[0m06:49:28.139775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370ebde300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370eb78740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77370eb790d0>]}
[0m06:49:28.140092 [debug] [MainThread]: Flushing usage events
[0m06:49:29.380148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:51:27.359647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b5119dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b515fae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b510a2030>]}


============================== 06:51:27.365455 | b37ee680-ef2a-404c-b82e-d826e201da02 ==============================
[0m06:51:27.365455 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:51:27.366761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:51:27.639546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b50a3b440>]}
[0m06:51:27.699113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b529ff2f0>]}
[0m06:51:27.699922 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:51:27.755168 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:51:27.845161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:51:27.845549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:51:27.873412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b4f288e00>]}
[0m06:51:27.941282 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:51:27.943193 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:51:27.967125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b4ef607a0>]}
[0m06:51:27.967713 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:51:27.968108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b4ef5eae0>]}
[0m06:51:27.969707 [info ] [MainThread]: 
[0m06:51:27.970059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:51:27.971143 [info ] [MainThread]: 
[0m06:51:27.972070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:51:27.976039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:51:28.014294 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:51:28.014929 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:51:28.015178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:28.026173 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m06:51:28.027388 [debug] [ThreadPool]: On list_db: Close
[0m06:51:28.030755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:51:28.035094 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:51:28.035467 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:51:28.036117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:51:28.045862 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m06:51:28.046257 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:51:28.047497 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:51:28.054405 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m06:51:28.055645 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:51:28.056764 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:51:28.066378 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:28.067129 [debug] [MainThread]: On master: BEGIN
[0m06:51:28.067817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:51:28.084617 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m06:51:28.085083 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:28.085387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:51:28.098184 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m06:51:28.099647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b4efc7410>]}
[0m06:51:28.100203 [debug] [MainThread]: On master: ROLLBACK
[0m06:51:28.100878 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:28.101180 [debug] [MainThread]: On master: BEGIN
[0m06:51:28.102055 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:51:28.102335 [debug] [MainThread]: On master: COMMIT
[0m06:51:28.102558 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:28.102771 [debug] [MainThread]: On master: COMMIT
[0m06:51:28.103237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:51:28.103505 [debug] [MainThread]: On master: Close
[0m06:51:28.106652 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:51:28.107314 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:51:28.107788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:51:28.108135 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:51:28.119129 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:51:28.119904 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:51:28.178826 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:51:28.179757 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:28.180188 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:51:28.180457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:51:28.187302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:51:28.187891 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:28.188393 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:51:28.204764 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m06:51:28.210701 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:28.211169 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:51:28.212200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:28.217003 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:28.219599 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:51:28.220993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:28.249189 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:51:28.249713 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:28.250041 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:51:28.253790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:51:28.261710 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:51:28.265849 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:51:28.266168 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:51:28.269229 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:51:28.271058 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:51:28.272363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b515da4b0>]}
[0m06:51:28.272866 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.16s]
[0m06:51:28.273331 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:51:28.274374 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:51:28.274735 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:51:28.275257 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:51:28.275707 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:51:28.276226 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:51:28.276611 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:51:28.276926 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:51:28.277227 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:51:28.279360 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:51:28.281392 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:51:28.282023 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:51:28.282279 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:51:28.284324 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:51:28.286247 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:51:28.286933 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:28.287211 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:28.287501 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:51:28.287778 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:51:28.288082 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:51:28.288436 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:51:28.293886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:51:28.294304 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:28.294628 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:51:28.295368 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m06:51:28.295657 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:28.295899 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:51:28.301796 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:51:28.304471 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:28.304785 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:51:28.305483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:28.308465 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:28.308819 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m06:51:28.309502 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:51:28.312237 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:28.312766 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:51:28.313109 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:28.314307 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:51:28.314592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:28.314878 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:28.316975 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:28.317319 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:51:28.317613 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:51:28.318376 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:28.319536 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:51:28.319831 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:28.320135 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:51:28.320426 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:51:28.322070 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:51:28.322504 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:51:28.322782 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:51:28.323037 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:51:28.324873 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:51:28.325773 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:51:28.326105 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:51:28.328693 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:51:28.329816 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:51:28.330367 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b4e1213a0>]}
[0m06:51:28.330723 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m06:51:28.331461 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.05s]
[0m06:51:28.332987 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:51:28.333523 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:51:28.334224 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b37ee680-ef2a-404c-b82e-d826e201da02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b36f1c290>]}
[0m06:51:28.334825 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m06:51:28.335238 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:51:28.336971 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:28.337308 [debug] [MainThread]: On master: BEGIN
[0m06:51:28.337575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:51:28.344492 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:51:28.345019 [debug] [MainThread]: On master: COMMIT
[0m06:51:28.345362 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:28.345657 [debug] [MainThread]: On master: COMMIT
[0m06:51:28.346183 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:51:28.346539 [debug] [MainThread]: On master: Close
[0m06:51:28.347014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:51:28.347279 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:51:28.347512 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:51:28.347755 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:51:28.348174 [info ] [MainThread]: 
[0m06:51:28.348498 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m06:51:28.349350 [debug] [MainThread]: Command end result
[0m06:51:28.366809 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:51:28.368697 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:51:28.375014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:51:28.375347 [info ] [MainThread]: 
[0m06:51:28.375699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:51:28.375970 [info ] [MainThread]: 
[0m06:51:28.376370 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:51:28.378745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0611846, "process_in_blocks": "0", "process_kernel_time": 0.363988, "process_mem_max_rss": "107608", "process_out_blocks": "3392", "process_user_time": 1.90996}
[0m06:51:28.379405 [debug] [MainThread]: Command `dbt run` succeeded at 06:51:28.379281 after 1.06 seconds
[0m06:51:28.379914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b51684fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b4f28a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9b4f2881a0>]}
[0m06:51:28.380374 [debug] [MainThread]: Flushing usage events
[0m06:51:29.705925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:52:27.372720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f43c9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f43c8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f43cb1a0>]}


============================== 06:52:27.381260 | 2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b ==============================
[0m06:52:27.381260 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:52:27.381883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:52:27.593386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f37b27e0>]}
[0m06:52:27.651331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f40473b0>]}
[0m06:52:27.652714 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:52:27.706538 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:52:27.801091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:52:27.801506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:52:27.832203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f1ed88f0>]}
[0m06:52:27.909804 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:52:27.911951 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:52:27.936113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f1c337d0>]}
[0m06:52:27.936592 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:52:27.936897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f4a65400>]}
[0m06:52:27.938670 [info ] [MainThread]: 
[0m06:52:27.939157 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:52:27.939459 [info ] [MainThread]: 
[0m06:52:27.940029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:52:27.943607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:52:27.983639 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:52:27.984012 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:52:27.984247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:52:27.995673 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m06:52:27.998255 [debug] [ThreadPool]: On list_db: Close
[0m06:52:28.000549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:52:28.004684 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:52:28.004975 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:52:28.005176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:52:28.014116 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m06:52:28.015414 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:52:28.015961 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:52:28.018943 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m06:52:28.020586 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:52:28.021214 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:52:28.028301 [debug] [MainThread]: Using postgres connection "master"
[0m06:52:28.028871 [debug] [MainThread]: On master: BEGIN
[0m06:52:28.029206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:52:28.037692 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:52:28.038127 [debug] [MainThread]: Using postgres connection "master"
[0m06:52:28.038479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:52:28.042224 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:52:28.044276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f1e9ccb0>]}
[0m06:52:28.045097 [debug] [MainThread]: On master: ROLLBACK
[0m06:52:28.045744 [debug] [MainThread]: Using postgres connection "master"
[0m06:52:28.046012 [debug] [MainThread]: On master: BEGIN
[0m06:52:28.049478 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:52:28.049918 [debug] [MainThread]: On master: COMMIT
[0m06:52:28.050431 [debug] [MainThread]: Using postgres connection "master"
[0m06:52:28.050715 [debug] [MainThread]: On master: COMMIT
[0m06:52:28.052104 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:52:28.052419 [debug] [MainThread]: On master: Close
[0m06:52:28.059867 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:52:28.060551 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:52:28.061014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:52:28.061285 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:52:28.066467 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:52:28.067035 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:52:28.098640 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:52:28.099484 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:52:28.099788 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:52:28.100023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:52:28.106140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:52:28.106508 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:52:28.106784 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:52:28.118676 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:52:28.123848 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:52:28.124225 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:52:28.125177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:52:28.127565 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:52:28.127877 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:52:28.128620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:52:28.145707 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:52:28.146134 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:52:28.146369 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:52:28.165840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m06:52:28.175634 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:52:28.188931 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:52:28.189793 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:52:28.231395 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m06:52:28.236518 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:52:28.239711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f4206360>]}
[0m06:52:28.240905 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m06:52:28.241914 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:52:28.243982 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:52:28.244968 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:52:28.245996 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:52:28.247011 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:52:28.248067 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:52:28.248906 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:52:28.249665 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:52:28.250405 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:52:28.254358 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:52:28.258642 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:52:28.260299 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:52:28.263904 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:52:28.264700 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:52:28.267329 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:52:28.268433 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:52:28.268985 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:52:28.269334 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:52:28.269731 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:52:28.270261 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:52:28.271131 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:52:28.279192 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m06:52:28.279847 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:52:28.280136 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:52:28.280591 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m06:52:28.281017 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:52:28.281383 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:52:28.289026 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:52:28.291940 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:52:28.292307 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:52:28.293020 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:52:28.294961 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:52:28.295282 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m06:52:28.295565 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:52:28.297509 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:52:28.298002 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m06:52:28.298302 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:52:28.299556 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:52:28.299830 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:52:28.300052 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:52:28.300412 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:52:28.305078 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:52:28.305497 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:52:28.305962 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m06:52:28.306319 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:52:28.308026 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:52:28.309251 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:52:28.309781 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:52:28.310113 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:52:28.310857 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:52:28.310555 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:52:28.314378 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:52:28.317482 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:52:28.317865 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:52:28.318401 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:52:28.319621 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:52:28.320579 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f0d4de80>]}
[0m06:52:28.321059 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m06:52:28.321478 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:52:28.319934 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:52:28.327208 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m06:52:28.328822 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:52:28.329372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2313cfe7-b8e1-42a3-8e6e-5ddf41a9036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f0467fb0>]}
[0m06:52:28.329884 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m06:52:28.330303 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:52:28.331848 [debug] [MainThread]: Using postgres connection "master"
[0m06:52:28.332101 [debug] [MainThread]: On master: BEGIN
[0m06:52:28.332305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:52:28.337378 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:52:28.337687 [debug] [MainThread]: On master: COMMIT
[0m06:52:28.337898 [debug] [MainThread]: Using postgres connection "master"
[0m06:52:28.338097 [debug] [MainThread]: On master: COMMIT
[0m06:52:28.338492 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:52:28.338835 [debug] [MainThread]: On master: Close
[0m06:52:28.339240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:52:28.339452 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:52:28.339630 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:52:28.339802 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:52:28.340083 [info ] [MainThread]: 
[0m06:52:28.340436 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m06:52:28.341232 [debug] [MainThread]: Command end result
[0m06:52:28.359175 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:52:28.360775 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:52:28.366721 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:52:28.367231 [info ] [MainThread]: 
[0m06:52:28.367711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:52:28.368610 [info ] [MainThread]: 
[0m06:52:28.370462 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:52:28.371906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.046313, "process_in_blocks": "0", "process_kernel_time": 0.313373, "process_mem_max_rss": "107884", "process_out_blocks": "3392", "process_user_time": 1.974252}
[0m06:52:28.372781 [debug] [MainThread]: Command `dbt run` succeeded at 06:52:28.372671 after 1.05 seconds
[0m06:52:28.373076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f43c9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f43cb1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a1f40ffa70>]}
[0m06:52:28.373331 [debug] [MainThread]: Flushing usage events
[0m06:52:29.671253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:01:38.030620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a02e915b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a03b7c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a03b7ee70>]}


============================== 07:01:38.042205 | 53a4eb7d-a378-4166-b96e-a2fba8673d1c ==============================
[0m07:01:38.042205 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:01:38.042792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:01:38.324527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a03433ad0>]}
[0m07:01:38.423955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a015b35c0>]}
[0m07:01:38.425268 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:01:38.542709 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:01:38.669742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:01:38.671367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:01:38.717208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a015cc950>]}
[0m07:01:38.814584 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:01:38.817597 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:01:38.849730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a01608bc0>]}
[0m07:01:38.850320 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:01:38.850724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a012968a0>]}
[0m07:01:38.852553 [info ] [MainThread]: 
[0m07:01:38.852984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:01:38.853306 [info ] [MainThread]: 
[0m07:01:38.853892 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:01:38.858350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:01:38.911375 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:01:38.912001 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:01:38.914394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:38.924978 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m07:01:38.926509 [debug] [ThreadPool]: On list_db: Close
[0m07:01:38.928734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:01:38.934407 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:01:38.934812 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:01:38.935122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:01:38.942948 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:01:38.943522 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:01:38.943993 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:01:38.947781 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:01:38.949455 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:01:38.950117 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:01:38.958094 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:38.958486 [debug] [MainThread]: On master: BEGIN
[0m07:01:38.958750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:01:38.965634 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:01:38.967915 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:38.968396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:01:38.972589 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:01:38.974586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a012aa870>]}
[0m07:01:38.975266 [debug] [MainThread]: On master: ROLLBACK
[0m07:01:38.975890 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:38.976249 [debug] [MainThread]: On master: BEGIN
[0m07:01:38.977035 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:01:38.977391 [debug] [MainThread]: On master: COMMIT
[0m07:01:38.977762 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:38.978026 [debug] [MainThread]: On master: COMMIT
[0m07:01:38.978770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:01:38.979167 [debug] [MainThread]: On master: Close
[0m07:01:38.985587 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:01:38.986273 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:01:38.986819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:01:38.987163 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:01:38.995096 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:01:38.996018 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:01:39.035559 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:01:39.036703 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:39.037134 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:01:39.037478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:01:39.046974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:01:39.047581 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:39.048078 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:01:39.061704 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m07:01:39.069349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:39.069900 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:01:39.071342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:39.090434 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:01:39.091310 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:39.091702 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:01:39.097877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:01:39.105390 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:01:39.115520 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:39.115986 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:01:39.117235 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:01:39.120209 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:01:39.122623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a04d8e480>]}
[0m07:01:39.123303 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m07:01:39.123912 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:01:39.125693 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:01:39.126902 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:01:39.127819 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:01:39.128584 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:01:39.129371 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:01:39.130332 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:01:39.131091 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:01:39.131593 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:01:39.136933 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:01:39.142012 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:01:39.143193 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:01:39.146124 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:01:39.147085 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:01:39.150386 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:01:39.150972 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:01:39.152208 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:01:39.152766 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:01:39.153246 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:01:39.153791 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:01:39.154644 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:01:39.165777 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m07:01:39.166461 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:01:39.166938 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:01:39.167814 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m07:01:39.168457 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:01:39.169089 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:01:39.177642 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:01:39.181735 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:01:39.182372 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:01:39.183117 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:01:39.184721 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:01:39.185130 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m07:01:39.185704 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:01:39.188408 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:01:39.189002 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:01:39.189448 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:01:39.191004 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:39.192516 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:01:39.192883 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:01:39.193169 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:01:39.195696 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m07:01:39.198123 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:01:39.198547 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:01:39.199169 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:01:39.201266 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:01:39.201820 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:01:39.202522 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:01:39.203324 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:01:39.203739 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:01:39.205302 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:01:39.205767 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:01:39.207173 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:01:39.208919 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a0053f0b0>]}
[0m07:01:39.210027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a4eb7d-a378-4166-b96e-a2fba8673d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a0065f740>]}
[0m07:01:39.211411 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.08s]
[0m07:01:39.212292 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m07:01:39.213635 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:01:39.214308 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:01:39.217342 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:39.217806 [debug] [MainThread]: On master: BEGIN
[0m07:01:39.218112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:01:39.227714 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:01:39.228342 [debug] [MainThread]: On master: COMMIT
[0m07:01:39.228713 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:39.229008 [debug] [MainThread]: On master: COMMIT
[0m07:01:39.229859 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:01:39.230463 [debug] [MainThread]: On master: Close
[0m07:01:39.231109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:01:39.231442 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:01:39.231704 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:01:39.231954 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:01:39.232434 [info ] [MainThread]: 
[0m07:01:39.232828 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m07:01:39.233926 [debug] [MainThread]: Command end result
[0m07:01:39.260050 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:01:39.264095 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:01:39.270841 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:01:39.271228 [info ] [MainThread]: 
[0m07:01:39.271645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:01:39.272003 [info ] [MainThread]: 
[0m07:01:39.272468 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:01:39.274716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3127539, "process_in_blocks": "256", "process_kernel_time": 0.495737, "process_mem_max_rss": "107724", "process_out_blocks": "3400", "process_user_time": 2.34885}
[0m07:01:39.275355 [debug] [MainThread]: Command `dbt run` succeeded at 07:01:39.275228 after 1.31 seconds
[0m07:01:39.275957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a03770c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a015584d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a033d29c0>]}
[0m07:01:39.276467 [debug] [MainThread]: Flushing usage events
[0m07:01:40.426097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:02:18.493737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c4533a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c455cb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c452db1a0>]}


============================== 07:02:18.500773 | 0635edc1-ad56-4aaa-8f26-851e53a4a7b7 ==============================
[0m07:02:18.500773 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:02:18.502081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:02:18.707650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c44e22b10>]}
[0m07:02:18.775922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c45c814f0>]}
[0m07:02:18.776665 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:02:18.826546 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:02:18.955177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:02:18.955564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:02:18.987731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c44d1abd0>]}
[0m07:02:19.044784 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:02:19.046656 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:02:19.066410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c43450cb0>]}
[0m07:02:19.066818 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:02:19.067093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c460c79e0>]}
[0m07:02:19.068341 [info ] [MainThread]: 
[0m07:02:19.068625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:02:19.068795 [info ] [MainThread]: 
[0m07:02:19.069119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:02:19.073351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:02:19.109174 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:02:19.109616 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:02:19.110535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:19.120067 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m07:02:19.121267 [debug] [ThreadPool]: On list_db: Close
[0m07:02:19.122776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:02:19.126844 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:02:19.127150 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:02:19.127350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:02:19.133403 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:02:19.133829 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:02:19.134134 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:02:19.136238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:02:19.137258 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:02:19.137723 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:02:19.142576 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:19.142924 [debug] [MainThread]: On master: BEGIN
[0m07:02:19.143124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:02:19.149027 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:02:19.149740 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:19.150399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:02:19.153965 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:02:19.156243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c44d3b680>]}
[0m07:02:19.156940 [debug] [MainThread]: On master: ROLLBACK
[0m07:02:19.157551 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:19.157790 [debug] [MainThread]: On master: BEGIN
[0m07:02:19.158694 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:02:19.159191 [debug] [MainThread]: On master: COMMIT
[0m07:02:19.159515 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:19.159716 [debug] [MainThread]: On master: COMMIT
[0m07:02:19.160147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:02:19.160402 [debug] [MainThread]: On master: Close
[0m07:02:19.163512 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:02:19.164363 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:02:19.165143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:02:19.165750 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:02:19.175032 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:02:19.176018 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:02:19.202934 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:02:19.203529 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:02:19.203782 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:02:19.204002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:19.210907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:02:19.211631 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:02:19.212235 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:02:19.221512 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m07:02:19.226197 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:02:19.226548 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:02:19.227264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:02:19.229455 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:02:19.229884 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:02:19.230725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:02:19.247353 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:02:19.247679 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:02:19.247877 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:02:19.251745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:02:19.256737 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:02:19.260665 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:02:19.260923 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:02:19.264681 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:02:19.267237 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:02:19.269080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c45639670>]}
[0m07:02:19.269820 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.10s]
[0m07:02:19.270429 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:02:19.271588 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:02:19.271975 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:02:19.272447 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:02:19.273486 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:02:19.272960 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:02:19.274216 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:02:19.273725 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:02:19.274412 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:02:19.277171 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:02:19.279073 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:02:19.279684 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:02:19.281637 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:02:19.282057 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:02:19.282541 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:02:19.284796 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:02:19.285017 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:02:19.284487 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:02:19.285638 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:02:19.285917 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:02:19.286126 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:02:19.290966 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m07:02:19.291252 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:02:19.291449 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:02:19.292734 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m07:02:19.292984 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:02:19.293203 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:02:19.301337 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:02:19.303969 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:02:19.304268 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:02:19.304781 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:02:19.306755 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:02:19.307050 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:02:19.307606 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:02:19.308943 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:02:19.309274 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:02:19.309591 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m07:02:19.309847 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:02:19.311683 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:02:19.312620 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:02:19.313343 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:02:19.315260 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:02:19.315989 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:02:19.316522 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:02:19.317728 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:02:19.318024 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m07:02:19.318290 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:02:19.320228 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:02:19.320867 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:02:19.321357 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:02:19.321793 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:02:19.323775 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m07:02:19.325768 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:02:19.326110 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:02:19.326552 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:02:19.327767 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:02:19.328135 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:02:19.328778 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c40280f20>]}
[0m07:02:19.329526 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m07:02:19.329927 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:02:19.333619 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:02:19.334666 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:02:19.335111 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0635edc1-ad56-4aaa-8f26-851e53a4a7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c42381f70>]}
[0m07:02:19.335528 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m07:02:19.335895 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:02:19.338155 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:19.338423 [debug] [MainThread]: On master: BEGIN
[0m07:02:19.338623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:02:19.343131 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:02:19.343400 [debug] [MainThread]: On master: COMMIT
[0m07:02:19.343603 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:19.343784 [debug] [MainThread]: On master: COMMIT
[0m07:02:19.344139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:02:19.344353 [debug] [MainThread]: On master: Close
[0m07:02:19.344669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:02:19.344886 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:02:19.345036 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:02:19.345169 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:02:19.345391 [info ] [MainThread]: 
[0m07:02:19.345686 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m07:02:19.346359 [debug] [MainThread]: Command end result
[0m07:02:19.363360 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:02:19.364851 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:02:19.370056 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:02:19.370417 [info ] [MainThread]: 
[0m07:02:19.372950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:02:19.373842 [info ] [MainThread]: 
[0m07:02:19.374419 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:02:19.375581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9209765, "process_in_blocks": "256", "process_kernel_time": 0.308768, "process_mem_max_rss": "107700", "process_out_blocks": "3392", "process_user_time": 1.714061}
[0m07:02:19.375984 [debug] [MainThread]: Command `dbt run` succeeded at 07:02:19.375905 after 0.92 seconds
[0m07:02:19.376258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c44f69370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c44fa5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2c45a37cb0>]}
[0m07:02:19.376523 [debug] [MainThread]: Flushing usage events
[0m07:02:20.567974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:05:32.699066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ad343920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00aca7ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ae7a7ef0>]}


============================== 07:05:32.706349 | 9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0 ==============================
[0m07:05:32.706349 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:05:32.750623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:05:32.980532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ad456990>]}
[0m07:05:33.048527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ad1c7b30>]}
[0m07:05:33.050204 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:05:33.106606 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:05:33.200622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:05:33.201165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:05:33.246973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00aaffd4f0>]}
[0m07:05:33.332451 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:05:33.339234 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:05:33.385033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00acf321e0>]}
[0m07:05:33.385612 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:05:33.386015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00aacc67e0>]}
[0m07:05:33.388429 [info ] [MainThread]: 
[0m07:05:33.389873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:05:33.390238 [info ] [MainThread]: 
[0m07:05:33.392153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:05:33.400595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:05:33.452000 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:05:33.452699 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:05:33.453030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:33.465935 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m07:05:33.467426 [debug] [ThreadPool]: On list_db: Close
[0m07:05:33.470045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:05:33.475655 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:05:33.476107 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:05:33.476360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:05:33.482915 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:05:33.483995 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:05:33.484363 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:05:33.488082 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:05:33.489585 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:05:33.490291 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:05:33.497361 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:33.497787 [debug] [MainThread]: On master: BEGIN
[0m07:05:33.498090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:05:33.504950 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:05:33.506047 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:33.506641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:05:33.510883 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:05:33.513017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00aad13fe0>]}
[0m07:05:33.513587 [debug] [MainThread]: On master: ROLLBACK
[0m07:05:33.514157 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:33.514484 [debug] [MainThread]: On master: BEGIN
[0m07:05:33.515143 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:05:33.515491 [debug] [MainThread]: On master: COMMIT
[0m07:05:33.515775 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:33.516072 [debug] [MainThread]: On master: COMMIT
[0m07:05:33.516589 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:05:33.516910 [debug] [MainThread]: On master: Close
[0m07:05:33.524258 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:05:33.525114 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:05:33.525991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:05:33.527926 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:05:33.536641 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:05:33.537374 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:05:33.577985 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:05:33.579464 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:05:33.580266 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:05:33.580767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:33.589807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:05:33.590775 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:05:33.591124 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:05:33.708958 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.117 seconds
[0m07:05:33.716776 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:05:33.717237 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:05:33.719332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:05:33.727570 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:05:33.728077 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:05:33.729063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:05:33.766005 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:05:33.766734 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:05:33.767086 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:05:33.771861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:05:33.786419 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:05:33.803110 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:05:33.803642 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:05:33.810497 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:05:33.814504 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:05:33.818224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ad342270>]}
[0m07:05:33.818985 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.29s]
[0m07:05:33.819609 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:05:33.821909 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:05:33.822449 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:05:33.823261 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:05:33.823596 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:05:33.824059 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:05:33.827094 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:05:33.827972 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:05:33.828962 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:05:33.829331 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:05:33.834405 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:05:33.835896 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:05:33.839326 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:05:33.840140 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:05:33.840677 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:05:33.841240 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:05:33.844491 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:05:33.845165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:05:33.846020 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:05:33.846955 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:05:33.847290 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:05:33.855470 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m07:05:33.856036 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:05:33.856396 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:05:33.860265 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m07:05:33.861018 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:05:33.861406 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:05:33.869298 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m07:05:33.873318 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:05:33.873781 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:05:33.874673 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:05:33.880139 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:05:33.880970 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m07:05:33.881428 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:05:33.885184 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:05:33.886042 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:05:33.886850 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:05:33.888775 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:05:33.889246 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:05:33.889718 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:05:33.892833 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:05:33.893363 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:05:33.894069 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:05:33.895762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:05:33.898018 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:05:33.898673 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:05:33.899150 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m07:05:33.900862 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:05:33.903947 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:05:33.905148 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:05:33.905521 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:05:33.907696 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m07:05:33.910512 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:05:33.911213 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:05:33.911696 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:05:33.912473 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:05:33.914072 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:05:33.915557 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a857bef0>]}
[0m07:05:33.916955 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:05:33.916446 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m07:05:33.918687 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:05:33.919310 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:05:33.920138 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaf3eb7-c6cb-4a0d-b932-eb0034ac78d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a9e75910>]}
[0m07:05:33.921192 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.10s]
[0m07:05:33.921763 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:05:33.924150 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:33.924528 [debug] [MainThread]: On master: BEGIN
[0m07:05:33.924826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:05:33.934324 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:05:33.934829 [debug] [MainThread]: On master: COMMIT
[0m07:05:33.935122 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:33.935403 [debug] [MainThread]: On master: COMMIT
[0m07:05:33.936012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:05:33.936385 [debug] [MainThread]: On master: Close
[0m07:05:33.936909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:33.937199 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:05:33.937555 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:05:33.937852 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:05:33.938291 [info ] [MainThread]: 
[0m07:05:33.938963 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m07:05:33.940459 [debug] [MainThread]: Command end result
[0m07:05:33.971416 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:05:33.973268 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:05:33.980969 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:05:33.981477 [info ] [MainThread]: 
[0m07:05:33.982007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:05:33.982679 [info ] [MainThread]: 
[0m07:05:33.983993 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:05:33.985180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3347533, "process_in_blocks": "0", "process_kernel_time": 0.411031, "process_mem_max_rss": "107832", "process_out_blocks": "3392", "process_user_time": 2.201129}
[0m07:05:33.985718 [debug] [MainThread]: Command `dbt run` succeeded at 07:05:33.985603 after 1.34 seconds
[0m07:05:33.986110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00aaf53770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ace08d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ac87d460>]}
[0m07:05:33.986497 [debug] [MainThread]: Flushing usage events
[0m07:05:35.249333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:06:26.070119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796ac639b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796bf9c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796ac61160>]}


============================== 07:06:26.076242 | a41b709d-a024-4fc1-bbe8-7932112dff0c ==============================
[0m07:06:26.076242 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:06:26.076682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:06:26.262485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796bf1f440>]}
[0m07:06:26.309200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796a2a9940>]}
[0m07:06:26.310115 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:06:26.362486 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:06:26.445005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:06:26.445699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:06:26.477528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796879ef90>]}
[0m07:06:26.545074 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:06:26.548578 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:06:26.574267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7479684dae10>]}
[0m07:06:26.574983 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:06:26.576739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796848fe60>]}
[0m07:06:26.579026 [info ] [MainThread]: 
[0m07:06:26.579505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:06:26.580138 [info ] [MainThread]: 
[0m07:06:26.581357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:06:26.585427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:06:26.620397 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:06:26.620919 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:06:26.621574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:26.630598 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m07:06:26.632484 [debug] [ThreadPool]: On list_db: Close
[0m07:06:26.634699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:06:26.641209 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:06:26.641555 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:06:26.641812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:26.647160 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:06:26.647471 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:06:26.647709 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:06:26.649876 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:06:26.651036 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:06:26.651456 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:06:26.655657 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:26.655928 [debug] [MainThread]: On master: BEGIN
[0m07:06:26.656122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:06:26.661690 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:06:26.662073 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:26.662327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:06:26.665092 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m07:06:26.666129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747968313d70>]}
[0m07:06:26.666494 [debug] [MainThread]: On master: ROLLBACK
[0m07:06:26.666848 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:26.667068 [debug] [MainThread]: On master: BEGIN
[0m07:06:26.667488 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:06:26.667748 [debug] [MainThread]: On master: COMMIT
[0m07:06:26.667949 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:26.668122 [debug] [MainThread]: On master: COMMIT
[0m07:06:26.669148 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:06:26.670611 [debug] [MainThread]: On master: Close
[0m07:06:26.675898 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:06:26.676349 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:06:26.676757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:06:26.677045 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:06:26.681982 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:06:26.682654 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:06:26.710811 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:06:26.711496 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:06:26.711802 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:06:26.712096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:26.717809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:06:26.718115 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:06:26.718343 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:06:26.725013 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m07:06:26.729408 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:06:26.729715 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:06:26.730293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:06:26.733025 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:06:26.733340 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:06:26.733867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:06:26.761731 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:06:26.762125 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:06:26.762350 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:06:26.764911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:06:26.770581 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:06:26.774893 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:06:26.775188 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:06:26.778757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:06:26.780719 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:06:26.783220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796bf1e570>]}
[0m07:06:26.784209 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.10s]
[0m07:06:26.785288 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:06:26.786296 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:06:26.787293 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:06:26.786990 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:06:26.787800 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:06:26.788561 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:06:26.789174 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:06:26.789472 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:06:26.789780 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:06:26.791749 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:06:26.793712 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:06:26.794644 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:06:26.795065 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:06:26.798132 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:06:26.800179 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:06:26.801330 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:06:26.801669 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:06:26.801918 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:06:26.802500 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:06:26.802735 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:06:26.802916 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:06:26.808491 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m07:06:26.808788 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:06:26.809071 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:06:26.810209 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m07:06:26.810680 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:06:26.811057 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:06:26.817911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m07:06:26.820489 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:06:26.820791 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:06:26.821487 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:06:26.821877 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:06:26.823895 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:06:26.827154 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:06:26.827608 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:06:26.827939 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:06:26.828608 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:06:26.830285 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:06:26.830637 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:06:26.830909 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:06:26.833192 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:06:26.833662 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:06:26.834011 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:06:26.834711 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:06:26.835875 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:06:26.836118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:06:26.836456 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:06:26.836793 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m07:06:26.838375 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:06:26.838774 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:06:26.839015 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:06:26.839473 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m07:06:26.841311 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:06:26.841596 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:06:26.842189 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:06:26.843210 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:06:26.843544 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:06:26.844080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796454f9e0>]}
[0m07:06:26.844881 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m07:06:26.845947 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:06:26.847875 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:06:26.848905 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:06:26.849331 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a41b709d-a024-4fc1-bbe8-7932112dff0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747967608650>]}
[0m07:06:26.849786 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m07:06:26.850597 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:06:26.852287 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:26.852576 [debug] [MainThread]: On master: BEGIN
[0m07:06:26.852897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:06:26.858550 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:06:26.858924 [debug] [MainThread]: On master: COMMIT
[0m07:06:26.859181 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:26.859421 [debug] [MainThread]: On master: COMMIT
[0m07:06:26.859796 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:06:26.860040 [debug] [MainThread]: On master: Close
[0m07:06:26.860396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:06:26.860595 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:06:26.860782 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:06:26.861006 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:06:26.861285 [info ] [MainThread]: 
[0m07:06:26.861562 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m07:06:26.862242 [debug] [MainThread]: Command end result
[0m07:06:26.878306 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:06:26.879737 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:06:26.884220 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:06:26.884537 [info ] [MainThread]: 
[0m07:06:26.884949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:06:26.885746 [info ] [MainThread]: 
[0m07:06:26.886354 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:06:26.887468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86249614, "process_in_blocks": "0", "process_kernel_time": 0.295271, "process_mem_max_rss": "108044", "process_out_blocks": "3392", "process_user_time": 1.708636}
[0m07:06:26.888164 [debug] [MainThread]: Command `dbt run` succeeded at 07:06:26.888072 after 0.86 seconds
[0m07:06:26.888445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796a5e5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796871b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74796848ccb0>]}
[0m07:06:26.888711 [debug] [MainThread]: Flushing usage events
[0m07:06:28.112999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:10:24.182153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cdde870290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddf43e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddec81c40>]}


============================== 07:10:24.187123 | d27d97e4-6721-472a-b5c3-3b4c9a7b86d4 ==============================
[0m07:10:24.187123 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:10:24.187520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:10:24.374334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cdde8ea810>]}
[0m07:10:24.428740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddea972f0>]}
[0m07:10:24.429596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:10:24.523600 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:10:24.604518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:10:24.604890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:10:24.639441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddcfe6a50>]}
[0m07:10:24.730678 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:10:24.733696 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:10:24.753002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddccb75f0>]}
[0m07:10:24.753417 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:10:24.753946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddcfe4b30>]}
[0m07:10:24.755576 [info ] [MainThread]: 
[0m07:10:24.756014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:10:24.756587 [info ] [MainThread]: 
[0m07:10:24.757532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:10:24.761103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:10:24.795270 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:10:24.795650 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:10:24.795867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:24.803981 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m07:10:24.805166 [debug] [ThreadPool]: On list_db: Close
[0m07:10:24.807525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:10:24.811554 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:10:24.811836 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:10:24.812033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:10:24.819845 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:10:24.820319 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:10:24.820513 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:10:24.823710 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:10:24.824791 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:10:24.825405 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:10:24.829188 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:24.829447 [debug] [MainThread]: On master: BEGIN
[0m07:10:24.829660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:10:24.834441 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:10:24.834729 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:24.834985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:10:24.837862 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:10:24.838907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddcfd2a50>]}
[0m07:10:24.839263 [debug] [MainThread]: On master: ROLLBACK
[0m07:10:24.839922 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:24.840209 [debug] [MainThread]: On master: BEGIN
[0m07:10:24.840798 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:10:24.841030 [debug] [MainThread]: On master: COMMIT
[0m07:10:24.841225 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:24.841429 [debug] [MainThread]: On master: COMMIT
[0m07:10:24.841744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:10:24.842241 [debug] [MainThread]: On master: Close
[0m07:10:24.850197 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:10:24.851201 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:10:24.852126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:10:24.852421 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:10:24.857368 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:10:24.857900 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:10:24.890525 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:10:24.891142 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:10:24.891403 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:10:24.891622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:10:24.898270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:10:24.898829 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:10:24.899328 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:10:24.906340 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m07:10:24.910982 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:10:24.911310 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:10:24.912710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:10:24.917169 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:10:24.917593 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:10:24.918210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:10:24.933755 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:10:24.934142 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:10:24.934415 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:10:24.938386 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:10:24.948812 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:10:24.954594 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:10:24.954883 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:10:24.958725 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:10:24.961156 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:10:24.968639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddf336360>]}
[0m07:10:24.969216 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m07:10:24.969668 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:10:24.970567 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:10:24.971392 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:10:24.971915 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:10:24.972759 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:10:24.973381 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:10:24.973839 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:10:24.974299 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:10:24.974651 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:10:24.977471 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:10:24.979419 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:10:24.980180 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:10:24.982452 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:10:24.982989 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:10:24.983343 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:10:24.983660 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:10:24.986333 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:10:24.986786 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:10:24.987436 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:10:24.987760 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:10:24.987994 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:10:24.993510 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m07:10:24.993856 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:10:24.994099 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:10:24.995995 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m07:10:24.996293 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:10:24.996503 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:10:25.001593 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m07:10:25.003928 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:10:25.004255 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:10:25.004650 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m07:10:25.004914 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:10:25.006842 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:10:25.008922 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:10:25.009325 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:10:25.009664 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:10:25.010317 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:10:25.010623 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:10:25.012463 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:10:25.013954 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:10:25.014282 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:10:25.014576 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:10:25.014990 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:10:25.015265 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:10:25.016363 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:10:25.016615 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:10:25.016834 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:10:25.017803 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m07:10:25.019237 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:10:25.019651 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:10:25.019972 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m07:10:25.020270 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:10:25.021677 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:10:25.022352 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:10:25.022630 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:10:25.024307 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:10:25.025792 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:10:25.026221 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:10:25.027283 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:10:25.027760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cdd4d649e0>]}
[0m07:10:25.028212 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd27d97e4-6721-472a-b5c3-3b4c9a7b86d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cdde917cb0>]}
[0m07:10:25.028702 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.05s]
[0m07:10:25.029348 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m07:10:25.029915 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:10:25.030388 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:10:25.032416 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:25.032657 [debug] [MainThread]: On master: BEGIN
[0m07:10:25.032858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:10:25.037782 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:10:25.038116 [debug] [MainThread]: On master: COMMIT
[0m07:10:25.038373 [debug] [MainThread]: Using postgres connection "master"
[0m07:10:25.038608 [debug] [MainThread]: On master: COMMIT
[0m07:10:25.038999 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:10:25.039241 [debug] [MainThread]: On master: Close
[0m07:10:25.039584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:25.039785 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:10:25.040402 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:10:25.040707 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:10:25.040996 [info ] [MainThread]: 
[0m07:10:25.041514 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m07:10:25.042695 [debug] [MainThread]: Command end result
[0m07:10:25.057841 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:10:25.059275 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:10:25.064702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:10:25.065030 [info ] [MainThread]: 
[0m07:10:25.065689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:10:25.066353 [info ] [MainThread]: 
[0m07:10:25.066858 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:10:25.067895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.926634, "process_in_blocks": "0", "process_kernel_time": 0.270101, "process_mem_max_rss": "108004", "process_out_blocks": "3392", "process_user_time": 1.701641}
[0m07:10:25.068329 [debug] [MainThread]: Command `dbt run` succeeded at 07:10:25.068242 after 0.93 seconds
[0m07:10:25.068611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddf43e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cddcca6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cdded96a20>]}
[0m07:10:25.068900 [debug] [MainThread]: Flushing usage events
[0m07:10:26.300427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:11:24.272288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc182b7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc17a3c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc17dad730>]}


============================== 07:11:24.282417 | 12d81a53-9774-4b6b-9a07-2f9e3f17adce ==============================
[0m07:11:24.282417 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:11:24.282879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:11:24.521682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc183e8e90>]}
[0m07:11:24.586711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc184ffb00>]}
[0m07:11:24.588417 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:11:24.662293 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:11:24.763149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:11:24.763599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:11:24.797601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc160114c0>]}
[0m07:11:24.862200 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:11:24.865845 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:11:24.892639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc15caf590>]}
[0m07:11:24.893180 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:11:24.893517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc15d60e30>]}
[0m07:11:24.895089 [info ] [MainThread]: 
[0m07:11:24.895488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:11:24.895746 [info ] [MainThread]: 
[0m07:11:24.896231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:11:24.899891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:11:24.939649 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:11:24.940049 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:11:24.940528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:24.950521 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m07:11:24.951843 [debug] [ThreadPool]: On list_db: Close
[0m07:11:24.954022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:11:24.958603 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:11:24.958909 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:11:24.959118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:24.967943 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:11:24.968851 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:11:24.969098 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:11:24.972195 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:11:24.973389 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:11:24.973832 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:11:24.978398 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:24.978696 [debug] [MainThread]: On master: BEGIN
[0m07:11:24.978916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:11:24.984238 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:11:24.984617 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:24.984922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:11:24.988359 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:11:24.989652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc160109e0>]}
[0m07:11:24.990120 [debug] [MainThread]: On master: ROLLBACK
[0m07:11:24.990753 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:24.991119 [debug] [MainThread]: On master: BEGIN
[0m07:11:24.991864 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:11:24.992488 [debug] [MainThread]: On master: COMMIT
[0m07:11:24.992996 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:24.993319 [debug] [MainThread]: On master: COMMIT
[0m07:11:24.993747 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:11:24.994007 [debug] [MainThread]: On master: Close
[0m07:11:24.996863 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:11:24.997340 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:11:24.997739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:11:24.997984 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:11:25.003676 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:11:25.004552 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:11:25.033557 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:11:25.034310 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:11:25.034657 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:11:25.034908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:11:25.041346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:11:25.041808 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:11:25.042097 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:11:25.052152 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:11:25.058507 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:11:25.058960 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:11:25.059704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:11:25.062250 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:11:25.062584 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:11:25.063165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:11:25.081348 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:11:25.081800 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:11:25.082061 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:11:25.086386 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:11:25.092481 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:11:25.098208 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:11:25.098822 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:11:25.102614 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:11:25.104626 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:11:25.106118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1833e630>]}
[0m07:11:25.106671 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m07:11:25.107129 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:11:25.109360 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:11:25.110210 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:11:25.110914 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:11:25.111409 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:11:25.115057 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:11:25.115698 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:11:25.118044 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:11:25.118575 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:11:25.119015 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:11:25.119782 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:11:25.120098 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:11:25.122460 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:11:25.127801 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:11:25.128546 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:11:25.129144 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:11:25.129687 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:11:25.132613 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:11:25.133734 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:11:25.134008 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:11:25.134238 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:11:25.142204 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m07:11:25.143118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:11:25.143459 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:11:25.144620 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m07:11:25.145049 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:11:25.145354 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:11:25.154149 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:11:25.157141 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:11:25.157538 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:11:25.158467 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:11:25.161034 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:11:25.161340 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:11:25.161980 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m07:11:25.162541 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:11:25.164688 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:11:25.166659 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:11:25.167354 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:11:25.167844 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:11:25.168751 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:11:25.169256 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:11:25.173846 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:11:25.174482 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m07:11:25.174999 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:11:25.176946 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:11:25.177827 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:11:25.178223 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:11:25.178770 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:11:25.181037 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:11:25.181459 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:11:25.181840 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:11:25.182288 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:11:25.183671 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:11:25.184484 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc15cafda0>]}
[0m07:11:25.185248 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m07:11:25.185909 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:11:25.188802 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:11:25.190887 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:11:25.191387 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:11:25.191666 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:11:25.194897 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:11:25.196492 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:11:25.197183 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12d81a53-9774-4b6b-9a07-2f9e3f17adce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc14eff680>]}
[0m07:11:25.197789 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m07:11:25.198317 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:11:25.200647 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:25.201060 [debug] [MainThread]: On master: BEGIN
[0m07:11:25.201381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:11:25.207696 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:11:25.208191 [debug] [MainThread]: On master: COMMIT
[0m07:11:25.208513 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:25.208801 [debug] [MainThread]: On master: COMMIT
[0m07:11:25.209281 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:11:25.209640 [debug] [MainThread]: On master: Close
[0m07:11:25.210133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:25.210445 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:11:25.210684 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:11:25.210911 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:11:25.211294 [info ] [MainThread]: 
[0m07:11:25.211641 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m07:11:25.212614 [debug] [MainThread]: Command end result
[0m07:11:25.231470 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:11:25.233324 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:11:25.239738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:11:25.240237 [info ] [MainThread]: 
[0m07:11:25.241680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:11:25.242338 [info ] [MainThread]: 
[0m07:11:25.242973 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:11:25.244151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0266051, "process_in_blocks": "0", "process_kernel_time": 0.326264, "process_mem_max_rss": "107488", "process_out_blocks": "3392", "process_user_time": 1.770076}
[0m07:11:25.244710 [debug] [MainThread]: Command `dbt run` succeeded at 07:11:25.244597 after 1.03 seconds
[0m07:11:25.245065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc19f16c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc14f55370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1833e630>]}
[0m07:11:25.245396 [debug] [MainThread]: Flushing usage events
[0m07:11:26.695574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:12:24.776030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb942406990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb942d18e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb94411c2f0>]}


============================== 07:12:24.782858 | c705735b-c8a3-4e01-9e48-c9db898f9fe8 ==============================
[0m07:12:24.782858 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:12:24.783348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:12:25.001493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb94271cb30>]}
[0m07:12:25.056131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb9422204d0>]}
[0m07:12:25.057013 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:12:25.133923 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:12:25.221222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:12:25.221598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:12:25.252203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb940910800>]}
[0m07:12:25.313180 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:12:25.315759 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:12:25.339227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb940596930>]}
[0m07:12:25.339712 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:12:25.340037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb9405c0260>]}
[0m07:12:25.341600 [info ] [MainThread]: 
[0m07:12:25.341944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:12:25.342182 [info ] [MainThread]: 
[0m07:12:25.342689 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:12:25.346614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:12:25.384052 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:12:25.384671 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:12:25.384930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:25.395962 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m07:12:25.397457 [debug] [ThreadPool]: On list_db: Close
[0m07:12:25.399409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:12:25.404151 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:12:25.404445 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:12:25.404653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:12:25.411943 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:12:25.412498 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:12:25.412954 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:12:25.416304 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:12:25.417512 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:12:25.417961 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:12:25.422123 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:25.422464 [debug] [MainThread]: On master: BEGIN
[0m07:12:25.422681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:12:25.428970 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:12:25.429623 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:25.431766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:12:25.435570 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:12:25.437995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb9408d55e0>]}
[0m07:12:25.438819 [debug] [MainThread]: On master: ROLLBACK
[0m07:12:25.439802 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:25.440404 [debug] [MainThread]: On master: BEGIN
[0m07:12:25.441457 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:12:25.441999 [debug] [MainThread]: On master: COMMIT
[0m07:12:25.442475 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:25.442877 [debug] [MainThread]: On master: COMMIT
[0m07:12:25.443527 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:12:25.443798 [debug] [MainThread]: On master: Close
[0m07:12:25.446770 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:12:25.447417 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:12:25.447941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:12:25.448316 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:12:25.454334 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:12:25.455104 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:12:25.490139 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:12:25.490839 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:12:25.491136 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:12:25.491366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:25.497145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:12:25.497436 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:12:25.497680 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:12:25.505379 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m07:12:25.510946 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:12:25.511263 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:12:25.511914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:12:25.514728 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:12:25.515024 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:12:25.515682 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:12:25.530304 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:12:25.530729 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:12:25.530970 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:12:25.535195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:12:25.543137 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:12:25.549581 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:12:25.549990 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:12:25.576774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.026 seconds
[0m07:12:25.580366 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:12:25.582522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb942c6a840>]}
[0m07:12:25.583399 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.13s]
[0m07:12:25.584103 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:12:25.585443 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:12:25.585974 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:12:25.586597 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:12:25.586943 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:12:25.589568 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:12:25.590202 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:12:25.590767 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:12:25.597111 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:12:25.591238 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:12:25.598099 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:12:25.598340 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:12:25.600200 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:12:25.600608 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:12:25.602643 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:12:25.603070 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:12:25.603327 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:12:25.603647 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:12:25.604023 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:12:25.604273 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:12:25.604460 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:12:25.612263 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m07:12:25.612618 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:12:25.612874 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:12:25.619653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m07:12:25.620641 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:12:25.621001 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:12:25.639714 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m07:12:25.642521 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:12:25.642842 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:12:25.643319 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m07:12:25.645523 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:12:25.645798 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:12:25.646130 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:12:25.647969 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:12:25.648238 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:12:25.650931 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m07:12:25.653054 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:12:25.653333 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:12:25.653679 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m07:12:25.654931 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:12:25.655247 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:12:25.655524 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:12:25.656598 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:12:25.656903 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:12:25.658959 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:12:25.659472 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:12:25.661992 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m07:12:25.666464 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:12:25.667509 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:12:25.667751 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:12:25.666854 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m07:12:25.670291 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:12:25.670773 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:12:25.670990 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:12:25.673936 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:12:25.675130 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:12:25.675635 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb93f7a2360>]}
[0m07:12:25.676095 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m07:12:25.676494 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:12:25.678986 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m07:12:25.680033 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:12:25.680501 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c705735b-c8a3-4e01-9e48-c9db898f9fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb93f840da0>]}
[0m07:12:25.680966 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.08s]
[0m07:12:25.681346 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:12:25.683215 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:25.683472 [debug] [MainThread]: On master: BEGIN
[0m07:12:25.683659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:12:25.688548 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:12:25.688840 [debug] [MainThread]: On master: COMMIT
[0m07:12:25.689038 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:25.689238 [debug] [MainThread]: On master: COMMIT
[0m07:12:25.689784 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:12:25.690018 [debug] [MainThread]: On master: Close
[0m07:12:25.690467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:12:25.690693 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:12:25.690865 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:12:25.691021 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:12:25.692005 [info ] [MainThread]: 
[0m07:12:25.693205 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m07:12:25.694406 [debug] [MainThread]: Command end result
[0m07:12:25.710240 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:12:25.711836 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:12:25.716659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:12:25.716917 [info ] [MainThread]: 
[0m07:12:25.717250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:12:25.717449 [info ] [MainThread]: 
[0m07:12:25.717686 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:12:25.718550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9976085, "process_in_blocks": "0", "process_kernel_time": 0.387578, "process_mem_max_rss": "107560", "process_out_blocks": "3392", "process_user_time": 1.664307}
[0m07:12:25.718952 [debug] [MainThread]: Command `dbt run` succeeded at 07:12:25.718872 after 1.00 seconds
[0m07:12:25.719232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb94294b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb94403e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb942773200>]}
[0m07:12:25.719593 [debug] [MainThread]: Flushing usage events
[0m07:12:27.033038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:14:24.740500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc06cd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc06cd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc06cc0b0>]}


============================== 07:14:24.748081 | f2dc64d6-51ae-430b-af63-a2b56530712b ==============================
[0m07:14:24.748081 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:14:24.749444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:14:24.928547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc0747aa0>]}
[0m07:14:24.973537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc060fec0>]}
[0m07:14:24.974220 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:14:25.044957 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:14:25.123943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:25.124308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:25.149511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfbee70230>]}
[0m07:14:25.203217 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:14:25.205174 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:14:25.235133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfbee71010>]}
[0m07:14:25.235992 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:14:25.236619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfbeb0e630>]}
[0m07:14:25.238845 [info ] [MainThread]: 
[0m07:14:25.239169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:25.240238 [info ] [MainThread]: 
[0m07:14:25.241431 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:14:25.246368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:14:25.292395 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:14:25.292771 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:14:25.292989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:25.304508 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m07:14:25.305897 [debug] [ThreadPool]: On list_db: Close
[0m07:14:25.307801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:14:25.312585 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:14:25.312933 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:14:25.313134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:25.319665 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:14:25.320907 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:14:25.321160 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:14:25.325409 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m07:14:25.326549 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:14:25.327110 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:14:25.332586 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:25.332979 [debug] [MainThread]: On master: BEGIN
[0m07:14:25.333254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:14:25.339951 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:14:25.340935 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:25.341412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:14:25.345320 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:14:25.346812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc06352e0>]}
[0m07:14:25.347335 [debug] [MainThread]: On master: ROLLBACK
[0m07:14:25.347874 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:25.348168 [debug] [MainThread]: On master: BEGIN
[0m07:14:25.348836 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:14:25.349146 [debug] [MainThread]: On master: COMMIT
[0m07:14:25.349420 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:25.349652 [debug] [MainThread]: On master: COMMIT
[0m07:14:25.350050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:14:25.350381 [debug] [MainThread]: On master: Close
[0m07:14:25.354210 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:14:25.354709 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:14:25.355125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:14:25.355376 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:14:25.360685 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:14:25.361202 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:14:25.390903 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:14:25.391534 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:25.391793 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:14:25.392015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:25.399042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:14:25.399527 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:25.399933 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:14:25.471127 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.070 seconds
[0m07:14:25.487068 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:25.487685 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:14:25.489403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:14:25.493368 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:25.493765 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:14:25.494952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:14:25.510903 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:14:25.511211 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:25.511402 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:14:25.517249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:14:25.525882 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:14:25.529682 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:25.529920 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:14:25.622141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.092 seconds
[0m07:14:25.625692 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:14:25.627715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc11ba480>]}
[0m07:14:25.628486 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.27s]
[0m07:14:25.629152 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:14:25.633281 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:14:25.634335 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:14:25.634908 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:14:25.635246 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:14:25.638189 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:14:25.638767 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:14:25.641500 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:14:25.641893 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:25.642394 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:14:25.642598 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:14:25.643682 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:14:25.643978 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:14:25.644433 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:14:25.644677 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:14:25.646271 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:14:25.646668 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:14:25.648665 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:14:25.649062 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:25.649298 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:14:25.649508 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:14:25.660373 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m07:14:25.660772 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:25.660981 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:14:25.680335 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m07:14:25.681349 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:25.681866 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:14:25.735449 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.074 seconds
[0m07:14:25.741116 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:25.742558 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:14:25.744531 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:14:25.746222 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.064 seconds
[0m07:14:25.750877 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:25.754935 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:25.755904 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:14:25.756623 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:14:25.758953 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:14:25.760995 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:14:25.761435 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:25.761833 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:14:25.762312 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m07:14:25.764955 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:25.765255 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:14:25.766001 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:14:25.767726 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:14:25.768182 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m07:14:25.768541 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:25.770453 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:14:25.770976 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:14:25.771707 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:25.772563 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:14:25.775439 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m07:14:25.777529 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:14:25.778061 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:25.778352 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:14:25.778729 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:14:25.779738 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:14:25.780261 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfbdcc9a30>]}
[0m07:14:25.780693 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m07:14:25.781071 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:14:25.783475 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:14:25.784558 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:14:25.784983 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2dc64d6-51ae-430b-af63-a2b56530712b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfbddb1a90>]}
[0m07:14:25.785413 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.15s]
[0m07:14:25.785808 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:14:25.787398 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:25.787674 [debug] [MainThread]: On master: BEGIN
[0m07:14:25.787907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:14:25.792963 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:14:25.794104 [debug] [MainThread]: On master: COMMIT
[0m07:14:25.794348 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:25.794522 [debug] [MainThread]: On master: COMMIT
[0m07:14:25.795344 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:14:25.795589 [debug] [MainThread]: On master: Close
[0m07:14:25.795954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:25.796282 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:14:25.796460 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:14:25.796621 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:14:25.796876 [info ] [MainThread]: 
[0m07:14:25.797484 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m07:14:25.798758 [debug] [MainThread]: Command end result
[0m07:14:25.813679 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:14:25.815541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:14:25.820615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:14:25.820885 [info ] [MainThread]: 
[0m07:14:25.821374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:14:25.821818 [info ] [MainThread]: 
[0m07:14:25.822092 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:14:25.822835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1310418, "process_in_blocks": "0", "process_kernel_time": 0.338926, "process_mem_max_rss": "107736", "process_out_blocks": "3392", "process_user_time": 1.663822}
[0m07:14:25.823206 [debug] [MainThread]: Command `dbt run` succeeded at 07:14:25.823130 after 1.13 seconds
[0m07:14:25.823461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc0c9cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc1a17c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73dfc09d5d00>]}
[0m07:14:25.823719 [debug] [MainThread]: Flushing usage events
[0m07:14:27.152761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:26:26.240086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd21411f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd1a45fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd14b9280>]}


============================== 07:26:26.252749 | a4aef046-2249-4432-9e6a-f8808ae16d76 ==============================
[0m07:26:26.252749 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:26:26.254858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:26:26.529771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd13dafc0>]}
[0m07:26:26.611133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd15300b0>]}
[0m07:26:26.612099 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:26:26.679543 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:26:26.778416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:26:26.778996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:26:26.810554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd1a10a70>]}
[0m07:26:26.863712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d591f77e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d592e8b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d591a3e840>]}


============================== 07:26:26.869462 | 4eb0e29a-5c0d-404f-80de-627dc03a3422 ==============================
[0m07:26:26.869462 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:26:26.869864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:26:26.880805 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:26:26.883070 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:26:26.911498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bcf904530>]}
[0m07:26:26.912158 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:26:26.912826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd202aa50>]}
[0m07:26:26.915578 [info ] [MainThread]: 
[0m07:26:26.915918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:26:26.916135 [info ] [MainThread]: 
[0m07:26:26.916539 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:26:26.920542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:26:26.978341 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:26:26.978700 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:26:26.978910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:27.022567 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.043 seconds
[0m07:26:27.023732 [debug] [ThreadPool]: On list_db: Close
[0m07:26:27.026069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:26:27.030152 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:26:27.030430 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:26:27.030785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:27.037731 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:26:27.038149 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:26:27.038355 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:26:27.044808 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m07:26:27.047020 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:26:27.047832 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:26:27.056947 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.057632 [debug] [MainThread]: On master: BEGIN
[0m07:26:27.058080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:26:27.068144 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:26:27.069094 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.070039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:26:27.076163 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:26:27.077488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd2121130>]}
[0m07:26:27.078052 [debug] [MainThread]: On master: ROLLBACK
[0m07:26:27.078614 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.079225 [debug] [MainThread]: On master: BEGIN
[0m07:26:27.080384 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:26:27.081237 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.081977 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.082587 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.083207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:26:27.084595 [debug] [MainThread]: On master: Close
[0m07:26:27.090621 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:26:27.091249 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:26:27.091675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:26:27.091895 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:26:27.097272 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:26:27.098573 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:26:27.107195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d59138e240>]}
[0m07:26:27.129116 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:26:27.130163 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.130921 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:26:27.131653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:27.157450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m07:26:27.161839 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.162342 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:26:27.170542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d591653dd0>]}
[0m07:26:27.212661 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:26:27.228429 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.065 seconds
[0m07:26:27.235595 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.236147 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:26:27.238379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:26:27.243304 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.244025 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:26:27.245315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:26:27.267462 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:26:27.267898 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.268192 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:26:27.271454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:26:27.280677 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:26:27.285166 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.285492 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:26:27.290606 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:26:27.293492 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:26:27.295206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd1f7dfa0>]}
[0m07:26:27.294981 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:26:27.295936 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m07:26:27.296798 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:26:27.298805 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:26:27.299535 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:26:27.301031 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:26:27.302802 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:26:27.304179 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:26:27.305233 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:26:27.305713 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:26:27.306393 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:26:27.308968 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:26:27.312436 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:26:27.313579 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:26:27.315771 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:26:27.316873 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:26:27.321178 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:26:27.322609 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.322899 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:26:27.323139 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:26:27.324395 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.325077 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:26:27.325599 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:26:27.332470 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m07:26:27.333342 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.334114 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:26:27.347654 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m07:26:27.348082 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.348390 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:26:27.356831 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.022 seconds
[0m07:26:27.360965 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.361307 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:26:27.363303 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:26:27.366764 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.367331 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m07:26:27.368219 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:26:27.370513 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.371014 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:26:27.371711 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:26:27.372861 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:26:27.373123 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.373351 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:26:27.373758 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:26:27.375896 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.376162 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:26:27.376904 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:27.377179 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m07:26:27.378316 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:26:27.380161 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:26:27.380753 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.381420 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.381924 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:26:27.382505 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:26:27.387366 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m07:26:27.389525 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:26:27.390452 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.390715 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:26:27.392215 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m07:26:27.393183 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:26:27.393668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bcc1d7830>]}
[0m07:26:27.394148 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.09s]
[0m07:26:27.394562 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:26:27.399205 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m07:26:27.400734 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:26:27.401291 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4aef046-2249-4432-9e6a-f8808ae16d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bcc1f0f80>]}
[0m07:26:27.401817 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m07:26:27.402278 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:26:27.405657 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.405995 [debug] [MainThread]: On master: BEGIN
[0m07:26:27.406238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:26:27.414871 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:26:27.415518 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.415947 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.416402 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.417366 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:26:27.417863 [debug] [MainThread]: On master: Close
[0m07:26:27.418379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:27.418597 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:26:27.418762 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:26:27.418911 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:26:27.419226 [info ] [MainThread]: 
[0m07:26:27.419516 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m07:26:27.420217 [debug] [MainThread]: Command end result
[0m07:26:27.437258 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:26:27.439303 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:26:27.444674 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:26:27.444962 [info ] [MainThread]: 
[0m07:26:27.445259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:26:27.445486 [info ] [MainThread]: 
[0m07:26:27.446464 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:26:27.447973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3289069, "process_in_blocks": "7728", "process_kernel_time": 1.068965, "process_mem_max_rss": "107400", "process_out_blocks": "3392", "process_user_time": 2.818182}
[0m07:26:27.448992 [debug] [MainThread]: Command `dbt run` succeeded at 07:26:27.448778 after 1.33 seconds
[0m07:26:27.449602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:26:27.449982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:26:27.449842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd19abc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd27dfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785bd27df140>]}
[0m07:26:27.450447 [debug] [MainThread]: Flushing usage events
[0m07:26:27.479902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d58fc23e00>]}
[0m07:26:27.544377 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:26:27.547046 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:26:27.574295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d58f9996d0>]}
[0m07:26:27.575063 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:26:27.575785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d58fb574a0>]}
[0m07:26:27.577810 [info ] [MainThread]: 
[0m07:26:27.578287 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:26:27.578546 [info ] [MainThread]: 
[0m07:26:27.578997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:26:27.586092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:26:27.647552 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:26:27.648045 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:26:27.648457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:27.659561 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m07:26:27.661384 [debug] [ThreadPool]: On list_db: Close
[0m07:26:27.663392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:26:27.668749 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:26:27.669109 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:26:27.669371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:27.677363 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:26:27.678062 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:26:27.678596 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:26:27.681408 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:26:27.682949 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:26:27.683585 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:26:27.689547 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.690031 [debug] [MainThread]: On master: BEGIN
[0m07:26:27.690382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:26:27.698790 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:26:27.699715 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.700244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:26:27.704181 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:26:27.705660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d5927d3650>]}
[0m07:26:27.706371 [debug] [MainThread]: On master: ROLLBACK
[0m07:26:27.706988 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.707490 [debug] [MainThread]: On master: BEGIN
[0m07:26:27.708268 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:26:27.708622 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.708913 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.709248 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.710161 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:26:27.711242 [debug] [MainThread]: On master: Close
[0m07:26:27.717986 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:26:27.718922 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:26:27.719583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:26:27.719973 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:26:27.728783 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:26:27.729805 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:26:27.771988 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:26:27.773105 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.773559 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:26:27.773904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:27.782759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:26:27.783560 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.784244 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:26:27.804855 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m07:26:27.811720 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.812157 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:26:27.813026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:27.816655 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.817079 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:26:27.817994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:26:27.838313 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:26:27.838818 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.839146 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:26:27.841951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:26:27.849054 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:26:27.855828 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:26:27.856297 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:26:27.859762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:26:27.862263 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:26:27.864476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d59339a240>]}
[0m07:26:27.865240 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.14s]
[0m07:26:27.865840 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:26:27.868486 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:26:27.869332 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:26:27.870285 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:26:27.870843 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:26:27.871458 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:26:27.871973 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:26:27.872514 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:26:27.875691 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:26:27.876166 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:26:27.879388 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:26:27.880052 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:26:27.883212 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:26:27.884211 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:26:27.887974 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:26:27.888729 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.889162 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:26:27.889582 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.890023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:26:27.890422 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:26:27.891122 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:26:27.898408 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m07:26:27.898823 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.899209 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:26:27.900318 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m07:26:27.900926 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.901784 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:26:27.911091 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m07:26:27.914364 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.914788 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:26:27.915690 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:27.916277 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m07:26:27.920147 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.923264 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.923772 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:26:27.924212 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:26:27.925155 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:26:27.925531 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:26:27.927141 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:26:27.929875 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.930433 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.930849 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:26:27.931250 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:26:27.932056 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:27.934092 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:26:27.934455 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.935193 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:26:27.935713 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m07:26:27.939785 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:26:27.940422 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m07:26:27.941238 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:26:27.943694 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:26:27.944162 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:26:27.944815 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:26:27.945322 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:26:27.949097 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:26:27.950874 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:26:27.951362 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:26:27.952091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d58c1b7830>]}
[0m07:26:27.953529 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:26:27.954810 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m07:26:27.955639 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb0e29a-5c0d-404f-80de-627dc03a3422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d58c17fad0>]}
[0m07:26:27.956522 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:26:27.957234 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.08s]
[0m07:26:27.958342 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:26:27.960625 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.960971 [debug] [MainThread]: On master: BEGIN
[0m07:26:27.961256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:26:27.967858 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:26:27.968237 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.968535 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:27.968796 [debug] [MainThread]: On master: COMMIT
[0m07:26:27.969260 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:26:27.969839 [debug] [MainThread]: On master: Close
[0m07:26:27.970748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:27.971237 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:26:27.971758 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:26:27.972229 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:26:27.972676 [info ] [MainThread]: 
[0m07:26:27.973289 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m07:26:27.974481 [debug] [MainThread]: Command end result
[0m07:26:28.000907 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:26:28.007658 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:26:28.014759 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:26:28.015445 [info ] [MainThread]: 
[0m07:26:28.015911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:26:28.016264 [info ] [MainThread]: 
[0m07:26:28.017657 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:26:28.019106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2047652, "process_in_blocks": "0", "process_kernel_time": 0.574659, "process_mem_max_rss": "107752", "process_out_blocks": "3384", "process_user_time": 2.255043}
[0m07:26:28.019651 [debug] [MainThread]: Command `dbt run` succeeded at 07:26:28.019535 after 1.21 seconds
[0m07:26:28.020027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d591b5b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d5916b0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d5916b1220>]}
[0m07:26:28.020412 [debug] [MainThread]: Flushing usage events
[0m07:26:28.726295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:26:29.257957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:27:15.552632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b4ffb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b4ffd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b73d070>]}


============================== 07:27:15.559501 | 092b1b49-541f-451e-86f9-aee85e69d79c ==============================
[0m07:27:15.559501 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:27:15.560119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:27:15.759617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e09c17d70>]}
[0m07:27:15.815431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0be8af30>]}
[0m07:27:15.816641 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:27:15.876112 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:27:16.060146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:16.060850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:16.098119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e09ad9310>]}
[0m07:27:16.193676 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:27:16.196584 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:27:16.246749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e099707d0>]}
[0m07:27:16.247372 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:27:16.247774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0996e9f0>]}
[0m07:27:16.249623 [info ] [MainThread]: 
[0m07:27:16.250058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:27:16.250325 [info ] [MainThread]: 
[0m07:27:16.250794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:27:16.254436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:27:16.298522 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:27:16.298914 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:27:16.299144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:16.307890 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m07:27:16.310006 [debug] [ThreadPool]: On list_db: Close
[0m07:27:16.311603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:27:16.315844 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:27:16.316145 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:27:16.316352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:27:16.322293 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:27:16.322708 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:27:16.322987 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:27:16.326264 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:27:16.327742 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:27:16.328328 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:27:16.333459 [debug] [MainThread]: Using postgres connection "master"
[0m07:27:16.333842 [debug] [MainThread]: On master: BEGIN
[0m07:27:16.334071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:27:16.340791 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:27:16.341451 [debug] [MainThread]: Using postgres connection "master"
[0m07:27:16.348600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:27:16.360294 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m07:27:16.361725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b4cd490>]}
[0m07:27:16.362281 [debug] [MainThread]: On master: ROLLBACK
[0m07:27:16.362987 [debug] [MainThread]: Using postgres connection "master"
[0m07:27:16.363437 [debug] [MainThread]: On master: BEGIN
[0m07:27:16.364151 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:27:16.364473 [debug] [MainThread]: On master: COMMIT
[0m07:27:16.364714 [debug] [MainThread]: Using postgres connection "master"
[0m07:27:16.364977 [debug] [MainThread]: On master: COMMIT
[0m07:27:16.365516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:27:16.365967 [debug] [MainThread]: On master: Close
[0m07:27:16.369777 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:27:16.370316 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:27:16.370741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:27:16.371018 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:27:16.376806 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:27:16.377720 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:27:16.411819 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:27:16.412739 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:27:16.413407 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:27:16.413744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:27:16.420559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:27:16.421049 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:27:16.421355 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:27:16.431814 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:27:16.437161 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:27:16.437586 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:27:16.438393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:27:16.440813 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:27:16.441345 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:27:16.444201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:27:16.464030 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:27:16.464588 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:27:16.464887 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:27:16.469574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:27:16.476213 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:27:16.480755 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:27:16.481174 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:27:16.485183 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:27:16.487341 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:27:16.489317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0c0067e0>]}
[0m07:27:16.489924 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.12s]
[0m07:27:16.490426 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:27:16.491609 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:27:16.491950 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:27:16.492493 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:27:16.493230 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:27:16.493787 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:27:16.494218 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:27:16.494555 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:27:16.494890 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:27:16.497445 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:27:16.499821 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:27:16.500934 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:27:16.503489 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:27:16.504357 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:27:16.504873 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:27:16.505308 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:27:16.507757 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:27:16.508146 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:27:16.508927 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:27:16.509577 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:27:16.509876 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:27:16.515294 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m07:27:16.517202 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:27:16.517689 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m07:27:16.518203 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:27:16.518619 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:27:16.519096 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:27:16.527593 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m07:27:16.530689 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:27:16.531236 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m07:27:16.531829 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:27:16.534438 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:27:16.535032 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:27:16.535442 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:27:16.537923 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:27:16.538338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:27:16.538902 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:27:16.541635 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:27:16.542772 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:27:16.544369 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:27:16.546575 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:27:16.547042 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:27:16.547368 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:27:16.547976 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m07:27:16.550849 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:27:16.551261 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:27:16.551552 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:27:16.554976 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m07:27:16.558066 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:27:16.558732 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:27:16.559073 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:27:16.559742 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m07:27:16.563600 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:27:16.564259 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:27:16.564733 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:27:16.565218 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:27:16.568152 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:27:16.570691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0824b860>]}
[0m07:27:16.571507 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.08s]
[0m07:27:16.572027 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:27:16.572362 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:27:16.574006 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:27:16.574565 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092b1b49-541f-451e-86f9-aee85e69d79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0820f6e0>]}
[0m07:27:16.575081 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.08s]
[0m07:27:16.575633 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:27:16.577609 [debug] [MainThread]: Using postgres connection "master"
[0m07:27:16.577919 [debug] [MainThread]: On master: BEGIN
[0m07:27:16.578150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:27:16.583616 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:27:16.584213 [debug] [MainThread]: On master: COMMIT
[0m07:27:16.584618 [debug] [MainThread]: Using postgres connection "master"
[0m07:27:16.584859 [debug] [MainThread]: On master: COMMIT
[0m07:27:16.585383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:27:16.585695 [debug] [MainThread]: On master: Close
[0m07:27:16.586140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:16.586394 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:27:16.586650 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:27:16.586876 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:27:16.587251 [info ] [MainThread]: 
[0m07:27:16.587611 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m07:27:16.588553 [debug] [MainThread]: Command end result
[0m07:27:16.607818 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:27:16.610536 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:27:16.617149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:27:16.619334 [info ] [MainThread]: 
[0m07:27:16.620195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:27:16.620934 [info ] [MainThread]: 
[0m07:27:16.621641 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:27:16.623132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1147292, "process_in_blocks": "0", "process_kernel_time": 0.510111, "process_mem_max_rss": "107524", "process_out_blocks": "3392", "process_user_time": 2.004008}
[0m07:27:16.623652 [debug] [MainThread]: Command `dbt run` succeeded at 07:27:16.623546 after 1.12 seconds
[0m07:27:16.623964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b771ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b540590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b5400e0>]}
[0m07:27:16.624282 [debug] [MainThread]: Flushing usage events
[0m07:27:17.808546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:28:15.713830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c93249e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c94c340e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c9324b800>]}


============================== 07:28:15.719383 | 024cb57e-1628-4bfe-9bee-f0384271d6c4 ==============================
[0m07:28:15.719383 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:28:15.719952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:28:15.921893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c9137a060>]}
[0m07:28:15.979200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c92c03da0>]}
[0m07:28:15.980403 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:28:16.062773 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:28:16.192098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:28:16.192481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:28:16.233978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c9142fef0>]}
[0m07:28:16.340681 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:28:16.343224 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:28:16.400515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c910f89b0>]}
[0m07:28:16.401055 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:28:16.401369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c910f69f0>]}
[0m07:28:16.403886 [info ] [MainThread]: 
[0m07:28:16.406564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:28:16.407005 [info ] [MainThread]: 
[0m07:28:16.407876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:28:16.416274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:28:16.490380 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:28:16.490770 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:28:16.491007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:16.503246 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m07:28:16.504566 [debug] [ThreadPool]: On list_db: Close
[0m07:28:16.506282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:28:16.511965 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:28:16.512367 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:28:16.512702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:16.519432 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:28:16.519823 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:28:16.520171 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:28:16.523792 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:28:16.525096 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:28:16.525606 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:28:16.530556 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:16.530960 [debug] [MainThread]: On master: BEGIN
[0m07:28:16.531211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:16.540901 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:28:16.541352 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:16.541656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:28:16.551941 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m07:28:16.553778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c91460b30>]}
[0m07:28:16.554277 [debug] [MainThread]: On master: ROLLBACK
[0m07:28:16.554773 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:16.555047 [debug] [MainThread]: On master: BEGIN
[0m07:28:16.555565 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:28:16.555994 [debug] [MainThread]: On master: COMMIT
[0m07:28:16.556255 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:16.556496 [debug] [MainThread]: On master: COMMIT
[0m07:28:16.557152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:16.557796 [debug] [MainThread]: On master: Close
[0m07:28:16.565218 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:28:16.565896 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:28:16.566491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:28:16.566797 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:28:16.575613 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:28:16.576632 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:28:16.612422 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:28:16.613236 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:28:16.613588 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:28:16.613883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:16.624253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m07:28:16.624697 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:28:16.625033 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:28:16.635898 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:28:16.642139 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:28:16.642584 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:28:16.643394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:28:16.645945 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:28:16.646274 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:28:16.646962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:28:16.664534 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:28:16.665015 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:28:16.665412 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:28:16.673605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m07:28:16.680021 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:28:16.684241 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:28:16.684619 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:28:16.687913 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:28:16.690062 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:28:16.691823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c93781fa0>]}
[0m07:28:16.692714 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.12s]
[0m07:28:16.693674 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:28:16.694680 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:28:16.695194 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:28:16.695639 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:28:16.696594 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:28:16.696043 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:28:16.697028 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:28:16.697440 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:28:16.699971 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:28:16.700326 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:28:16.702473 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:28:16.702991 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:28:16.703274 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:28:16.705591 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:28:16.707608 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:28:16.708233 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:28:16.708576 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:28:16.708849 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:28:16.709253 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:28:16.709568 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:28:16.710024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:28:16.716000 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m07:28:16.716395 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:28:16.716649 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:28:16.719645 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m07:28:16.720166 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:28:16.720780 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:28:16.726653 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:28:16.730011 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:28:16.730410 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:28:16.731262 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:28:16.731792 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:28:16.734520 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:28:16.737458 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:28:16.737913 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:28:16.738293 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:28:16.739196 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:28:16.740576 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:28:16.740997 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:28:16.741346 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:28:16.743598 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:28:16.743929 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:28:16.744224 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:28:16.744907 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:28:16.746076 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:28:16.746403 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:28:16.746649 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:28:16.749654 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:28:16.751790 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:28:16.752196 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m07:28:16.752724 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:28:16.754499 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:28:16.754857 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:28:16.755424 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:28:16.755849 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:28:16.758497 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:28:16.759851 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:28:16.760475 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c902c6210>]}
[0m07:28:16.761098 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.06s]
[0m07:28:16.761567 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:28:16.763883 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m07:28:16.765065 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:28:16.765565 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024cb57e-1628-4bfe-9bee-f0384271d6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c902c01d0>]}
[0m07:28:16.766023 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m07:28:16.766433 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:28:16.768118 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:16.768387 [debug] [MainThread]: On master: BEGIN
[0m07:28:16.768605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:16.774270 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:28:16.774716 [debug] [MainThread]: On master: COMMIT
[0m07:28:16.774982 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:16.775230 [debug] [MainThread]: On master: COMMIT
[0m07:28:16.775731 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:16.776037 [debug] [MainThread]: On master: Close
[0m07:28:16.776500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:16.776752 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:28:16.777033 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:28:16.777871 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:28:16.778281 [info ] [MainThread]: 
[0m07:28:16.779176 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m07:28:16.780407 [debug] [MainThread]: Command end result
[0m07:28:16.798880 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:28:16.800562 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:28:16.805792 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:28:16.806128 [info ] [MainThread]: 
[0m07:28:16.806532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:28:16.807106 [info ] [MainThread]: 
[0m07:28:16.807432 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:28:16.808947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.136886, "process_in_blocks": "32", "process_kernel_time": 0.425109, "process_mem_max_rss": "108252", "process_out_blocks": "3400", "process_user_time": 2.015335}
[0m07:28:16.809507 [debug] [MainThread]: Command `dbt run` succeeded at 07:28:16.809410 after 1.14 seconds
[0m07:28:16.809877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c92eed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c92d62ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c92cbc110>]}
[0m07:28:16.810544 [debug] [MainThread]: Flushing usage events
[0m07:28:17.970623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:57:06.726508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69a94c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69af2e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69d551ca0>]}


============================== 07:57:06.741398 | 55002675-1734-4c0d-a15f-6f2a2ef5616f ==============================
[0m07:57:06.741398 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:57:06.743209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:57:07.106133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69aac1280>]}
[0m07:57:07.196413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69a82a090>]}
[0m07:57:07.199461 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:57:07.366348 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:57:07.513829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:57:07.514331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:57:07.562310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb698ed0f20>]}
[0m07:57:07.708226 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:57:07.712076 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:57:07.764329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb698de0380>]}
[0m07:57:07.765106 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:57:07.765653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb698d7ddf0>]}
[0m07:57:07.767759 [info ] [MainThread]: 
[0m07:57:07.768263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:57:07.768542 [info ] [MainThread]: 
[0m07:57:07.769176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:57:07.780689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:57:07.859813 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:57:07.860612 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:57:07.861296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:07.887036 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m07:57:07.889167 [debug] [ThreadPool]: On list_db: Close
[0m07:57:07.891711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:57:07.899683 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:57:07.900247 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:57:07.900554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:07.912350 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m07:57:07.913412 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:57:07.913838 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:57:07.922546 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m07:57:07.924522 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:57:07.925284 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:57:07.932008 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:07.932854 [debug] [MainThread]: On master: BEGIN
[0m07:57:07.933294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:57:07.940935 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:57:07.942164 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:07.942596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:57:07.952830 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m07:57:07.955172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69a8ddd60>]}
[0m07:57:07.956070 [debug] [MainThread]: On master: ROLLBACK
[0m07:57:07.957107 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:07.957538 [debug] [MainThread]: On master: BEGIN
[0m07:57:07.958445 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:57:07.959402 [debug] [MainThread]: On master: COMMIT
[0m07:57:07.959782 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:07.960079 [debug] [MainThread]: On master: COMMIT
[0m07:57:07.960778 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:57:07.961331 [debug] [MainThread]: On master: Close
[0m07:57:07.970363 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:57:07.971118 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:57:07.971793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:57:07.972205 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:57:07.983051 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:57:07.984796 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:57:08.030596 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:57:08.033004 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:57:08.034100 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:57:08.034969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:08.043682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:57:08.044667 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:57:08.045043 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:57:08.070947 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m07:57:08.077615 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:57:08.078110 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:57:08.079510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:57:08.083032 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:57:08.084241 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:57:08.087315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:57:08.116075 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:57:08.116752 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:57:08.117131 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:57:08.121545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:57:08.130722 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:57:08.136966 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:57:08.137692 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:57:08.144860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:57:08.148132 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:57:08.150281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69c80a5a0>]}
[0m07:57:08.150998 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m07:57:08.151852 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:57:08.154709 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:57:08.156045 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:57:08.156968 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:57:08.158626 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:57:08.159525 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:57:08.160075 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:57:08.160677 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:57:08.164038 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:57:08.164598 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:57:08.167639 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:57:08.168338 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:57:08.171252 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:57:08.172302 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:57:08.172890 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:57:08.173486 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:57:08.174185 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:57:08.178098 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:57:08.179649 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:57:08.180347 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:57:08.180676 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:57:08.192119 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m07:57:08.192741 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m07:57:08.193901 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:57:08.194486 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:57:08.195233 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:57:08.195783 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:57:08.206575 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m07:57:08.211459 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:57:08.212207 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:57:08.212786 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m07:57:08.213477 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:57:08.216415 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:57:08.219571 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:57:08.220055 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:57:08.220505 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:57:08.221779 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:57:08.222168 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:57:08.225452 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:57:08.227825 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:57:08.228369 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:57:08.228815 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:57:08.229872 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:57:08.230663 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:57:08.232440 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:57:08.232814 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:57:08.233195 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:57:08.239116 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m07:57:08.243077 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:57:08.243973 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:57:08.244363 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:57:08.252783 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m07:57:08.255952 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:57:08.256465 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m07:57:08.257223 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:57:08.258875 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:57:08.259417 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:57:08.260295 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb693e28320>]}
[0m07:57:08.261899 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m07:57:08.262501 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:57:08.266030 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:57:08.268078 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:57:08.268774 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55002675-1734-4c0d-a15f-6f2a2ef5616f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb693ee4bc0>]}
[0m07:57:08.269775 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.11s]
[0m07:57:08.272793 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:57:08.278398 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:08.278964 [debug] [MainThread]: On master: BEGIN
[0m07:57:08.279308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:57:08.288874 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:57:08.290085 [debug] [MainThread]: On master: COMMIT
[0m07:57:08.290642 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:08.290990 [debug] [MainThread]: On master: COMMIT
[0m07:57:08.291504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:57:08.291862 [debug] [MainThread]: On master: Close
[0m07:57:08.292886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:08.293256 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:57:08.293535 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:57:08.293788 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:57:08.294677 [info ] [MainThread]: 
[0m07:57:08.295467 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m07:57:08.296867 [debug] [MainThread]: Command end result
[0m07:57:08.322473 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:57:08.325131 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:57:08.334570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:57:08.335447 [info ] [MainThread]: 
[0m07:57:08.336029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:57:08.336413 [info ] [MainThread]: 
[0m07:57:08.337051 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:57:08.338713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6932507, "process_in_blocks": "1512", "process_kernel_time": 0.842992, "process_mem_max_rss": "107964", "process_out_blocks": "3384", "process_user_time": 2.877002}
[0m07:57:08.339500 [debug] [MainThread]: Command `dbt run` succeeded at 07:57:08.339330 after 1.69 seconds
[0m07:57:08.340554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69b1d8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69a8726f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb69ac1aed0>]}
[0m07:57:08.341400 [debug] [MainThread]: Flushing usage events
[0m07:57:09.632455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:01.188301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccad003ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccacd7d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccad003770>]}


============================== 08:57:01.218146 | bf04707c-2113-4e21-99e3-c8e043338e2e ==============================
[0m08:57:01.218146 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:57:01.220110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:57:01.793375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccac483200>]}
[0m08:57:01.914618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccac483a10>]}
[0m08:57:01.917326 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:57:02.066128 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:57:02.410039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:57:02.411033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:57:02.474386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccaac82990>]}
[0m08:57:02.598524 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:57:02.602349 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:57:02.757601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccaa96c6e0>]}
[0m08:57:02.758269 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m08:57:02.758709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccaa9864b0>]}
[0m08:57:02.763096 [info ] [MainThread]: 
[0m08:57:02.764399 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:57:02.765501 [info ] [MainThread]: 
[0m08:57:02.766597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:57:02.773645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m08:57:03.061814 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m08:57:03.062455 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m08:57:03.063337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:03.151211 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.088 seconds
[0m08:57:03.155134 [debug] [ThreadPool]: On list_db: Close
[0m08:57:03.157988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m08:57:03.164877 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m08:57:03.165459 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m08:57:03.166010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:03.176341 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:57:03.177216 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m08:57:03.177679 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:57:03.230230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m08:57:03.232399 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m08:57:03.233305 [debug] [ThreadPool]: On list_db_dev: Close
[0m08:57:03.240792 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:03.241423 [debug] [MainThread]: On master: BEGIN
[0m08:57:03.241751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:57:03.251141 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:57:03.252413 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:03.253923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:57:03.278902 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m08:57:03.281116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccac4ce0c0>]}
[0m08:57:03.281844 [debug] [MainThread]: On master: ROLLBACK
[0m08:57:03.282715 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:03.283154 [debug] [MainThread]: On master: BEGIN
[0m08:57:03.284005 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:57:03.284411 [debug] [MainThread]: On master: COMMIT
[0m08:57:03.284726 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:03.285073 [debug] [MainThread]: On master: COMMIT
[0m08:57:03.285839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:57:03.286534 [debug] [MainThread]: On master: Close
[0m08:57:03.293560 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m08:57:03.294490 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m08:57:03.295236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m08:57:03.295725 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m08:57:03.304080 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m08:57:03.309915 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m08:57:03.376945 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m08:57:03.426203 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:57:03.426752 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m08:57:03.427044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:57:03.440202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m08:57:03.440850 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:57:03.441292 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m08:57:03.502944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.061 seconds
[0m08:57:03.511816 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:57:03.512359 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m08:57:03.516700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:57:03.522265 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:57:03.523136 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m08:57:03.524380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:57:03.552750 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m08:57:03.553413 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:57:03.553800 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m08:57:03.558631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:57:03.569933 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m08:57:03.577599 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:57:03.578184 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m08:57:03.597033 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m08:57:03.599980 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m08:57:03.604975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccad0021e0>]}
[0m08:57:03.606391 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.31s]
[0m08:57:03.607893 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m08:57:03.609842 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m08:57:03.610576 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m08:57:03.611791 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m08:57:03.612970 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m08:57:03.613832 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m08:57:03.614583 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m08:57:03.615092 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m08:57:03.615638 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m08:57:03.619480 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m08:57:03.626696 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m08:57:03.628969 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m08:57:03.632509 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m08:57:03.633243 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m08:57:03.638168 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m08:57:03.640275 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m08:57:03.641075 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m08:57:03.641826 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:57:03.642932 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m08:57:03.643566 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m08:57:03.644255 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:57:03.654427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m08:57:03.655288 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m08:57:03.655678 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m08:57:03.665267 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m08:57:03.665898 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m08:57:03.666443 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m08:57:03.671719 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m08:57:03.679377 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m08:57:03.680379 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m08:57:03.683161 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:57:03.687577 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m08:57:03.688445 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m08:57:03.689180 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m08:57:03.694063 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m08:57:03.695429 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m08:57:03.697252 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:57:03.700638 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m08:57:03.701747 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:57:03.702613 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m08:57:03.707501 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m08:57:03.708274 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m08:57:03.709377 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m08:57:03.711832 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:57:03.713818 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m08:57:03.714297 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m08:57:03.714651 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m08:57:03.715454 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m08:57:03.719662 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m08:57:03.720474 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m08:57:03.721024 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m08:57:03.721473 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m08:57:03.724752 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m08:57:03.726781 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m08:57:03.728520 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m08:57:03.730378 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m08:57:03.734026 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m08:57:03.735144 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cca81eef90>]}
[0m08:57:03.736091 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m08:57:03.737176 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m08:57:03.739348 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m08:57:03.741209 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m08:57:03.742080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf04707c-2113-4e21-99e3-c8e043338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cca8243cb0>]}
[0m08:57:03.742850 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.13s]
[0m08:57:03.743595 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m08:57:03.747504 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:03.748380 [debug] [MainThread]: On master: BEGIN
[0m08:57:03.749000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:57:03.758009 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:57:03.759113 [debug] [MainThread]: On master: COMMIT
[0m08:57:03.759740 [debug] [MainThread]: Using postgres connection "master"
[0m08:57:03.760297 [debug] [MainThread]: On master: COMMIT
[0m08:57:03.761114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:57:03.761763 [debug] [MainThread]: On master: Close
[0m08:57:03.763023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:03.763729 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m08:57:03.764264 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m08:57:03.765097 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m08:57:03.766055 [info ] [MainThread]: 
[0m08:57:03.766508 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m08:57:03.767962 [debug] [MainThread]: Command end result
[0m08:57:03.792413 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:57:03.794789 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:57:03.802315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:57:03.802857 [info ] [MainThread]: 
[0m08:57:03.803327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:57:03.803679 [info ] [MainThread]: 
[0m08:57:03.804485 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:57:03.808211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7269483, "process_in_blocks": "41992", "process_kernel_time": 3.019285, "process_mem_max_rss": "107924", "process_out_blocks": "3384", "process_user_time": 3.660339}
[0m08:57:03.809316 [debug] [MainThread]: Command `dbt run` succeeded at 08:57:03.809054 after 2.73 seconds
[0m08:57:03.810032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccad020080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ccacd397f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cca8274260>]}
[0m08:57:03.810737 [debug] [MainThread]: Flushing usage events
[0m08:57:04.823199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:24.810852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776729735af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776727c0d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776727adcf50>]}


============================== 09:57:25.099226 | 7edcc48c-cae8-4fe7-9b0b-4422471d7a44 ==============================
[0m09:57:25.099226 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:57:25.100434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:57:28.678799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776728011400>]}
[0m09:57:29.346986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776727a9ff80>]}
[0m09:57:29.356462 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:30.326883 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:57:32.110798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:32.116873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:32.492220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776726017e00>]}
[0m09:57:34.506064 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:57:34.544020 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:57:35.596615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776725f89550>]}
[0m09:57:35.607193 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:57:35.649930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776725d1ddf0>]}
[0m09:57:35.713488 [info ] [MainThread]: 
[0m09:57:35.739806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:35.780114 [info ] [MainThread]: 
[0m09:57:35.794958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:35.914580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:57:38.167134 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:57:38.171966 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:57:38.187140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:38.631480 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.445 seconds
[0m09:57:38.653749 [debug] [ThreadPool]: On list_db: Close
[0m09:57:38.675870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:57:38.791903 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:57:38.797741 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:57:38.801749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:39.021684 [debug] [ThreadPool]: SQL status: BEGIN in 0.220 seconds
[0m09:57:39.027571 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:57:39.036089 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:57:39.242477 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.200 seconds
[0m09:57:39.282229 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:57:39.295232 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:57:39.420628 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:39.428027 [debug] [MainThread]: On master: BEGIN
[0m09:57:39.434581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:39.567335 [debug] [MainThread]: SQL status: BEGIN in 0.134 seconds
[0m09:57:39.568256 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:39.569111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:39.644717 [debug] [MainThread]: SQL status: SELECT 0 in 0.072 seconds
[0m09:57:39.667752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776725d1c9b0>]}
[0m09:57:39.674959 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:39.681106 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:39.686799 [debug] [MainThread]: On master: BEGIN
[0m09:57:39.698009 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:57:39.710660 [debug] [MainThread]: On master: COMMIT
[0m09:57:39.718451 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:39.723884 [debug] [MainThread]: On master: COMMIT
[0m09:57:39.734194 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:57:39.753238 [debug] [MainThread]: On master: Close
[0m09:57:39.846155 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:57:39.853823 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:57:39.861494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:57:39.871986 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:57:40.051690 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:57:40.121186 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:57:41.065119 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:57:41.066578 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:57:41.067706 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:57:41.068380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:41.139124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m09:57:41.146724 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:57:41.151135 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:57:41.330712 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.171 seconds
[0m09:57:41.483411 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:57:41.488502 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:57:41.509010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:57:41.598274 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:57:41.603297 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:57:41.626781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m09:57:41.993845 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:57:41.998574 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:57:42.003375 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:57:42.025033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m09:57:42.137560 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:57:42.259134 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:57:42.267142 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:57:42.386697 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.108 seconds
[0m09:57:42.442880 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:57:42.483410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767283cdf70>]}
[0m09:57:42.494712 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 2.59s]
[0m09:57:42.504854 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:57:42.544758 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:57:42.535760 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:57:42.607017 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:57:42.651336 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:57:42.676560 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:57:42.671594 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:57:42.687593 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:57:42.693289 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:57:42.770092 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:57:42.790563 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:57:42.803624 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:57:42.842447 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:57:42.856066 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:57:42.862830 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:57:42.864878 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:57:42.865745 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:57:42.866421 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:57:42.866942 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:57:42.867849 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:42.869050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:57:42.879117 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m09:57:42.880155 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:57:42.881094 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:57:42.906567 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m09:57:42.912749 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:57:42.919097 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:57:42.940778 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.057 seconds
[0m09:57:42.983477 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:57:42.989337 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:57:43.001865 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.066 seconds
[0m09:57:43.014101 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:57:43.110956 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:57:43.117943 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:57:43.122224 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:57:43.128654 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:57:43.141228 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:57:43.161213 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m09:57:43.168632 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:57:43.196111 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:57:43.206611 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:57:43.230714 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:57:43.238921 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:57:43.251996 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:57:43.265742 [debug] [Thread-3 (]: SQL status: COMMIT in 0.028 seconds
[0m09:57:43.331874 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:57:43.356948 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:57:43.372233 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:57:43.364087 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:57:43.387707 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:57:43.392613 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:57:43.405600 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m09:57:43.465856 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:57:43.474826 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.061 seconds
[0m09:57:43.519758 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:57:43.559325 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:57:43.566115 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:57:43.601831 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767245f79e0>]}
[0m09:57:43.633844 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.93s]
[0m09:57:43.620159 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.042 seconds
[0m09:57:43.662410 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:57:43.696340 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:57:43.706942 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edcc48c-cae8-4fe7-9b0b-4422471d7a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776724ee0680>]}
[0m09:57:43.714879 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 1.03s]
[0m09:57:43.723900 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:57:43.759653 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:43.776776 [debug] [MainThread]: On master: BEGIN
[0m09:57:43.784080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:43.870509 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m09:57:43.882167 [debug] [MainThread]: On master: COMMIT
[0m09:57:43.887112 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:43.895143 [debug] [MainThread]: On master: COMMIT
[0m09:57:43.902510 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m09:57:43.908108 [debug] [MainThread]: On master: Close
[0m09:57:43.913750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:43.918829 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:57:43.922416 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:57:43.927524 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:57:43.938286 [info ] [MainThread]: 
[0m09:57:43.944656 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.14 seconds (8.14s).
[0m09:57:43.963099 [debug] [MainThread]: Command end result
[0m09:57:44.537196 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:57:44.577957 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:57:44.691399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:57:44.698609 [info ] [MainThread]: 
[0m09:57:44.704794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:44.714256 [info ] [MainThread]: 
[0m09:57:44.729826 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:57:44.757116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.662462, "process_in_blocks": "19552", "process_kernel_time": 9.889131, "process_mem_max_rss": "106548", "process_out_blocks": "3392", "process_user_time": 29.25288}
[0m09:57:44.763570 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:44.762272 after 21.68 seconds
[0m09:57:44.769149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776727be4c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776727add4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776725cd1010>]}
[0m09:57:44.773737 [debug] [MainThread]: Flushing usage events
[0m09:57:46.071009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:21.949346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd9281f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd942687a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd9281f740>]}


============================== 11:07:21.963337 | f4efc884-9235-44d0-a854-43b477392ada ==============================
[0m11:07:21.963337 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:07:21.964145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:07:22.206954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd9236aae0>]}
[0m11:07:22.258395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd922b7bc0>]}
[0m11:07:22.259794 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:07:22.323144 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:07:22.458316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:22.458776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:22.488317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd90a6bad0>]}
[0m11:07:22.546818 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:07:22.549062 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:07:22.597301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd90740560>]}
[0m11:07:22.598374 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:07:22.599094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd9257ab70>]}
[0m11:07:22.601468 [info ] [MainThread]: 
[0m11:07:22.602147 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:22.602921 [info ] [MainThread]: 
[0m11:07:22.603666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:22.607499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:07:22.681255 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:07:22.681707 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:07:22.682052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:22.702834 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m11:07:22.704207 [debug] [ThreadPool]: On list_db: Close
[0m11:07:22.706352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:07:22.711516 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:07:22.711892 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:07:22.712108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:22.720429 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:07:22.721269 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:07:22.721864 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:07:22.732578 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m11:07:22.734174 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:07:22.734697 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:07:22.739149 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:22.739512 [debug] [MainThread]: On master: BEGIN
[0m11:07:22.739739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:22.746502 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:07:22.746965 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:22.747259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:07:22.752566 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:07:22.753882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd905dfd10>]}
[0m11:07:22.754369 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:22.754785 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:22.755030 [debug] [MainThread]: On master: BEGIN
[0m11:07:22.755458 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:07:22.755698 [debug] [MainThread]: On master: COMMIT
[0m11:07:22.755897 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:22.756249 [debug] [MainThread]: On master: COMMIT
[0m11:07:22.756709 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:22.757104 [debug] [MainThread]: On master: Close
[0m11:07:22.760492 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:07:22.761136 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m11:07:22.761586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:07:22.761853 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:07:22.767486 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:07:22.768255 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:07:22.794368 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:07:22.795174 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:07:22.795448 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:07:22.795670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:22.804013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:07:22.804419 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:07:22.804945 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m11:07:22.841520 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.036 seconds
[0m11:07:22.846899 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:07:22.847263 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:07:22.848519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:07:22.851121 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:07:22.851396 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:07:22.852083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:07:22.868635 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:07:22.869030 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:07:22.869274 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:07:22.872383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:07:22.882788 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:07:22.887487 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:07:22.887865 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:07:22.895187 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m11:07:22.897416 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:07:22.899618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd92dbe810>]}
[0m11:07:22.900211 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.14s]
[0m11:07:22.900681 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:07:22.901901 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m11:07:22.902862 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:07:22.903485 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m11:07:22.904191 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:07:22.904963 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m11:07:22.905441 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:07:22.905805 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m11:07:22.906132 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:07:22.909400 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m11:07:22.912509 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:07:22.913662 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m11:07:22.916384 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m11:07:22.917149 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:07:22.917538 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m11:07:22.917910 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:22.918625 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:07:22.922670 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:07:22.923507 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:07:22.923966 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:07:22.924250 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:07:22.930045 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m11:07:22.930514 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:07:22.930802 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m11:07:22.934238 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m11:07:22.934637 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:07:22.934952 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m11:07:22.941797 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m11:07:22.944970 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:07:22.945315 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m11:07:22.946037 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m11:07:22.946392 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:07:22.948958 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:07:22.951305 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:07:22.951850 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:07:22.952200 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m11:07:22.953319 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:07:22.955769 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:07:22.956119 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:07:22.956468 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:07:22.957651 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:07:22.957973 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:07:22.958347 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:07:22.959498 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:07:22.959938 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m11:07:22.960232 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:07:22.960769 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:07:22.963217 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m11:07:22.964806 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m11:07:22.965158 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m11:07:22.965630 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m11:07:22.968522 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:07:22.968912 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m11:07:22.969385 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:07:22.969848 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:07:22.972550 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:07:22.973716 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m11:07:22.973980 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:07:22.974526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd8f9bfe30>]}
[0m11:07:22.975526 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:07:22.976057 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.07s]
[0m11:07:22.976816 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4efc884-9235-44d0-a854-43b477392ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd8f908260>]}
[0m11:07:22.977476 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m11:07:22.978039 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.07s]
[0m11:07:22.979026 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:07:22.980959 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:22.981403 [debug] [MainThread]: On master: BEGIN
[0m11:07:22.981675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:22.987542 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:07:22.987884 [debug] [MainThread]: On master: COMMIT
[0m11:07:22.988110 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:22.988318 [debug] [MainThread]: On master: COMMIT
[0m11:07:22.988813 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:22.989119 [debug] [MainThread]: On master: Close
[0m11:07:22.989524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:22.989748 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:07:22.989936 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m11:07:22.990113 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:07:22.990469 [info ] [MainThread]: 
[0m11:07:22.990769 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:07:22.991479 [debug] [MainThread]: Command end result
[0m11:07:23.007288 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:07:23.008921 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:07:23.013586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:07:23.013890 [info ] [MainThread]: 
[0m11:07:23.014198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:23.014439 [info ] [MainThread]: 
[0m11:07:23.014699 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:07:23.016215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1183387, "process_in_blocks": "14592", "process_kernel_time": 0.73053, "process_mem_max_rss": "106936", "process_out_blocks": "3392", "process_user_time": 1.793472}
[0m11:07:23.016660 [debug] [MainThread]: Command `dbt run` succeeded at 11:07:23.016569 after 1.12 seconds
[0m11:07:23.016982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd92ddef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd92ddc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd92ddd100>]}
[0m11:07:23.017290 [debug] [MainThread]: Flushing usage events
[0m11:07:23.947376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:32.537838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b8b016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36ba544380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36ba5fe720>]}


============================== 12:07:32.548560 | 6c54970e-4e33-4457-9647-acda853a44ff ==============================
[0m12:07:32.548560 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:07:32.550390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:07:32.928620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b8559760>]}
[0m12:07:33.061450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b876bf20>]}
[0m12:07:33.062996 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:33.226349 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:07:33.409880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:33.410732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:33.460050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b6d2ce60>]}
[0m12:07:33.546239 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:07:33.552923 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:07:33.598231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b6a188c0>]}
[0m12:07:33.600331 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:07:33.601242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b6d101a0>]}
[0m12:07:33.603842 [info ] [MainThread]: 
[0m12:07:33.604295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:33.604553 [info ] [MainThread]: 
[0m12:07:33.605055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:33.608952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:07:33.707275 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:07:33.708257 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:07:33.708679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:33.736062 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m12:07:33.737931 [debug] [ThreadPool]: On list_db: Close
[0m12:07:33.740645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:07:33.746243 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:07:33.746616 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:07:33.746843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:33.765942 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m12:07:33.766618 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:07:33.766944 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:07:33.777639 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m12:07:33.779306 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:07:33.780006 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:07:33.786066 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:33.786504 [debug] [MainThread]: On master: BEGIN
[0m12:07:33.786799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:33.794803 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:07:33.795340 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:33.795752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:33.805887 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:07:33.807689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b6d2eab0>]}
[0m12:07:33.808366 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:33.809277 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:33.809650 [debug] [MainThread]: On master: BEGIN
[0m12:07:33.810789 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:07:33.813548 [debug] [MainThread]: On master: COMMIT
[0m12:07:33.814258 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:33.814671 [debug] [MainThread]: On master: COMMIT
[0m12:07:33.815557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:33.815958 [debug] [MainThread]: On master: Close
[0m12:07:33.820843 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:07:33.821562 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:07:33.822139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:07:33.822513 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:07:33.831221 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:07:33.832767 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:07:33.876511 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:07:33.878182 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:33.878853 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:07:33.879628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:33.887864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:07:33.888523 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:33.888901 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m12:07:33.904407 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.015 seconds
[0m12:07:33.912314 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:33.913635 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:07:33.915669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:33.918724 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:33.919136 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:07:33.919903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:07:33.940854 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:07:33.941599 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:33.941967 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:07:33.944873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:07:33.953164 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:07:33.959291 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:33.959828 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:07:33.968204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:07:33.971803 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:07:33.974331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b90924e0>]}
[0m12:07:33.975056 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 2[0m in 0.15s]
[0m12:07:33.975681 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:07:33.977202 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m12:07:33.977700 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:07:33.978413 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m12:07:33.979231 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:07:33.980049 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m12:07:33.980666 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:07:33.981339 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m12:07:33.981982 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:07:33.985465 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m12:07:33.989053 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:07:33.989958 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m12:07:33.992959 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m12:07:33.993634 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:07:33.996818 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:07:33.997311 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:33.997857 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m12:07:33.998200 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:07:33.999148 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:34.002873 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:07:34.003495 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:07:34.011183 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m12:07:34.012055 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:34.012459 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:07:34.014980 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m12:07:34.015452 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:34.015964 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m12:07:34.037866 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.025 seconds
[0m12:07:34.041273 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:34.041758 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m12:07:34.042203 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.026 seconds
[0m12:07:34.045456 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:34.045877 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:07:34.046361 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:07:34.049169 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:34.049796 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m12:07:34.050436 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:34.050779 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:34.053818 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:34.055711 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m12:07:34.056279 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:07:34.056706 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:34.057355 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m12:07:34.057847 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:34.059339 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:07:34.059702 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:34.060177 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:07:34.066023 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m12:07:34.068906 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m12:07:34.069387 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m12:07:34.070170 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:34.073135 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:07:34.073697 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m12:07:34.074408 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:34.075010 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:07:34.080599 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:07:34.084224 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m12:07:34.085050 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b5bd4da0>]}
[0m12:07:34.085705 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 2[0m in 0.11s]
[0m12:07:34.086459 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m12:07:34.087010 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m12:07:34.088691 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:07:34.089443 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c54970e-4e33-4457-9647-acda853a44ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b5ba8b60>]}
[0m12:07:34.090076 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 2[0m in 0.11s]
[0m12:07:34.090659 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:07:34.093442 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:34.093864 [debug] [MainThread]: On master: BEGIN
[0m12:07:34.094291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:34.101689 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:07:34.102874 [debug] [MainThread]: On master: COMMIT
[0m12:07:34.103229 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:34.103676 [debug] [MainThread]: On master: COMMIT
[0m12:07:34.105541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:34.105927 [debug] [MainThread]: On master: Close
[0m12:07:34.106467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:34.106769 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:07:34.107045 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m12:07:34.107304 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:07:34.107827 [info ] [MainThread]: 
[0m12:07:34.108356 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m12:07:34.109465 [debug] [MainThread]: Command end result
[0m12:07:34.134866 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:07:34.138125 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:07:34.146789 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:07:34.147247 [info ] [MainThread]: 
[0m12:07:34.147697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:34.148090 [info ] [MainThread]: 
[0m12:07:34.148468 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:07:34.150352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.709113, "process_in_blocks": "12368", "process_kernel_time": 1.018312, "process_mem_max_rss": "107120", "process_out_blocks": "3384", "process_user_time": 2.774023}
[0m12:07:34.150979 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:34.150852 after 1.71 seconds
[0m12:07:34.151436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36ba544380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b90b08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d36b90b12b0>]}
[0m12:07:34.151834 [debug] [MainThread]: Flushing usage events
[0m12:07:35.354404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:37.607842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d1ef0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d28fb680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d28f8d70>]}


============================== 12:07:37.619221 | 6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb ==============================
[0m12:07:37.619221 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:07:37.620313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:37.978322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d2327650>]}
[0m12:07:38.053190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d25da240>]}
[0m12:07:38.069578 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:38.189646 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:07:38.341086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:38.341886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:38.399620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d1c711c0>]}
[0m12:07:38.486311 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:07:38.489963 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:07:38.515684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d009b7a0>]}
[0m12:07:38.516335 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:07:38.516730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d03e6a50>]}
[0m12:07:38.518711 [info ] [MainThread]: 
[0m12:07:38.519184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:38.519518 [info ] [MainThread]: 
[0m12:07:38.521505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:38.526647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:07:38.587828 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:07:38.588755 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:07:38.589152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:38.616809 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m12:07:38.619295 [debug] [ThreadPool]: On list_db: Close
[0m12:07:38.624271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:07:38.632421 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:07:38.632947 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:07:38.633298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:38.642406 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:07:38.642923 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:07:38.643250 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:07:38.660111 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m12:07:38.661925 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:07:38.662684 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:07:38.669854 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.670384 [debug] [MainThread]: On master: BEGIN
[0m12:07:38.670664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:38.681720 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:07:38.682294 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.682695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:38.687103 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:07:38.688863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d0332ba0>]}
[0m12:07:38.689438 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:38.690669 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.691538 [debug] [MainThread]: On master: BEGIN
[0m12:07:38.693974 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:07:38.697639 [debug] [MainThread]: On master: COMMIT
[0m12:07:38.698497 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.698912 [debug] [MainThread]: On master: COMMIT
[0m12:07:38.699637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:38.700157 [debug] [MainThread]: On master: Close
[0m12:07:38.704530 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:07:38.705275 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:07:38.705832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:07:38.706190 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:07:38.714620 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:07:38.715504 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:07:38.756436 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:07:38.757940 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:38.760709 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:07:38.761063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:38.769438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:07:38.769978 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:38.770303 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m12:07:38.789112 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m12:07:38.796856 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:38.797435 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:07:38.798389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:38.801463 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:38.801857 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:07:38.802546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:07:38.822562 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:07:38.823297 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:38.823686 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:07:38.827223 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:07:38.837577 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:07:38.845902 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:07:38.847203 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:07:38.855104 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:07:38.858687 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:07:38.860821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d2735ee0>]}
[0m12:07:38.861583 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 2[0m in 0.15s]
[0m12:07:38.862217 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:07:38.865017 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m12:07:38.865625 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m12:07:38.866219 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m12:07:38.866555 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m12:07:38.869612 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m12:07:38.870346 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m12:07:38.870939 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:07:38.874814 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m12:07:38.875549 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:07:38.877245 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:07:38.877646 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:07:38.881320 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:07:38.882238 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:07:38.885973 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:07:38.886715 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:38.887407 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m12:07:38.887896 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:07:38.888644 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:38.889062 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:07:38.889481 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:07:38.896666 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m12:07:38.897234 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:38.897606 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:07:38.898293 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m12:07:38.898645 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:38.898958 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m12:07:38.908190 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.010 seconds
[0m12:07:38.912810 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:38.913334 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.014 seconds
[0m12:07:38.913849 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m12:07:38.916730 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:38.917381 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:07:38.918545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:38.921413 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:38.921834 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:07:38.922202 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:07:38.925418 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:38.926087 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m12:07:38.926737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:38.927170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:38.929061 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:07:38.930692 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m12:07:38.931190 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:38.931602 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:38.932066 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:07:38.932510 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m12:07:38.940746 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m12:07:38.943386 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:07:38.943895 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m12:07:38.944692 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:07:38.946901 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m12:07:38.948734 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:07:38.949908 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m12:07:38.952585 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m12:07:38.956387 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:07:38.959118 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:07:38.959652 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:07:38.960622 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23cf274e60>]}
[0m12:07:38.962354 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m12:07:38.963182 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 2[0m in 0.08s]
[0m12:07:38.964153 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9e14ad-b0b6-4285-a1dc-3ae0558b1dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23cf274fe0>]}
[0m12:07:38.964782 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:07:38.965459 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 2[0m in 0.10s]
[0m12:07:38.966450 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m12:07:38.969043 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.969486 [debug] [MainThread]: On master: BEGIN
[0m12:07:38.969794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:38.978831 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:07:38.979571 [debug] [MainThread]: On master: COMMIT
[0m12:07:38.980075 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.980455 [debug] [MainThread]: On master: COMMIT
[0m12:07:38.981083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:38.981515 [debug] [MainThread]: On master: Close
[0m12:07:38.982296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:38.982631 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:07:38.982893 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m12:07:38.983140 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:07:38.983553 [info ] [MainThread]: 
[0m12:07:38.984196 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:07:38.985207 [debug] [MainThread]: Command end result
[0m12:07:39.007416 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:07:39.010254 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:07:39.017631 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:07:39.018034 [info ] [MainThread]: 
[0m12:07:39.018467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:39.018950 [info ] [MainThread]: 
[0m12:07:39.019382 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:07:39.021443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4864541, "process_in_blocks": "10192", "process_kernel_time": 0.623295, "process_mem_max_rss": "107048", "process_out_blocks": "3376", "process_user_time": 3.017225}
[0m12:07:39.022255 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:39.022090 after 1.49 seconds
[0m12:07:39.022761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d2007c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d300c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23d26af6e0>]}
[0m12:07:39.023192 [debug] [MainThread]: Flushing usage events
[0m12:07:40.197392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:58:48.199401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6c4ca7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6c12cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6dec0290>]}


============================== 06:58:48.209042 | 0e481282-a0f5-46b7-8800-cf26e6305fe1 ==============================
[0m06:58:48.209042 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:58:48.209503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:58:48.449033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e481282-a0f5-46b7-8800-cf26e6305fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6bf92b70>]}
[0m06:58:48.500179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e481282-a0f5-46b7-8800-cf26e6305fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6da1cbc0>]}
[0m06:58:48.503145 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:58:48.567126 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:58:48.696845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:58:48.697265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:58:48.726145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e481282-a0f5-46b7-8800-cf26e6305fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6c4c91c0>]}
[0m06:58:48.789167 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:58:48.792189 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:58:48.825714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e481282-a0f5-46b7-8800-cf26e6305fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6a5cb020>]}
[0m06:58:48.826161 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:58:48.826487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e481282-a0f5-46b7-8800-cf26e6305fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6a384bc0>]}
[0m06:58:48.827901 [info ] [MainThread]: 
[0m06:58:48.828231 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:58:48.828492 [info ] [MainThread]: 
[0m06:58:48.828925 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:58:48.832709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:58:48.887754 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:58:48.888154 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:58:48.888397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:48.934824 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m06:58:48.956063 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:58:48.956711 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:58:48.957510 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m06:58:48.958085 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:58:48.958595 [debug] [ThreadPool]: On list_db: No close available on handle
[0m06:58:48.959920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:48.960624 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m06:58:48.961213 [info ] [MainThread]: 
[0m06:58:48.961848 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m06:58:48.962677 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m06:58:48.964756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.80936855, "process_in_blocks": "102368", "process_kernel_time": 0.313698, "process_mem_max_rss": "103640", "process_out_blocks": "2472", "process_user_time": 1.51427}
[0m06:58:48.965280 [debug] [MainThread]: Command `dbt run` failed at 06:58:48.965164 after 0.81 seconds
[0m06:58:48.965629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6c35ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6a20bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735e6a5c8590>]}
[0m06:58:48.965939 [debug] [MainThread]: Flushing usage events
[0m06:58:50.218430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:08:12.254211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c715ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c68e27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c64d8320>]}


============================== 07:08:12.261666 | 6a949594-3e3e-4edf-9e25-33a104f56c9c ==============================
[0m07:08:12.261666 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:08:12.262107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:08:12.488066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a949594-3e3e-4edf-9e25-33a104f56c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c6445490>]}
[0m07:08:12.540344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a949594-3e3e-4edf-9e25-33a104f56c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c69753a0>]}
[0m07:08:12.542529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:08:12.609289 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:08:12.741327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:08:12.741723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:08:12.771137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a949594-3e3e-4edf-9e25-33a104f56c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c6b6a7b0>]}
[0m07:08:12.836383 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:08:12.839163 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:08:12.870833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a949594-3e3e-4edf-9e25-33a104f56c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c490f860>]}
[0m07:08:12.871268 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:08:12.871582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a949594-3e3e-4edf-9e25-33a104f56c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c4912960>]}
[0m07:08:12.873878 [info ] [MainThread]: 
[0m07:08:12.874903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:08:12.875716 [info ] [MainThread]: 
[0m07:08:12.876772 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:08:12.880416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:08:12.924039 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:08:12.924464 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:08:12.924728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:12.949054 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m07:08:12.977570 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:08:12.978204 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:08:12.978698 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:08:12.979089 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:08:12.979473 [debug] [ThreadPool]: On list_db: No close available on handle
[0m07:08:12.980473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:08:12.980895 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m07:08:12.981305 [info ] [MainThread]: 
[0m07:08:12.981838 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m07:08:12.982339 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m07:08:12.986501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7757145, "process_in_blocks": "94184", "process_kernel_time": 0.309155, "process_mem_max_rss": "102876", "process_out_blocks": "2480", "process_user_time": 1.496162}
[0m07:08:12.987103 [debug] [MainThread]: Command `dbt run` failed at 07:08:12.986992 after 0.78 seconds
[0m07:08:12.987475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c70e9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c492e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7297c4915e20>]}
[0m07:08:12.987822 [debug] [MainThread]: Flushing usage events
[0m07:08:13.914634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:09:05.847637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512025ef380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512021df980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512030edcd0>]}


============================== 07:09:05.850921 | 48078272-6318-43e5-bf70-8f4d0efd16f4 ==============================
[0m07:09:05.850921 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:09:05.851420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:09:06.010802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48078272-6318-43e5-bf70-8f4d0efd16f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120216bc20>]}
[0m07:09:06.064081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48078272-6318-43e5-bf70-8f4d0efd16f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751203e0b2f0>]}
[0m07:09:06.064941 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:09:06.122934 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:09:06.209269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:06.209666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:06.239348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48078272-6318-43e5-bf70-8f4d0efd16f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751200849160>]}
[0m07:09:06.301205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:09:06.303323 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:09:06.319281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48078272-6318-43e5-bf70-8f4d0efd16f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7512005386e0>]}
[0m07:09:06.319755 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:09:06.320062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48078272-6318-43e5-bf70-8f4d0efd16f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751200511790>]}
[0m07:09:06.321481 [info ] [MainThread]: 
[0m07:09:06.321819 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:09:06.322566 [info ] [MainThread]: 
[0m07:09:06.323053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:09:06.327449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:09:06.364137 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:09:06.364620 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:09:06.364899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:06.391736 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m07:09:06.411172 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:09:06.411803 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:09:06.412130 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:09:06.412356 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:09:06.412591 [debug] [ThreadPool]: On list_db: No close available on handle
[0m07:09:06.413309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:06.413607 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m07:09:06.413916 [info ] [MainThread]: 
[0m07:09:06.414356 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m07:09:06.414861 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m07:09:06.415912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.64992017, "process_in_blocks": "0", "process_kernel_time": 0.289886, "process_mem_max_rss": "102968", "process_out_blocks": "864", "process_user_time": 1.341655}
[0m07:09:06.416502 [debug] [MainThread]: Command `dbt run` failed at 07:09:06.416307 after 0.65 seconds
[0m07:09:06.416876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751202a70440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120093a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751200535ac0>]}
[0m07:09:06.417245 [debug] [MainThread]: Flushing usage events
[0m07:09:07.352787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:35:15.852389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084ac4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084ac4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084ac58e0>]}


============================== 07:35:15.867114 | bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb ==============================
[0m07:35:15.867114 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:35:15.867601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:35:16.303025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc082bf1670>]}
[0m07:35:16.360873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084ac48c0>]}
[0m07:35:16.361805 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:35:16.535636 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:35:16.668448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:35:16.668876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:35:16.701504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc082cadf10>]}
[0m07:35:16.846096 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:35:16.848578 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:35:16.890293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0844a7fb0>]}
[0m07:35:16.891287 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:35:16.891926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0845dc8c0>]}
[0m07:35:16.894091 [info ] [MainThread]: 
[0m07:35:16.894653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:35:16.895197 [info ] [MainThread]: 
[0m07:35:16.896150 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:35:16.913918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:35:16.991815 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:35:16.992242 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:35:16.992522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:17.057715 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.065 seconds
[0m07:35:17.059126 [debug] [ThreadPool]: On list_db: Close
[0m07:35:17.061264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:35:17.067016 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:35:17.067428 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:35:17.067729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:35:17.076089 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:35:17.076614 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:35:17.076971 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:35:17.099618 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m07:35:17.100955 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:35:17.101576 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:35:17.107741 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.108075 [debug] [MainThread]: On master: BEGIN
[0m07:35:17.108303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:35:17.114221 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:35:17.114722 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.115175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:35:17.129825 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m07:35:17.131203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc082ac4830>]}
[0m07:35:17.131686 [debug] [MainThread]: On master: ROLLBACK
[0m07:35:17.132203 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.132527 [debug] [MainThread]: On master: BEGIN
[0m07:35:17.133174 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:35:17.133689 [debug] [MainThread]: On master: COMMIT
[0m07:35:17.134177 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.134658 [debug] [MainThread]: On master: COMMIT
[0m07:35:17.135268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:35:17.135538 [debug] [MainThread]: On master: Close
[0m07:35:17.139757 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:35:17.140384 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:35:17.140889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:35:17.141228 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:35:17.147230 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:35:17.148636 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:35:17.198768 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:35:17.200025 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:35:17.200534 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:35:17.200898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:17.212335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m07:35:17.213815 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:35:17.215138 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:35:17.242087 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.026 seconds
[0m07:35:17.247751 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:35:17.248191 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:35:17.249585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:35:17.252031 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:35:17.252337 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:35:17.252904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:35:17.269041 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:35:17.269540 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:35:17.269873 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:35:17.279417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m07:35:17.291701 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:35:17.299522 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:35:17.300039 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:35:17.311385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m07:35:17.317075 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:35:17.322432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084ffe270>]}
[0m07:35:17.323450 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 5[0m in 0.18s]
[0m07:35:17.323951 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:35:17.325022 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:35:17.325735 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:35:17.325438 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:35:17.326296 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:35:17.326908 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:35:17.327369 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:35:17.327708 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:35:17.328015 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:35:17.330751 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:35:17.332795 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:35:17.333588 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:35:17.336060 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:35:17.336856 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:35:17.339409 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:35:17.339882 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:35:17.340270 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:35:17.340520 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:35:17.340836 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:35:17.341353 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:35:17.341620 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:35:17.348744 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m07:35:17.350031 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:35:17.350837 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m07:35:17.351199 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:35:17.351537 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:35:17.352175 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:35:17.363516 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.011 seconds
[0m07:35:17.366516 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:35:17.366926 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m07:35:17.367737 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.016 seconds
[0m07:35:17.368177 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:35:17.371803 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:35:17.374862 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:35:17.375399 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m07:35:17.375744 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:35:17.376782 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:35:17.377557 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:35:17.380232 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:35:17.381628 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:35:17.381990 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:35:17.382299 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:35:17.382833 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:35:17.383245 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:35:17.386920 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:35:17.387420 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m07:35:17.387778 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:35:17.389759 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:35:17.390133 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:35:17.391248 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:35:17.392071 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:35:17.394153 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m07:35:17.397562 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:35:17.398407 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:35:17.398904 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:35:17.399265 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:35:17.400501 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:35:17.402082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc081b19d90>]}
[0m07:35:17.403653 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 5[0m in 0.07s]
[0m07:35:17.404898 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:35:17.405320 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:35:17.406702 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:35:17.407564 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc0f1c2-e16a-4926-9fb4-cff4d00e00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc081bdcb90>]}
[0m07:35:17.408160 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.08s]
[0m07:35:17.408592 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:35:17.411466 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.411834 [debug] [MainThread]: On master: BEGIN
[0m07:35:17.412062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:35:17.418079 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:35:17.418749 [debug] [MainThread]: On master: COMMIT
[0m07:35:17.419193 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.419606 [debug] [MainThread]: On master: COMMIT
[0m07:35:17.420349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:35:17.420800 [debug] [MainThread]: On master: Close
[0m07:35:17.421514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:17.421951 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:35:17.422365 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:35:17.422907 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:35:17.423417 [info ] [MainThread]: 
[0m07:35:17.424418 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m07:35:17.426041 [debug] [MainThread]: Command end result
[0m07:35:17.452192 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:35:17.454529 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:35:17.462211 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:35:17.463067 [info ] [MainThread]: 
[0m07:35:17.463888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:35:17.464930 [info ] [MainThread]: 
[0m07:35:17.465560 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:35:17.468244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6823933, "process_in_blocks": "12256", "process_kernel_time": 1.142048, "process_mem_max_rss": "107576", "process_out_blocks": "3392", "process_user_time": 2.41378}
[0m07:35:17.468967 [debug] [MainThread]: Command `dbt run` succeeded at 07:35:17.468818 after 1.68 seconds
[0m07:35:17.469443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084972ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0846d67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0846d6210>]}
[0m07:35:17.469883 [debug] [MainThread]: Flushing usage events
[0m07:35:18.403904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:26:23.101348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf52a23620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf52a22f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf53a4a1b0>]}


============================== 09:26:23.250017 | 79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4 ==============================
[0m09:26:23.250017 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:26:23.258908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:26:23.690512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf5241b6b0>]}
[0m09:26:23.774963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf52438110>]}
[0m09:26:23.776653 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:26:23.953163 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:26:24.121286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:26:24.121958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:26:24.170849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf525986b0>]}
[0m09:26:24.304528 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:26:24.314069 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:26:24.367869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf509da300>]}
[0m09:26:24.368717 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:26:24.369432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf50bdd4c0>]}
[0m09:26:24.372183 [info ] [MainThread]: 
[0m09:26:24.373124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:26:24.374053 [info ] [MainThread]: 
[0m09:26:24.375604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:26:24.381300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:26:24.491740 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:26:24.492284 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:26:24.492603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:24.541131 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.048 seconds
[0m09:26:24.542917 [debug] [ThreadPool]: On list_db: Close
[0m09:26:24.545618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:26:24.551807 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:26:24.552222 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:26:24.552517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:24.560042 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:26:24.560474 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:26:24.560779 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:26:24.572099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m09:26:24.573716 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:26:24.574529 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:26:24.581616 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:24.582141 [debug] [MainThread]: On master: BEGIN
[0m09:26:24.582490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:24.589755 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:26:24.590168 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:24.590560 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:26:24.603003 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m09:26:24.604852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf5380fd10>]}
[0m09:26:24.605414 [debug] [MainThread]: On master: ROLLBACK
[0m09:26:24.606009 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:24.606405 [debug] [MainThread]: On master: BEGIN
[0m09:26:24.607398 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:26:24.607870 [debug] [MainThread]: On master: COMMIT
[0m09:26:24.608172 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:24.608456 [debug] [MainThread]: On master: COMMIT
[0m09:26:24.608955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:26:24.609297 [debug] [MainThread]: On master: Close
[0m09:26:24.613988 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:26:24.614851 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:26:24.615356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:26:24.615747 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:26:24.623293 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:26:24.624545 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:26:24.667643 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:26:24.669934 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:24.670920 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:26:24.672035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:24.680081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:26:24.680762 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:24.681184 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:26:24.711133 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.029 seconds
[0m09:26:24.718930 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:24.719501 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:26:24.720686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:24.723783 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:24.724337 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:26:24.725730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:24.749489 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:26:24.750243 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:24.750868 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:26:24.755185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:26:24.762699 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:26:24.768982 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:24.769399 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:26:24.781980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:26:24.784985 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:26:24.787827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf52fba8a0>]}
[0m09:26:24.788622 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.17s]
[0m09:26:24.789262 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:26:24.790404 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:26:24.791437 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:26:24.791008 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:26:24.792343 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:26:24.793429 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:26:24.793993 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:26:24.794508 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:26:24.794941 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:26:24.798226 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:26:24.801186 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:26:24.802747 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:26:24.805694 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:26:24.806912 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:24.807584 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:26:24.807969 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:26:24.811148 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:26:24.811626 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:26:24.812595 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:24.812952 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:26:24.813236 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:26:24.821439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m09:26:24.822180 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:24.822787 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:26:24.830920 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m09:26:24.831373 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:24.831727 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:26:24.835801 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.012 seconds
[0m09:26:24.839282 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:24.840251 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:26:24.841750 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:24.854807 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.022 seconds
[0m09:26:24.862352 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:24.864147 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:24.864797 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:26:24.865353 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:26:24.866917 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:24.869345 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:26:24.869833 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:24.870234 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:26:24.870801 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:26:24.877452 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:24.878158 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m09:26:24.878714 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:26:24.881398 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:26:24.882578 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:24.883057 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:24.883492 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:26:24.885416 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:26:24.886254 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:24.886958 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:26:24.890570 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:26:24.893294 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:26:24.893827 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m09:26:24.023180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf4c9ff830>]}
[0m09:26:24.026485 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:26:24.027549 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in -0.77s]
[0m09:26:24.028902 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:24.030141 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:26:24.030736 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:26:24.035878 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:26:24.037591 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:26:24.038319 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79cdb7fb-7eb1-4a84-bf36-1e3a6327b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf507cbe90>]}
[0m09:26:24.038989 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in -0.76s]
[0m09:26:24.039688 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:26:24.042550 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:24.042927 [debug] [MainThread]: On master: BEGIN
[0m09:26:24.043231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:24.050592 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:26:24.051093 [debug] [MainThread]: On master: COMMIT
[0m09:26:24.051428 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:24.051829 [debug] [MainThread]: On master: COMMIT
[0m09:26:24.052345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:26:24.052688 [debug] [MainThread]: On master: Close
[0m09:26:24.053204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:24.053514 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:26:24.053780 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:26:24.054033 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:26:24.054652 [info ] [MainThread]: 
[0m09:26:24.055068 [info ] [MainThread]: Finished running 3 table models in -1 hours 59 minutes and 59.68 seconds (-0.32s).
[0m09:26:24.056105 [debug] [MainThread]: Command end result
[0m09:26:24.082373 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:26:24.087341 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:26:24.096813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:26:24.097271 [info ] [MainThread]: 
[0m09:26:24.097747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:26:24.098949 [info ] [MainThread]: 
[0m09:26:24.099862 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:26:24.105812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9648117, "process_in_blocks": "52960", "process_kernel_time": 1.463989, "process_mem_max_rss": "107176", "process_out_blocks": "3392", "process_user_time": 3.14043}
[0m09:26:24.106989 [debug] [MainThread]: Command `dbt run` succeeded at 09:26:24.106795 after 1.97 seconds
[0m09:26:24.107904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf52c138f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf50c88590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cf50c42ff0>]}
[0m09:26:24.108628 [debug] [MainThread]: Flushing usage events
[0m09:26:23.884380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:26:31.142853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c3933ffe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c393a9fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c393a9ef60>]}


============================== 09:26:31.153804 | 8ff15506-946e-4991-8e42-e6bd9fc9cf98 ==============================
[0m09:26:31.153804 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:26:31.155112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:26:31.462270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c392f3e5d0>]}
[0m09:26:31.546346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c393b33680>]}
[0m09:26:31.548107 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:26:31.672055 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:26:31.968043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:26:31.968580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:26:32.012945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c39163bad0>]}
[0m09:26:32.121743 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:26:32.130860 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:26:32.192708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c3913777d0>]}
[0m09:26:32.194080 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:26:32.195669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c3913105f0>]}
[0m09:26:32.198626 [info ] [MainThread]: 
[0m09:26:32.199442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:26:32.200377 [info ] [MainThread]: 
[0m09:26:32.201710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:26:32.206464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:26:32.283848 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:26:32.284462 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:26:32.284794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:32.310138 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m09:26:32.311917 [debug] [ThreadPool]: On list_db: Close
[0m09:26:32.314820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:26:32.323326 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:26:32.324378 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:26:32.324959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:32.335611 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:26:32.336110 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:26:32.336407 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:26:32.344231 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:26:32.345969 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:26:32.346976 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:26:32.353886 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:32.354306 [debug] [MainThread]: On master: BEGIN
[0m09:26:32.354616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:32.363559 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:26:32.364081 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:32.364671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:26:32.370382 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:26:32.372437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c391377cb0>]}
[0m09:26:32.373192 [debug] [MainThread]: On master: ROLLBACK
[0m09:26:32.373985 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:32.374378 [debug] [MainThread]: On master: BEGIN
[0m09:26:32.375632 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:26:32.376060 [debug] [MainThread]: On master: COMMIT
[0m09:26:32.376381 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:32.376681 [debug] [MainThread]: On master: COMMIT
[0m09:26:32.377205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:26:32.377635 [debug] [MainThread]: On master: Close
[0m09:26:32.383257 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:26:32.384047 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:26:32.384603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:26:32.384960 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:26:32.394441 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:26:32.395342 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:26:32.484105 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:26:32.485736 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:32.486439 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:26:32.486930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:32.499059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:26:32.499834 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:32.500334 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:26:32.517998 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.017 seconds
[0m09:26:32.528910 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:32.529661 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:26:32.530856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:32.535227 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:32.536130 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:26:32.537121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:32.559654 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:26:32.560222 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:32.560586 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:26:32.564811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:26:32.574667 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:26:32.580700 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:26:32.581186 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:26:32.586122 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:26:32.589074 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:26:32.591850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c394dba600>]}
[0m09:26:32.592608 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.21s]
[0m09:26:32.594477 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:26:32.596186 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:26:32.596839 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:26:32.598578 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:26:32.599331 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:26:32.600092 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:26:32.600670 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:26:32.601234 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:26:32.601681 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:26:32.604987 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:26:32.608254 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:26:32.609554 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:26:32.613667 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:26:32.614664 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:26:32.618535 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:26:32.619492 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:32.619940 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:32.620402 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:26:32.620848 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:26:32.621290 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:26:32.621743 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:26:32.712846 [debug] [Thread-4 (]: SQL status: BEGIN in 0.091 seconds
[0m09:26:32.713717 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:32.714110 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:26:32.720053 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m09:26:32.720576 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:32.720951 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:26:32.731862 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.017 seconds
[0m09:26:32.735452 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:32.735921 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:26:32.736782 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:26:32.740365 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:32.740840 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:26:32.741348 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.020 seconds
[0m09:26:32.744923 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:32.745344 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:26:32.745937 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:26:32.748340 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:26:32.748755 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:32.749095 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:26:32.749595 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:26:32.754292 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:32.754777 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m09:26:32.755482 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:26:32.757828 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:26:32.758695 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:26:32.759183 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:32.759663 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:26:32.761435 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:26:32.762329 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:32.762691 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:26:32.766318 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:26:32.772461 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:26:32.773272 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:26:32.773653 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:26:32.774398 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:26:32.776703 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:26:32.777646 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:26:32.779063 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:26:32.779946 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c39055c110>]}
[0m09:26:32.780727 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff15506-946e-4991-8e42-e6bd9fc9cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c390589b50>]}
[0m09:26:32.781457 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.18s]
[0m09:26:32.783449 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.18s]
[0m09:26:32.784389 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:26:32.785516 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:26:32.789090 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:32.789696 [debug] [MainThread]: On master: BEGIN
[0m09:26:32.789993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:32.798956 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:26:32.800106 [debug] [MainThread]: On master: COMMIT
[0m09:26:32.800965 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:32.801473 [debug] [MainThread]: On master: COMMIT
[0m09:26:32.802105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:26:32.802629 [debug] [MainThread]: On master: Close
[0m09:26:32.805027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:32.805847 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:26:32.806350 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:26:32.807001 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:26:32.807897 [info ] [MainThread]: 
[0m09:26:32.808335 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m09:26:32.811329 [debug] [MainThread]: Command end result
[0m09:26:32.842922 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:26:32.847070 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:26:32.854826 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:26:32.855561 [info ] [MainThread]: 
[0m09:26:32.856119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:26:32.856491 [info ] [MainThread]: 
[0m09:26:32.856862 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:26:32.859790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7848308, "process_in_blocks": "2256", "process_kernel_time": 0.814976, "process_mem_max_rss": "107492", "process_out_blocks": "3392", "process_user_time": 2.761864}
[0m09:26:32.863333 [debug] [MainThread]: Command `dbt run` succeeded at 09:26:32.862722 after 1.79 seconds
[0m09:26:32.864441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c392e3ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c393085280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c39660a8a0>]}
[0m09:26:32.865063 [debug] [MainThread]: Flushing usage events
[0m09:26:33.931968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:08.316721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf08b3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf08b2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf258c4a0>]}


============================== 09:29:08.326469 | 0b752df8-5617-437c-bf8b-4c439ff6a748 ==============================
[0m09:29:08.326469 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:29:08.327117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:29:08.621356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf069ea20>]}
[0m09:29:08.719405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf05f3bc0>]}
[0m09:29:08.720979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:29:08.816119 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:29:08.988875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:29:08.989602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:29:09.038825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf05a2ba0>]}
[0m09:29:09.203363 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:29:09.207107 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:29:09.260124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adeea64ad0>]}
[0m09:29:09.260767 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:29:09.261600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adeeb0e3c0>]}
[0m09:29:09.263699 [info ] [MainThread]: 
[0m09:29:09.264145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:29:09.264458 [info ] [MainThread]: 
[0m09:29:09.265035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:29:09.272902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:29:09.353194 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:29:09.353952 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:29:09.354765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:09.373301 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m09:29:09.375580 [debug] [ThreadPool]: On list_db: Close
[0m09:29:09.378745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:29:09.385013 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:29:09.385427 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:29:09.386294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:09.394906 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:29:09.395408 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:29:09.395812 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:29:09.399537 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m09:29:09.401154 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:29:09.401740 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:29:09.408297 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:09.408687 [debug] [MainThread]: On master: BEGIN
[0m09:29:09.408987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:09.416083 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:29:09.416535 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:09.416953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:29:09.421622 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:29:09.423143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf05c3f80>]}
[0m09:29:09.423749 [debug] [MainThread]: On master: ROLLBACK
[0m09:29:09.424310 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:09.424663 [debug] [MainThread]: On master: BEGIN
[0m09:29:09.425420 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:29:09.425833 [debug] [MainThread]: On master: COMMIT
[0m09:29:09.426149 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:09.426450 [debug] [MainThread]: On master: COMMIT
[0m09:29:09.426918 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:29:09.427280 [debug] [MainThread]: On master: Close
[0m09:29:09.432006 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:29:09.432633 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:29:09.433162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:29:09.433546 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:29:09.441273 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:29:09.442025 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:29:09.483428 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:29:09.484531 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:29:09.484973 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:29:09.485318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:09.495361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:29:09.496047 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:29:09.496552 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:29:09.507589 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.010 seconds
[0m09:29:09.516738 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:29:09.517237 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:29:09.518197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:29:09.521082 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:29:09.521562 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:29:09.523648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:29:09.547985 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:29:09.548510 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:29:09.548857 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:29:09.553297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:29:09.561762 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:29:09.568499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:29:09.568955 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:29:09.573480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:29:09.576721 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:29:09.578840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf1b009e0>]}
[0m09:29:09.579779 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.14s]
[0m09:29:09.580484 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:29:09.582083 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:29:09.582705 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:29:09.583311 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:29:09.583709 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:29:09.588106 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:29:09.588628 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:29:09.589509 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:29:09.590692 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:29:09.591449 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:29:09.594933 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:29:09.595794 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:29:09.601196 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:29:09.602054 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:29:09.602637 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:29:09.603022 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:29:09.604168 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:29:09.609080 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:29:09.609770 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:29:09.610125 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:29:09.610450 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:29:09.614206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m09:29:09.614659 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:29:09.614976 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:29:09.620937 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m09:29:09.621355 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:29:09.621700 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:29:09.632477 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.017 seconds
[0m09:29:09.636377 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:29:09.636822 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:29:09.637928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:29:09.640757 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:29:09.641198 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:29:09.641673 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.020 seconds
[0m09:29:09.645378 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:29:09.645812 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:29:09.646218 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:29:09.649067 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:29:09.649587 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:29:09.651149 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:29:09.654806 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:29:09.655340 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:29:09.655842 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:29:09.657280 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:29:09.659129 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:29:09.659595 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:29:09.660327 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:29:09.662713 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:29:09.663175 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:29:09.663903 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:29:09.664532 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:29:09.666497 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:29:09.669160 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:29:09.669801 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:29:09.670154 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:29:09.670641 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:29:09.672596 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:29:09.673269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adedc264e0>]}
[0m09:29:09.673963 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.09s]
[0m09:29:09.676043 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:29:09.678055 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:29:09.679952 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:29:09.681138 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b752df8-5617-437c-bf8b-4c439ff6a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adec2e7140>]}
[0m09:29:09.681963 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.09s]
[0m09:29:09.683368 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:29:09.686179 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:09.686574 [debug] [MainThread]: On master: BEGIN
[0m09:29:09.686885 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:29:09.694068 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:29:09.694518 [debug] [MainThread]: On master: COMMIT
[0m09:29:09.694865 [debug] [MainThread]: Using postgres connection "master"
[0m09:29:09.695160 [debug] [MainThread]: On master: COMMIT
[0m09:29:09.695850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:29:09.696218 [debug] [MainThread]: On master: Close
[0m09:29:09.697166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:09.697976 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:29:09.698333 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:29:09.698621 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:29:09.699105 [info ] [MainThread]: 
[0m09:29:09.699905 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m09:29:09.701991 [debug] [MainThread]: Command end result
[0m09:29:09.725457 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:29:09.727980 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:29:09.735119 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:29:09.735629 [info ] [MainThread]: 
[0m09:29:09.736760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:29:09.737655 [info ] [MainThread]: 
[0m09:29:09.738632 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:29:09.741710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.495813, "process_in_blocks": "10400", "process_kernel_time": 0.752376, "process_mem_max_rss": "107300", "process_out_blocks": "3392", "process_user_time": 2.552841}
[0m09:29:09.742636 [debug] [MainThread]: Command `dbt run` succeeded at 09:29:09.742488 after 1.50 seconds
[0m09:29:09.743104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adf0f14cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adeed79e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adeed0be00>]}
[0m09:29:09.743603 [debug] [MainThread]: Flushing usage events
[0m09:29:08.481911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:45.694736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712fff738530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712fff1dbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712fff5b8dd0>]}


============================== 09:34:45.714373 | a658af2a-4b05-4fad-b3d0-1bad56481250 ==============================
[0m09:34:45.714373 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:34:45.714910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:34:46.078545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffe96edb0>]}
[0m09:34:46.217080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffee6f3b0>]}
[0m09:34:46.222766 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:46.336730 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:34:46.572113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:46.572542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:46.613921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffd1dcdd0>]}
[0m09:34:46.697841 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:34:46.715958 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:34:46.758483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffce84a70>]}
[0m09:34:46.759350 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:34:46.760161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffce82b70>]}
[0m09:34:46.763168 [info ] [MainThread]: 
[0m09:34:46.764023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:34:46.764394 [info ] [MainThread]: 
[0m09:34:46.765717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:34:46.770747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:34:46.810620 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:34:46.811080 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:34:46.811351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:46.821522 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:34:46.823145 [debug] [ThreadPool]: On list_db: Close
[0m09:34:46.825315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:34:46.830041 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:34:46.830366 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:34:46.830587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:46.837512 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:34:46.837895 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:34:46.838112 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:34:46.841500 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m09:34:46.842817 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:34:46.843701 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:34:46.850001 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:46.850401 [debug] [MainThread]: On master: BEGIN
[0m09:34:46.850735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:46.858197 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:34:46.858750 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:46.859184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:34:46.866098 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m09:34:46.867830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffce82b70>]}
[0m09:34:46.868486 [debug] [MainThread]: On master: ROLLBACK
[0m09:34:46.869356 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:46.869773 [debug] [MainThread]: On master: BEGIN
[0m09:34:46.871012 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:34:46.871677 [debug] [MainThread]: On master: COMMIT
[0m09:34:46.871981 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:46.872229 [debug] [MainThread]: On master: COMMIT
[0m09:34:46.872794 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:46.873592 [debug] [MainThread]: On master: Close
[0m09:34:46.880185 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:34:46.880905 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:34:46.881460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:34:46.882062 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:34:46.890065 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:34:46.891776 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:34:46.937206 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:34:46.938255 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:34:46.938710 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:34:46.939054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:46.950200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:34:46.950738 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:34:46.951144 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:34:46.969307 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.018 seconds
[0m09:34:46.976312 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:34:46.976798 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:34:46.977906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:34:46.985269 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:34:46.986616 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:34:46.987872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:34:47.012643 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:34:47.013455 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:34:47.013828 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:34:47.040547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m09:34:47.050643 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:34:47.058951 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:34:47.059720 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:34:47.067310 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:34:47.071085 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:34:47.076603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712fff50e510>]}
[0m09:34:47.078389 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.19s]
[0m09:34:47.080786 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:34:47.083249 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:34:47.085107 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:34:47.087455 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:34:47.089068 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:34:47.090102 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:34:47.091239 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:34:47.092270 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:34:47.096035 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:34:47.096876 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:34:47.100225 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:34:47.101011 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:34:47.101625 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:34:47.105692 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:34:47.110790 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:34:47.112848 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:34:47.114063 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:34:47.114538 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:34:47.116264 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:34:47.116692 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:34:47.117031 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:34:47.128215 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:34:47.129679 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:34:47.130655 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m09:34:47.132391 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:34:47.133210 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:34:47.134169 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:34:47.154012 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.020 seconds
[0m09:34:47.159116 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:34:47.160035 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.025 seconds
[0m09:34:47.160837 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:34:47.166948 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:34:47.168070 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:34:47.169976 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:34:47.173888 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:34:47.174770 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:34:47.176733 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:34:47.186290 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:34:47.187787 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:34:47.190189 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:34:47.190684 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:34:47.193148 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:34:47.195247 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:34:47.196314 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:34:47.197176 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:34:47.198489 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:34:47.200366 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:34:47.212514 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m09:34:47.216230 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:34:47.217143 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m09:34:47.218559 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:34:47.221881 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:34:47.222477 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:34:47.223350 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:34:47.224098 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:34:47.233043 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:34:47.235090 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:34:47.235888 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:34:47.237097 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712fff50e510>]}
[0m09:34:47.242272 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:34:47.246744 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a658af2a-4b05-4fad-b3d0-1bad56481250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffc0f2c00>]}
[0m09:34:47.245235 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.14s]
[0m09:34:47.247918 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.16s]
[0m09:34:47.250897 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:34:47.252591 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:34:47.259351 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:47.260230 [debug] [MainThread]: On master: BEGIN
[0m09:34:47.260915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:47.294104 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:34:47.295171 [debug] [MainThread]: On master: COMMIT
[0m09:34:47.295994 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:47.296579 [debug] [MainThread]: On master: COMMIT
[0m09:34:47.297567 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:47.298294 [debug] [MainThread]: On master: Close
[0m09:34:47.298974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:47.299364 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:34:47.299612 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:34:47.299859 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:34:47.300410 [info ] [MainThread]: 
[0m09:34:47.300857 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m09:34:47.301994 [debug] [MainThread]: Command end result
[0m09:34:47.340620 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:34:47.346003 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:34:47.363107 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:34:47.363656 [info ] [MainThread]: 
[0m09:34:47.364127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:47.364502 [info ] [MainThread]: 
[0m09:34:47.364918 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:34:47.366081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7479199, "process_in_blocks": "9976", "process_kernel_time": 0.844589, "process_mem_max_rss": "107496", "process_out_blocks": "3392", "process_user_time": 2.694082}
[0m09:34:47.366682 [debug] [MainThread]: Command `dbt run` succeeded at 09:34:47.366557 after 1.75 seconds
[0m09:34:47.367111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffefd7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ffeab5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ff4f78ce0>]}
[0m09:34:47.367539 [debug] [MainThread]: Flushing usage events
[0m09:34:48.665436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:17.805699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76d9cfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76ed33f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76d42c200>]}


============================== 09:35:17.818518 | 5c776a91-16c5-4996-8d2a-68499d19e804 ==============================
[0m09:35:17.818518 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:35:17.819189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:35:18.073031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76d6b6f00>]}
[0m09:35:18.124966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76cd1f3e0>]}
[0m09:35:18.126094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:35:18.222139 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:35:18.311690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:35:18.312105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:35:18.348077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76b559790>]}
[0m09:35:18.416164 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:35:18.418574 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:35:18.440079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76b1ad940>]}
[0m09:35:18.440626 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:35:18.441723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76b25cc20>]}
[0m09:35:18.443814 [info ] [MainThread]: 
[0m09:35:18.444540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:35:18.444889 [info ] [MainThread]: 
[0m09:35:18.445733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:35:18.449711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:35:18.487385 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:35:18.488876 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:35:18.489152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:18.499533 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:35:18.500802 [debug] [ThreadPool]: On list_db: Close
[0m09:35:18.502551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:35:18.506824 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:35:18.507147 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:35:18.507337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:18.513169 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m09:35:18.513498 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:35:18.513725 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:35:18.516083 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m09:35:18.517487 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:35:18.517958 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:35:18.523183 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:18.523479 [debug] [MainThread]: On master: BEGIN
[0m09:35:18.523671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:35:18.531287 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:35:18.531835 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:18.532154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:35:18.536009 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m09:35:18.541007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76ce9c8f0>]}
[0m09:35:18.541644 [debug] [MainThread]: On master: ROLLBACK
[0m09:35:18.542273 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:18.542561 [debug] [MainThread]: On master: BEGIN
[0m09:35:18.543887 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:35:18.544186 [debug] [MainThread]: On master: COMMIT
[0m09:35:18.544409 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:18.544597 [debug] [MainThread]: On master: COMMIT
[0m09:35:18.545138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:35:18.545421 [debug] [MainThread]: On master: Close
[0m09:35:18.551850 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:35:18.552516 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:35:18.553064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:35:18.553354 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:35:18.558791 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:35:18.560270 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:35:18.589605 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:35:18.590287 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:35:18.590612 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:35:18.590848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:18.596442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:35:18.596741 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:35:18.596990 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:35:18.604511 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m09:35:18.609458 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:35:18.609768 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:35:18.610314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:35:18.612337 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:35:18.612620 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:35:18.613098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:35:18.630159 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:35:18.630609 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:35:18.630829 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:35:18.639809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m09:35:18.646580 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:35:18.651123 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:35:18.651503 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:35:18.656052 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:35:18.658313 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:35:18.659803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76d8be690>]}
[0m09:35:18.660412 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.11s]
[0m09:35:18.660888 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:35:18.663294 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:35:18.664004 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:35:18.664509 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:35:18.665020 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:35:18.665914 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:35:18.666650 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:35:18.667207 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:35:18.667827 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:35:18.670193 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:35:18.672968 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:35:18.674102 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:35:18.680382 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:35:18.679962 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:35:18.683119 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:35:18.683823 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:35:18.684260 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:35:18.684585 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:35:18.685276 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:35:18.685826 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:35:18.686160 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:35:18.695441 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m09:35:18.696060 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:35:18.696945 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:35:18.698764 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:35:18.699409 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:35:18.699890 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:35:18.709656 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.012 seconds
[0m09:35:18.713619 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:35:18.714062 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:35:18.715155 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:18.716143 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.015 seconds
[0m09:35:18.719772 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:35:18.722014 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:35:18.722622 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:35:18.723066 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:35:18.723944 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:35:18.724298 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:18.726058 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:35:18.728303 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:35:18.728866 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:35:18.729228 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:35:18.729605 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:35:18.730458 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:35:18.731639 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:35:18.731905 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:35:18.732111 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:35:18.733102 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:35:18.735447 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:35:18.735891 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:35:18.736614 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:35:18.738463 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:35:18.738931 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:35:18.739524 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:35:18.740056 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:35:18.745364 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:35:18.747115 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:35:18.748099 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7683128a0>]}
[0m09:35:18.749174 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.08s]
[0m09:35:18.750366 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:35:18.750836 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:35:18.753247 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:35:18.754203 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c776a91-16c5-4996-8d2a-68499d19e804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76a4a1cd0>]}
[0m09:35:18.755180 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.09s]
[0m09:35:18.755980 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:35:18.759075 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:18.759466 [debug] [MainThread]: On master: BEGIN
[0m09:35:18.759773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:18.767916 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:35:18.768456 [debug] [MainThread]: On master: COMMIT
[0m09:35:18.768853 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:18.769193 [debug] [MainThread]: On master: COMMIT
[0m09:35:18.769989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:35:18.770466 [debug] [MainThread]: On master: Close
[0m09:35:18.771222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:18.771573 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:35:18.771929 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:35:18.772197 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:35:18.772620 [info ] [MainThread]: 
[0m09:35:18.773196 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m09:35:18.774637 [debug] [MainThread]: Command end result
[0m09:35:18.791087 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:35:18.792442 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:35:18.800304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:35:18.800722 [info ] [MainThread]: 
[0m09:35:18.801168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:35:18.801537 [info ] [MainThread]: 
[0m09:35:18.801897 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:35:18.802972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.046518, "process_in_blocks": "704", "process_kernel_time": 0.302845, "process_mem_max_rss": "107620", "process_out_blocks": "3392", "process_user_time": 1.90141}
[0m09:35:18.803516 [debug] [MainThread]: Command `dbt run` succeeded at 09:35:18.803410 after 1.05 seconds
[0m09:35:18.803901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76d2abc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76ea62870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f76d18fe00>]}
[0m09:35:18.804247 [debug] [MainThread]: Flushing usage events
[0m09:35:19.962206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:42.624254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e8f80200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e90aa7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e70091f0>]}


============================== 09:38:42.631957 | 2d44bfa7-8bf0-4eb8-8aab-50c5434071ab ==============================
[0m09:38:42.631957 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:38:42.632752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:38:42.903702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e7008650>]}
[0m09:38:42.984052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e7f7a570>]}
[0m09:38:42.985484 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:43.068883 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:38:43.212286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:38:43.212799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:38:43.258051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e57994c0>]}
[0m09:38:43.388334 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:38:43.392567 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:38:43.434528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e55a9cd0>]}
[0m09:38:43.435254 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:38:43.435840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e6f956a0>]}
[0m09:38:43.437857 [info ] [MainThread]: 
[0m09:38:43.438364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:38:43.438863 [info ] [MainThread]: 
[0m09:38:43.439538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:43.448638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:38:43.509573 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:38:43.510110 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:38:43.510483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:43.527003 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m09:38:43.529255 [debug] [ThreadPool]: On list_db: Close
[0m09:38:43.531496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:38:43.538601 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:38:43.539931 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:38:43.540255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:43.556369 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m09:38:43.558392 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:38:43.560595 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:38:43.571305 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:38:43.573080 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:38:43.573770 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:38:43.580019 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:43.580552 [debug] [MainThread]: On master: BEGIN
[0m09:38:43.580873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:43.590076 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:38:43.590662 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:43.591049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:43.606160 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:38:43.609339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e7594230>]}
[0m09:38:43.610361 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:43.611533 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:43.611997 [debug] [MainThread]: On master: BEGIN
[0m09:38:43.616105 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:38:43.618287 [debug] [MainThread]: On master: COMMIT
[0m09:38:43.620060 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:43.621047 [debug] [MainThread]: On master: COMMIT
[0m09:38:43.623251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:43.623674 [debug] [MainThread]: On master: Close
[0m09:38:43.630267 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:38:43.631448 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:38:43.632218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:38:43.632602 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:38:43.646132 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:38:43.647449 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:38:43.715907 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:38:43.717798 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:38:43.718788 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:38:43.719194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:43.726985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:38:43.727485 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:38:43.727855 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:38:43.780653 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.052 seconds
[0m09:38:43.793689 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:38:43.794316 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:38:43.795815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:43.800301 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:38:43.800872 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:38:43.801900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:43.825616 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:38:43.826404 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:38:43.826828 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:38:43.834619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:38:43.845193 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:38:43.853138 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:38:43.853701 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:38:43.860706 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:38:43.863808 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:38:43.865904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e8ef2300>]}
[0m09:38:43.867319 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.23s]
[0m09:38:43.868289 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:38:43.870037 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:38:43.870552 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:38:43.871107 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:38:43.871443 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:38:43.874500 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:38:43.875161 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:38:43.878915 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:38:43.879575 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:38:43.880933 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:38:43.881614 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:38:43.882212 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:38:43.884975 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:38:43.885458 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:38:43.886126 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:38:43.886572 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:38:43.887173 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:38:43.892293 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:38:43.893383 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:38:43.893787 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:38:43.894406 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:38:43.897340 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m09:38:43.897774 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:38:43.898149 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:38:43.905639 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m09:38:43.906412 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:38:43.906873 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:38:43.911248 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.013 seconds
[0m09:38:43.916119 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:38:43.916722 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:38:43.917815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:43.920796 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:38:43.921428 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.014 seconds
[0m09:38:43.922166 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:38:43.925664 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:38:43.926540 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:38:43.927494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:43.929461 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:38:43.929912 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:38:43.930354 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:38:43.936011 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:38:43.936841 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:38:43.937564 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:38:43.939157 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:43.940797 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:38:43.941213 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:38:43.941510 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:38:43.942170 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:43.944600 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:38:43.945046 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:43.946009 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:38:43.948234 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:38:43.949005 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:38:43.951278 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:38:43.952132 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:38:43.954987 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:38:43.956519 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:38:43.957267 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e44e3ec0>]}
[0m09:38:43.958139 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.09s]
[0m09:38:43.958677 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:38:43.959355 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:38:43.960998 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:38:43.962238 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d44bfa7-8bf0-4eb8-8aab-50c5434071ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e4608170>]}
[0m09:38:43.962876 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.08s]
[0m09:38:43.963452 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:38:43.966685 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:43.967369 [debug] [MainThread]: On master: BEGIN
[0m09:38:43.967780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:43.976706 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:38:43.977308 [debug] [MainThread]: On master: COMMIT
[0m09:38:43.977648 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:43.978011 [debug] [MainThread]: On master: COMMIT
[0m09:38:43.978583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:43.979209 [debug] [MainThread]: On master: Close
[0m09:38:43.980070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:43.980625 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:38:43.980988 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:38:43.981573 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:38:43.982305 [info ] [MainThread]: 
[0m09:38:43.982957 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m09:38:43.984729 [debug] [MainThread]: Command end result
[0m09:38:44.008963 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:38:44.011550 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:38:44.019337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:38:44.019716 [info ] [MainThread]: 
[0m09:38:44.020141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:38:44.020617 [info ] [MainThread]: 
[0m09:38:44.022073 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:38:44.024607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4734664, "process_in_blocks": "0", "process_kernel_time": 0.442268, "process_mem_max_rss": "107396", "process_out_blocks": "3384", "process_user_time": 2.657268}
[0m09:38:44.025291 [debug] [MainThread]: Command `dbt run` succeeded at 09:38:44.025163 after 1.47 seconds
[0m09:38:44.025699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e8561ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e7af0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2e7af1010>]}
[0m09:38:44.026178 [debug] [MainThread]: Flushing usage events
[0m09:38:45.352485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:57.888003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77461bb39be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774619f81070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77461a7c9ee0>]}


============================== 09:43:57.896174 | 4bab85be-9b73-4ae9-8f95-751071d3f461 ==============================
[0m09:43:57.896174 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:43:57.897251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:43:58.239795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774619c741a0>]}
[0m09:43:58.336406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774619daba70>]}
[0m09:43:58.338094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:43:58.410313 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:43:58.533835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:58.534521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:58.577364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774618447b00>]}
[0m09:43:58.675873 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:43:58.682852 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:43:58.714734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746181f88c0>]}
[0m09:43:58.715349 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:43:58.715902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774618445e50>]}
[0m09:43:58.720463 [info ] [MainThread]: 
[0m09:43:58.721424 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:43:58.722407 [info ] [MainThread]: 
[0m09:43:58.723532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:43:58.728594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:43:58.796246 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:43:58.796792 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:43:58.797129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:58.810519 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m09:43:58.812329 [debug] [ThreadPool]: On list_db: Close
[0m09:43:58.814549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:43:58.821205 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:43:58.821780 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:43:58.823057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:58.832282 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:43:58.832892 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:43:58.833226 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:43:58.837059 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m09:43:58.838802 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:43:58.839627 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:43:58.846166 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.846695 [debug] [MainThread]: On master: BEGIN
[0m09:43:58.847021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:58.854598 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:43:58.855258 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.855754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:43:58.861921 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m09:43:58.863871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746183c5be0>]}
[0m09:43:58.864725 [debug] [MainThread]: On master: ROLLBACK
[0m09:43:58.865412 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.865823 [debug] [MainThread]: On master: BEGIN
[0m09:43:58.866714 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:43:58.867099 [debug] [MainThread]: On master: COMMIT
[0m09:43:58.867441 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.867765 [debug] [MainThread]: On master: COMMIT
[0m09:43:58.868463 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:58.868860 [debug] [MainThread]: On master: Close
[0m09:43:58.872655 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:43:58.873281 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:43:58.873799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:43:58.874149 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:43:58.881730 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:43:58.882521 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:43:58.923397 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:43:58.924676 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:58.925155 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:43:58.925516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:58.935930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:43:58.936485 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:58.936858 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:43:58.946432 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m09:43:58.954144 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:58.954634 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:43:58.955616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:58.958346 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:58.958746 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:43:58.959449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:58.979606 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:43:58.980444 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:58.980873 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:43:58.988465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:43:58.997382 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:43:59.006233 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:59.007038 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:43:59.012143 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:43:59.015088 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:43:59.017438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77461a7ca6f0>]}
[0m09:43:59.018274 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.14s]
[0m09:43:59.018960 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:43:59.020894 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:43:59.021488 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:43:59.022158 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:43:59.022822 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:43:59.023699 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:43:59.024744 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:43:59.025387 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:43:59.026059 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:43:59.029987 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:43:59.033179 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:43:59.034227 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:43:59.034727 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:43:59.038688 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:43:59.041983 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:43:59.043107 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:43:59.043517 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:43:59.044148 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:43:59.044711 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:43:59.045246 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:43:59.046083 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:43:59.058720 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m09:43:59.059524 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m09:43:59.060118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:43:59.060711 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:43:59.061345 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:43:59.062243 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:43:59.075525 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.013 seconds
[0m09:43:59.078819 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:43:59.079391 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.016 seconds
[0m09:43:59.079843 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:43:59.083648 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:43:59.084757 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:43:59.085398 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:59.088948 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:43:59.089525 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:43:59.090105 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:43:59.098648 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:59.100810 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:43:59.101201 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:43:59.095886 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:43:59.101554 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:43:59.101989 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:43:59.103225 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:59.104989 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:43:59.105403 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:43:59.105698 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:43:59.106298 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:43:59.109461 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:43:59.110051 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:43:59.115488 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:43:59.116470 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:43:59.117002 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:43:59.110881 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:43:59.118243 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:43:59.124278 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:43:59.125995 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:43:59.126710 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746173acdd0>]}
[0m09:43:59.127461 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.10s]
[0m09:43:59.128618 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:43:59.129377 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:43:59.131888 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:43:59.133230 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bab85be-9b73-4ae9-8f95-751071d3f461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746141ecb00>]}
[0m09:43:59.133860 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.11s]
[0m09:43:59.134446 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:43:59.137724 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:59.138663 [debug] [MainThread]: On master: BEGIN
[0m09:43:59.139147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:59.148067 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:43:59.148851 [debug] [MainThread]: On master: COMMIT
[0m09:43:59.149327 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:59.149725 [debug] [MainThread]: On master: COMMIT
[0m09:43:59.150530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:59.150925 [debug] [MainThread]: On master: Close
[0m09:43:59.151491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:59.151804 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:43:59.152175 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:43:59.152404 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:43:59.152768 [info ] [MainThread]: 
[0m09:43:59.153152 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m09:43:59.154171 [debug] [MainThread]: Command end result
[0m09:43:59.177290 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:43:59.179904 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:43:59.188009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:43:59.188437 [info ] [MainThread]: 
[0m09:43:59.189335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:43:59.190098 [info ] [MainThread]: 
[0m09:43:59.190578 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:43:59.191680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3672916, "process_in_blocks": "0", "process_kernel_time": 0.513503, "process_mem_max_rss": "107272", "process_out_blocks": "3384", "process_user_time": 2.68163}
[0m09:43:59.192411 [debug] [MainThread]: Command `dbt run` succeeded at 09:43:59.192260 after 1.37 seconds
[0m09:43:59.192917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77461a2919d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77461a7e9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77461a7e8770>]}
[0m09:43:59.193345 [debug] [MainThread]: Flushing usage events
[0m09:44:00.388839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:48:52.829159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8edd42210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ef651d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ef78c470>]}


============================== 09:48:52.845143 | f677e89f-c767-4827-afe0-8f781da54fdd ==============================
[0m09:48:52.845143 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:48:52.846005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:48:53.349053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ed763bc0>]}
[0m09:48:53.461306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8eddfac00>]}
[0m09:48:53.462325 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:48:53.535121 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:48:53.685956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:48:53.686711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:48:53.731368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ebf8d730>]}
[0m09:48:53.827074 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:48:53.829993 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:48:53.864419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ebc5f290>]}
[0m09:48:53.865466 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:48:53.865984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ebcc8e60>]}
[0m09:48:53.868560 [info ] [MainThread]: 
[0m09:48:53.869008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:48:53.869308 [info ] [MainThread]: 
[0m09:48:53.869884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:48:53.875008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:48:53.953188 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:48:53.953725 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:48:53.954095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:54.014501 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.060 seconds
[0m09:48:54.016206 [debug] [ThreadPool]: On list_db: Close
[0m09:48:54.019006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:48:54.031902 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:48:54.032489 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:48:54.032814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:54.044105 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:48:54.046355 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:48:54.046793 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:48:54.057966 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m09:48:54.060232 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:48:54.061460 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:48:54.069494 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:54.069986 [debug] [MainThread]: On master: BEGIN
[0m09:48:54.070744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:54.083744 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:48:54.084298 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:54.084727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:48:54.089484 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:48:54.091362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ed81c320>]}
[0m09:48:54.091985 [debug] [MainThread]: On master: ROLLBACK
[0m09:48:54.093213 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:54.093952 [debug] [MainThread]: On master: BEGIN
[0m09:48:54.095871 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:48:54.096308 [debug] [MainThread]: On master: COMMIT
[0m09:48:54.096638 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:54.096951 [debug] [MainThread]: On master: COMMIT
[0m09:48:54.098496 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:48:54.099411 [debug] [MainThread]: On master: Close
[0m09:48:54.105051 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:48:54.105704 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:48:54.106323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:48:54.106732 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:48:54.117531 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:48:54.119201 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:48:54.171085 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:48:54.172423 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:48:54.173106 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:48:54.174682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:54.197306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m09:48:54.198609 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:48:54.199406 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:48:54.261186 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.061 seconds
[0m09:48:54.269096 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:48:54.269837 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:48:54.272766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:48:54.279229 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:48:54.279883 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:48:54.281116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:48:54.304410 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:48:54.305130 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:48:54.305503 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:48:54.313215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:48:54.321752 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:48:54.328412 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:48:54.329115 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:48:54.333952 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:48:54.337139 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:48:54.340913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ee2e2750>]}
[0m09:48:54.342230 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.23s]
[0m09:48:54.342939 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:48:54.346356 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:48:54.347348 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:48:54.348471 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:48:54.349249 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:48:54.350304 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:48:54.351556 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:48:54.352316 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:48:54.353446 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:48:54.363298 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:48:54.368009 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:48:54.370509 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:48:54.374158 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:48:54.375519 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:48:54.376463 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:48:54.380204 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:48:54.381134 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:48:54.383328 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:48:54.385260 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:48:54.394347 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:48:54.396271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:48:54.450894 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m09:48:54.452066 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:48:54.452840 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:48:54.463120 [debug] [Thread-3 (]: SQL status: BEGIN in 0.080 seconds
[0m09:48:54.464192 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:48:54.465035 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:48:54.511565 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.058 seconds
[0m09:48:54.515316 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:48:54.516071 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:48:54.517115 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:48:54.520464 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:48:54.520948 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.055 seconds
[0m09:48:54.521373 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:48:54.526363 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:48:54.527821 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:48:54.528568 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:48:54.531465 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:48:54.532096 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:48:54.532870 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:48:54.538343 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:48:54.539417 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:48:54.540277 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:48:54.542496 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:48:54.545559 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:48:54.546226 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:48:54.546620 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:48:54.547627 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m09:48:54.552053 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:48:54.552652 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m09:48:54.553532 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:48:54.556591 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:48:54.557496 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:48:54.558376 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:48:54.559412 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:48:54.564541 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:48:54.566786 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:48:54.567306 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:48:54.569155 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:48:54.570139 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8eae16510>]}
[0m09:48:54.571180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f677e89f-c767-4827-afe0-8f781da54fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8e852ffe0>]}
[0m09:48:54.572214 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.22s]
[0m09:48:54.573465 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in 0.22s]
[0m09:48:54.574743 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:48:54.575683 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:48:54.582165 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:54.584976 [debug] [MainThread]: On master: BEGIN
[0m09:48:54.586026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:48:54.597908 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:48:54.599365 [debug] [MainThread]: On master: COMMIT
[0m09:48:54.600098 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:54.600675 [debug] [MainThread]: On master: COMMIT
[0m09:48:54.601841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:48:54.602424 [debug] [MainThread]: On master: Close
[0m09:48:54.603020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:54.603339 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:48:54.603620 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:48:54.603915 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:48:54.604336 [info ] [MainThread]: 
[0m09:48:54.604697 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m09:48:54.605733 [debug] [MainThread]: Command end result
[0m09:48:54.639335 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:48:54.641405 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:48:54.648695 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:48:54.652134 [info ] [MainThread]: 
[0m09:48:54.654494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:48:54.656353 [info ] [MainThread]: 
[0m09:48:54.657665 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:48:54.661154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9143028, "process_in_blocks": "2232", "process_kernel_time": 0.764393, "process_mem_max_rss": "106604", "process_out_blocks": "3384", "process_user_time": 2.908516}
[0m09:48:54.662320 [debug] [MainThread]: Command `dbt run` succeeded at 09:48:54.661994 after 1.92 seconds
[0m09:48:54.662828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ebf0bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8ebcc8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad8e856d520>]}
[0m09:48:54.663285 [debug] [MainThread]: Flushing usage events
[0m09:48:56.021841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:55.737706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef4944d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef56eb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef489a5d0>]}


============================== 09:53:55.751855 | 243ccc15-2945-4728-ac0b-149e148dfef3 ==============================
[0m09:53:55.751855 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:53:55.752478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:53:56.073641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef3e4aa80>]}
[0m09:53:56.163549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef3d93bc0>]}
[0m09:53:56.164628 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:56.310159 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:53:56.536050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:56.536815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:56.588057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef2475dc0>]}
[0m09:53:56.691499 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:53:56.697633 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:53:56.746891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef2269580>]}
[0m09:53:56.748045 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m09:53:56.748538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef50f3da0>]}
[0m09:53:56.750676 [info ] [MainThread]: 
[0m09:53:56.751151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:56.751480 [info ] [MainThread]: 
[0m09:53:56.752074 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:56.757296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:53:56.836853 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:53:56.837511 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:53:56.837914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:56.884134 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.046 seconds
[0m09:53:56.885844 [debug] [ThreadPool]: On list_db: Close
[0m09:53:56.888481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:53:56.897674 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:53:56.898158 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:53:56.898454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:56.906614 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:53:56.907076 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:53:56.907415 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:53:56.911507 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:53:56.913215 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:53:56.914012 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:53:56.921105 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:56.921673 [debug] [MainThread]: On master: BEGIN
[0m09:53:56.922048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:56.929213 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:53:56.929730 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:56.930242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:56.939229 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m09:53:56.941025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef4363d40>]}
[0m09:53:56.941801 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:56.942961 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:56.943648 [debug] [MainThread]: On master: BEGIN
[0m09:53:56.944629 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:53:56.945380 [debug] [MainThread]: On master: COMMIT
[0m09:53:56.945829 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:56.946150 [debug] [MainThread]: On master: COMMIT
[0m09:53:56.946736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:56.947094 [debug] [MainThread]: On master: Close
[0m09:53:56.954490 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:53:56.955211 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:53:56.955790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:53:56.956196 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:53:56.964034 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:53:56.964768 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:53:57.008400 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:53:57.009826 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:53:57.010315 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:53:57.010683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:57.018640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:53:57.019522 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:53:57.019959 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m09:53:57.036819 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.016 seconds
[0m09:53:57.045247 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:53:57.045835 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:53:57.046866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:57.050159 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:53:57.050543 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:53:57.051590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:57.082147 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:53:57.082754 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:53:57.083080 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:53:57.090399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m09:53:57.101823 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:53:57.114583 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:53:57.115151 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:53:57.123234 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:53:57.128550 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:53:57.133146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef5cae5d0>]}
[0m09:53:57.137299 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 6[0m in 0.17s]
[0m09:53:57.138116 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:53:57.140213 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m09:53:57.142031 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m09:53:57.143754 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m09:53:57.144379 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m09:53:57.143058 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m09:53:57.144710 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m09:53:57.146035 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m09:53:57.151050 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m09:53:57.152091 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m09:53:57.161270 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m09:53:57.162145 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m09:53:57.166967 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m09:53:57.167931 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m09:53:57.168526 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:53:57.180362 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m09:53:57.181111 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m09:53:57.193787 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:53:57.195366 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:53:57.196108 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m09:53:57.197221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:57.211181 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m09:53:57.211952 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m09:53:57.212769 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:53:57.213532 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:53:57.214663 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m09:53:57.215127 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m09:53:56.436976 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.067 seconds
[0m09:53:56.444183 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:53:56.444899 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m09:53:56.446335 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:56.451015 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:53:56.451897 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.082 seconds
[0m09:53:56.452803 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m09:53:56.458060 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:53:56.458898 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg" rename to "daily_avg__dbt_backup"
[0m09:53:56.459668 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:56.462521 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:53:56.463374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:53:56.463896 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:53:56.467545 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:53:56.468398 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m09:53:56.469103 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m09:53:56.470750 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:56.473058 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:53:56.473479 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:53:56.473807 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m09:53:56.474187 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:53:56.477425 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m09:53:56.477942 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:53:56.478600 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m09:53:56.483170 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m09:53:56.484543 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m09:53:56.485957 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m09:53:56.487172 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m09:53:56.492388 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:53:56.494205 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m09:53:56.494772 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:53:56.495725 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef1460230>]}
[0m09:53:56.497390 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m09:53:56.498305 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in -0.65s]
[0m09:53:56.499618 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m09:53:56.500606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '243ccc15-2945-4728-ac0b-149e148dfef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef1395910>]}
[0m09:53:56.502038 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 3[0m in -0.64s]
[0m09:53:56.502690 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m09:53:56.506003 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:56.506479 [debug] [MainThread]: On master: BEGIN
[0m09:53:56.506947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:56.515334 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:53:56.515889 [debug] [MainThread]: On master: COMMIT
[0m09:53:56.516251 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:56.516604 [debug] [MainThread]: On master: COMMIT
[0m09:53:56.517272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:56.517639 [debug] [MainThread]: On master: Close
[0m09:53:56.518323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:56.518709 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:53:56.519257 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m09:53:56.519612 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m09:53:56.520071 [info ] [MainThread]: 
[0m09:53:56.520692 [info ] [MainThread]: Finished running 3 table models in -1 hours 59 minutes and 59.77 seconds (-0.23s).
[0m09:53:56.521809 [debug] [MainThread]: Command end result
[0m09:53:56.548804 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:53:56.551094 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:53:56.558923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:53:56.559432 [info ] [MainThread]: 
[0m09:53:56.560128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:56.560792 [info ] [MainThread]: 
[0m09:53:56.561630 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:53:56.564030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7324134, "process_in_blocks": "11688", "process_kernel_time": 0.696106, "process_mem_max_rss": "106008", "process_out_blocks": "3384", "process_user_time": 2.788128}
[0m09:53:56.564661 [debug] [MainThread]: Command `dbt run` succeeded at 09:53:56.564533 after 1.73 seconds
[0m09:53:56.565090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef5261fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef50f52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bef3dd4230>]}
[0m09:53:56.565518 [debug] [MainThread]: Flushing usage events
[0m09:53:56.212297 [debug] [MainThread]: An error was encountered while trying to flush usage events
