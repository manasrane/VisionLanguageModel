[0m11:39:27.240155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a8b2dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a70f0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a72728d0>]}


============================== 11:39:27.246868 | 10e158a3-4a82-44c2-8e8d-b231b33a678c ==============================
[0m11:39:27.246868 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:39:27.247282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:39:27.247552 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:39:27.248240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.047126003, "process_in_blocks": "0", "process_kernel_time": 0.225116, "process_mem_max_rss": "86148", "process_out_blocks": "1472", "process_user_time": 0.989737}
[0m11:39:27.248569 [debug] [MainThread]: Command `dbt run` failed at 11:39:27.248496 after 0.05 seconds
[0m11:39:27.248787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a7735ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a7892ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce5a6e8fbc0>]}
[0m11:39:27.249043 [debug] [MainThread]: Flushing usage events
[0m11:39:28.601697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:06.412893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212cafe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212a19100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212e38bc0>]}


============================== 11:40:06.418784 | 785c77fe-a829-425b-add3-41630bf8cca2 ==============================
[0m11:40:06.418784 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:40:06.419188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init my_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:40:06.462123 [debug] [MainThread]: Starter project path: /usr/local/lib/python3.12/site-packages/dbt/include/starter_project
[0m11:40:06.465483 [info ] [MainThread]: 
Your new dbt project "my_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:40:06.465806 [info ] [MainThread]: Setting up your profile.
[0m11:40:39.843476 [info ] [MainThread]: Profile my_project written to /root/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m11:40:39.846847 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 34.624004, "process_in_blocks": "0", "process_kernel_time": 0.187087, "process_mem_max_rss": "91728", "process_out_blocks": "1552", "process_user_time": 1.06961}
[0m11:40:39.847760 [debug] [MainThread]: Command `dbt init` succeeded at 11:40:39.847518 after 34.63 seconds
[0m11:40:39.848372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701212ce2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7012127b6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7012127e5400>]}
[0m11:40:39.848989 [debug] [MainThread]: Flushing usage events
[0m11:40:41.165418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:55.483985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c30fd0d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c31098be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c30fd0f5c0>]}


============================== 11:43:55.493318 | 3e7efbab-9c5a-4400-8258-b78a70719462 ==============================
[0m11:43:55.493318 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:43:55.493736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:55.494037 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:43:55.496806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07938974, "process_in_blocks": "82112", "process_kernel_time": 0.244016, "process_mem_max_rss": "86032", "process_out_blocks": "1480", "process_user_time": 1.147639}
[0m11:43:55.497236 [debug] [MainThread]: Command `dbt run` failed at 11:43:55.497149 after 0.08 seconds
[0m11:43:55.497530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c31098be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c3106ac200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c30ffa61b0>]}
[0m11:43:55.497802 [debug] [MainThread]: Flushing usage events
[0m11:43:56.305298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:43.989837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd685f1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67e33b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd685f36e0>]}


============================== 11:46:43.995009 | eb27c7bf-acfa-45c7-92cf-3cb73589746c ==============================
[0m11:46:43.995009 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:46:43.995383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:46:44.239895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd68052630>]}
[0m11:46:44.308037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67adb200>]}
[0m11:46:44.309692 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:46:44.377828 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:46:44.378370 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:46:44.378664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd6626e0c0>]}
[0m11:46:45.049508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m11:46:45.055118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd660deb40>]}
[0m11:46:45.091195 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:45.093659 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:45.129062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd65f877a0>]}
[0m11:46:45.129509 [info ] [MainThread]: Found 429 macros
[0m11:46:45.130144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb27c7bf-acfa-45c7-92cf-3cb73589746c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd663116d0>]}
[0m11:46:45.133725 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:46:45.134357 [debug] [MainThread]: Command end result
[0m11:46:45.147899 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:45.149279 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:45.152423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:46:45.153342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2086997, "process_in_blocks": "13104", "process_kernel_time": 0.207004, "process_mem_max_rss": "98928", "process_out_blocks": "4064", "process_user_time": 2.039381}
[0m11:46:45.153786 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:45.153696 after 1.21 seconds
[0m11:46:45.154082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd68347e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67d73a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cd67b73ce0>]}
[0m11:46:45.154348 [debug] [MainThread]: Flushing usage events
[0m11:46:46.410448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:56.518499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa0bb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa0bac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa0b8aa0>]}


============================== 11:54:56.523571 | c122ab35-5bd9-461e-a9be-b63614419f81 ==============================
[0m11:54:56.523571 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:54:56.523977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:54:56.748335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea9da9280>]}
[0m11:54:56.799913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa5aac90>]}
[0m11:54:56.800730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:54:56.867398 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:54:56.919176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m11:54:56.921172 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/my_first_dbt_model.sql
[0m11:54:56.921587 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/schema.yml
[0m11:54:56.921872 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/my_second_dbt_model.sql
[0m11:54:57.332617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea81095b0>]}
[0m11:54:57.390896 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:54:57.393559 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:54:57.413546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea5c65a60>]}
[0m11:54:57.413992 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m11:54:57.415398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c122ab35-5bd9-461e-a9be-b63614419f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eab14fc50>]}
[0m11:54:57.417087 [info ] [MainThread]: 
[0m11:54:57.417965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:57.418781 [info ] [MainThread]: 
[0m11:54:57.419867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:54:57.424026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:54:57.459927 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:54:57.460379 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:54:57.460619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:57.462399 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:54:57.463426 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:54:57.463652 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:54:57.463889 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:54:57.464137 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:54:57.464371 [debug] [ThreadPool]: On list_db: No close available on handle
[0m11:54:57.465286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:57.465570 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m11:54:57.465822 [info ] [MainThread]: 
[0m11:54:57.466135 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m11:54:57.466571 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:54:57.467428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.98911524, "process_in_blocks": "2216", "process_kernel_time": 0.330103, "process_mem_max_rss": "109508", "process_out_blocks": "3304", "process_user_time": 1.871882}
[0m11:54:57.467845 [debug] [MainThread]: Command `dbt run` failed at 11:54:57.467756 after 0.99 seconds
[0m11:54:57.468141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6eaa41b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea827e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ea5b24560>]}
[0m11:54:57.468431 [debug] [MainThread]: Flushing usage events
[0m11:54:58.799290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:45.283804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000ced00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000d81ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000ced1310>]}


============================== 11:58:45.291329 | d95494d2-f256-4dec-86ae-c22471737ae4 ==============================
[0m11:58:45.291329 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:58:45.292045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:58:45.483380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000d2a2090>]}
[0m11:58:45.549786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000dd6c860>]}
[0m11:58:45.551459 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:58:45.621268 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:58:45.708004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:45.708336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:45.737678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b66c7d0>]}
[0m11:58:45.791778 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:58:45.794188 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:58:45.816410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b385340>]}
[0m11:58:45.816848 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m11:58:45.817432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd95494d2-f256-4dec-86ae-c22471737ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b33c770>]}
[0m11:58:45.819859 [info ] [MainThread]: 
[0m11:58:45.820178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:45.820402 [info ] [MainThread]: 
[0m11:58:45.820813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:58:45.824219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:58:45.856732 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:58:45.857078 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:58:45.857272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:45.859487 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:58:45.861409 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:58:45.861987 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:58:45.862531 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:58:45.863035 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:58:45.863545 [debug] [ThreadPool]: On list_db: No close available on handle
[0m11:58:45.864670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:45.864879 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m11:58:45.865071 [info ] [MainThread]: 
[0m11:58:45.865327 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m11:58:45.865684 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:58:45.866477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6257717, "process_in_blocks": "0", "process_kernel_time": 0.226057, "process_mem_max_rss": "103224", "process_out_blocks": "2480", "process_user_time": 1.578505}
[0m11:58:45.866862 [debug] [MainThread]: Command `dbt run` failed at 11:58:45.866781 after 0.63 seconds
[0m11:58:45.867142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000d1ccfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000b3457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76000a4e81a0>]}
[0m11:58:45.867440 [debug] [MainThread]: Flushing usage events
[0m11:58:47.133596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:42:05.841941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32e8a0>]}


============================== 05:42:05.849045 | bc5d99bd-9f85-4e0a-a8f7-170ddf3db066 ==============================
[0m05:42:05.849045 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:42:05.849449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:42:05.851129 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_project'
[0m05:42:05.852534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05013612, "process_in_blocks": "84568", "process_kernel_time": 0.254795, "process_mem_max_rss": "86244", "process_out_blocks": "1480", "process_user_time": 0.966466}
[0m05:42:05.852872 [debug] [MainThread]: Command `dbt run` failed at 05:42:05.852800 after 0.05 seconds
[0m05:42:05.853103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b309fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784f0b32d4f0>]}
[0m05:42:05.853349 [debug] [MainThread]: Flushing usage events
[0m05:42:07.083509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:43:11.161815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb7933e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efbbeae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb793500>]}


============================== 05:43:11.168519 | f25681f1-008d-41e4-8c90-0d36778dd7a2 ==============================
[0m05:43:11.168519 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:43:11.168989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:43:11.171027 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_project'
[0m05:43:11.172845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.056842603, "process_in_blocks": "78000", "process_kernel_time": 0.257499, "process_mem_max_rss": "86304", "process_out_blocks": "1472", "process_user_time": 0.937128}
[0m05:43:11.173238 [debug] [MainThread]: Command `dbt run` failed at 05:43:11.173155 after 0.06 seconds
[0m05:43:11.173508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb842540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efb2653a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781efbecba70>]}
[0m05:43:11.173790 [debug] [MainThread]: Flushing usage events
[0m05:43:12.065963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:43:28.872735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da374e71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da3720d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da37c492e0>]}


============================== 05:43:28.878322 | 7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d ==============================
[0m05:43:28.878322 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:43:28.878684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:43:29.103119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da376c6d20>]}
[0m05:43:29.148790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da370b7c50>]}
[0m05:43:29.151131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:43:29.226818 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:43:29.289066 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:43:29.289546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b5b2e31-e8b4-4db6-92c3-7475d0c52c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da355813d0>]}
[0m05:43:29.961533 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/sources/sources.yml @ sources: {'name': 'dev', 'database': 'db', 'tables': [{'name': 'raw_weather_data', 'columns': {'-name': 'utc_offset'}}]} - at path ['tables'][0]['columns']: {'-name': 'utc_offset'} is not of type 'array'
[0m05:43:29.963532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1309751, "process_in_blocks": "18640", "process_kernel_time": 0.239349, "process_mem_max_rss": "99928", "process_out_blocks": "1512", "process_user_time": 1.923497}
[0m05:43:29.964291 [debug] [MainThread]: Command `dbt run` failed at 05:43:29.964182 after 1.13 seconds
[0m05:43:29.964597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da37a4f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da3542bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da16d0aae0>]}
[0m05:43:29.964857 [debug] [MainThread]: Flushing usage events
[0m05:43:33.872294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:45:58.316392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d095fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d096f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d095580>]}


============================== 05:45:58.320970 | 28673400-9aca-4f78-b28e-b527c1a3fc51 ==============================
[0m05:45:58.320970 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:45:58.321345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:45:58.481240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d095580>]}
[0m05:45:58.523151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735d0c3950>]}
[0m05:45:58.525513 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:45:58.577703 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:45:58.637813 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:45:58.638195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735b1589e0>]}
[0m05:45:59.383234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735af09b80>]}
[0m05:45:59.429893 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:45:59.433108 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:45:59.462901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727358a68470>]}
[0m05:45:59.463366 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m05:45:59.463631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727358a09ee0>]}
[0m05:45:59.464964 [info ] [MainThread]: 
[0m05:45:59.465247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:59.465729 [info ] [MainThread]: 
[0m05:45:59.466318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:45:59.467286 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:45:59.569179 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:45:59.569880 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:45:59.570430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:59.591645 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m05:45:59.592683 [debug] [ThreadPool]: On list_db: Close
[0m05:45:59.593397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev_dev)
[0m05:45:59.593803 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev_dev"
"
[0m05:45:59.597481 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m05:45:59.597916 [debug] [ThreadPool]: On create_db_dev_dev: BEGIN
[0m05:45:59.598447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:59.603020 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m05:45:59.603368 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m05:45:59.603570 [debug] [ThreadPool]: On create_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev_dev"} */
create schema if not exists "dev_dev"
[0m05:45:59.604258 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m05:45:59.605116 [debug] [ThreadPool]: On create_db_dev_dev: COMMIT
[0m05:45:59.605365 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m05:45:59.605567 [debug] [ThreadPool]: On create_db_dev_dev: COMMIT
[0m05:45:59.607481 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m05:45:59.607708 [debug] [ThreadPool]: On create_db_dev_dev: Close
[0m05:45:59.608713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev_dev, now list_db_dev_dev)
[0m05:45:59.612757 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:45:59.612994 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m05:45:59.613174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:59.617412 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m05:45:59.617652 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:45:59.617837 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m05:45:59.624309 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m05:45:59.625186 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m05:45:59.625533 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m05:45:59.628528 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.628782 [debug] [MainThread]: On master: BEGIN
[0m05:45:59.628969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:59.633396 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:45:59.633651 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.633886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:45:59.638911 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:45:59.639891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727358a094f0>]}
[0m05:45:59.640254 [debug] [MainThread]: On master: ROLLBACK
[0m05:45:59.640646 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.640877 [debug] [MainThread]: On master: BEGIN
[0m05:45:59.641295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:45:59.641502 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.641676 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.641846 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.642156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:45:59.642401 [debug] [MainThread]: On master: Close
[0m05:45:59.644470 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:45:59.644844 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.staging ................................... [RUN]
[0m05:45:59.645154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.staging)
[0m05:45:59.645364 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:45:59.649943 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:45:59.651503 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:45:59.679452 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:45:59.680435 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.680692 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:45:59.681025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:59.685992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m05:45:59.686305 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.686532 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev_dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select  * 
from "db"."dev"."raw_weather_data"
  );
  
[0m05:45:59.697175 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.010 seconds
[0m05:45:59.701631 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.701966 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev_dev"."staging__dbt_tmp" rename to "staging"
[0m05:45:59.702639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:45:59.716774 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:45:59.717190 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.717439 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:45:59.740410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m05:45:59.746667 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."staging__dbt_backup"
[0m05:45:59.752810 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.753547 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev_dev"."staging__dbt_backup" cascade
[0m05:45:59.754384 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m05:45:59.756763 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:45:59.762487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28673400-9aca-4f78-b28e-b527c1a3fc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735b08e6f0>]}
[0m05:45:59.763351 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.staging .............................. [[32mSELECT 37[0m in 0.11s]
[0m05:45:59.763915 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:45:59.766497 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.766868 [debug] [MainThread]: On master: BEGIN
[0m05:45:59.767096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:59.773730 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m05:45:59.774203 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.774502 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.774760 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.775447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:45:59.775767 [debug] [MainThread]: On master: Close
[0m05:45:59.776234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:59.776518 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:45:59.776832 [info ] [MainThread]: 
[0m05:45:59.777176 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m05:45:59.777792 [debug] [MainThread]: Command end result
[0m05:45:59.796219 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:45:59.797669 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:45:59.802025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:45:59.802314 [info ] [MainThread]: 
[0m05:45:59.802627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:45:59.803001 [info ] [MainThread]: 
[0m05:45:59.803458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:45:59.804977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5526671, "process_in_blocks": "102528", "process_kernel_time": 0.291356, "process_mem_max_rss": "110464", "process_out_blocks": "2640", "process_user_time": 2.255803}
[0m05:45:59.805397 [debug] [MainThread]: Command `dbt run` succeeded at 05:45:59.805310 after 1.55 seconds
[0m05:45:59.805687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735fcb94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735fcb9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72735af70860>]}
[0m05:45:59.805961 [debug] [MainThread]: Flushing usage events
[0m05:46:00.661664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:48:13.543557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a31cd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a31ce240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a31cd8e0>]}


============================== 05:48:13.545966 | f099878e-276c-4557-a7a2-76c4b46944bb ==============================
[0m05:48:13.545966 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:48:13.547283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:48:13.676661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a14a0950>]}
[0m05:48:13.722032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a37ccf20>]}
[0m05:48:13.722794 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:48:13.771633 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:48:13.836279 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:48:13.836796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a319bf50>]}
[0m05:48:14.572824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a123c680>]}
[0m05:48:14.620096 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:48:14.621955 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:48:14.632846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e89aa95a60>]}
[0m05:48:14.633225 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m05:48:14.633509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e89aafe0c0>]}
[0m05:48:14.634682 [info ] [MainThread]: 
[0m05:48:14.635016 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:48:14.635263 [info ] [MainThread]: 
[0m05:48:14.636560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:48:14.638061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:48:14.712035 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:48:14.712371 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:48:14.712572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:48:14.720739 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m05:48:14.721762 [debug] [ThreadPool]: On list_db: Close
[0m05:48:14.722935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:48:14.727152 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:48:14.727396 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:48:14.727643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:48:14.732400 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m05:48:14.732722 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:48:14.732936 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:48:14.735220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m05:48:14.736329 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:48:14.736748 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:48:14.740207 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.740494 [debug] [MainThread]: On master: BEGIN
[0m05:48:14.740710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:48:14.745812 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m05:48:14.746108 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.746364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:48:14.749014 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m05:48:14.750336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e899ee6d20>]}
[0m05:48:14.750783 [debug] [MainThread]: On master: ROLLBACK
[0m05:48:14.751237 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.751490 [debug] [MainThread]: On master: BEGIN
[0m05:48:14.752054 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:48:14.752305 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.752557 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.752755 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.753053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:48:14.753264 [debug] [MainThread]: On master: Close
[0m05:48:14.755520 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:48:14.755961 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m05:48:14.756297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:48:14.756531 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:48:14.761242 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:48:14.761812 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:48:14.788570 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:48:14.789217 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.789494 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:48:14.789700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:48:14.794259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m05:48:14.794581 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.794793 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select  * 
from "db"."dev"."raw_weather_data"
  );
  
[0m05:48:14.823707 [debug] [Thread-1 (]: SQL status: SELECT 38 in 0.029 seconds
[0m05:48:14.828890 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.829191 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:48:14.829802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:48:14.840167 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:48:14.840453 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.840658 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:48:14.851209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m05:48:14.854874 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:48:14.858022 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:14.858286 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:48:14.859108 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m05:48:14.862394 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:48:14.865186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f099878e-276c-4557-a7a2-76c4b46944bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a4a02270>]}
[0m05:48:14.866268 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 38[0m in 0.11s]
[0m05:48:14.867076 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:48:14.869301 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.869611 [debug] [MainThread]: On master: BEGIN
[0m05:48:14.869863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:48:14.874316 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:48:14.874597 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.874804 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:14.875037 [debug] [MainThread]: On master: COMMIT
[0m05:48:14.875363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:48:14.875575 [debug] [MainThread]: On master: Close
[0m05:48:14.875905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:48:14.876108 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:48:14.876321 [info ] [MainThread]: 
[0m05:48:14.876566 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m05:48:14.877082 [debug] [MainThread]: Command end result
[0m05:48:14.891553 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:48:14.892911 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:48:14.896823 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:48:14.897087 [info ] [MainThread]: 
[0m05:48:14.897376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:48:14.897582 [info ] [MainThread]: 
[0m05:48:14.897804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:48:14.898616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4212016, "process_in_blocks": "0", "process_kernel_time": 0.237477, "process_mem_max_rss": "110372", "process_out_blocks": "2528", "process_user_time": 2.244829}
[0m05:48:14.899025 [debug] [MainThread]: Command `dbt run` succeeded at 05:48:14.898945 after 1.42 seconds
[0m05:48:14.899297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a2d50290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a2d50e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e8a123d100>]}
[0m05:48:14.899553 [debug] [MainThread]: Flushing usage events
[0m05:48:15.763299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:59:07.329908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755d234a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755d21b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667552f2480>]}


============================== 05:59:07.333951 | d75dfe5e-ce33-4eb4-95a3-64eb2812a22c ==============================
[0m05:59:07.333951 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:59:07.334930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:59:07.451075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755493b60>]}
[0m05:59:07.494184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675588b5f0>]}
[0m05:59:07.495507 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:59:07.540832 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:59:07.613796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:59:07.614269 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m05:59:07.803427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755a64f20>]}
[0m05:59:07.850574 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:59:07.852541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:59:07.864133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675350e1b0>]}
[0m05:59:07.864496 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m05:59:07.864747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667538d3980>]}
[0m05:59:07.865853 [info ] [MainThread]: 
[0m05:59:07.866192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:59:07.866405 [info ] [MainThread]: 
[0m05:59:07.866818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:59:07.867761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:59:07.893270 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:59:07.893625 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:59:07.893825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:59:07.902380 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m05:59:07.903439 [debug] [ThreadPool]: On list_db: Close
[0m05:59:07.904516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:59:07.908020 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:59:07.908295 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:59:07.908475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:07.912942 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m05:59:07.913248 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:59:07.913474 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:59:07.915929 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m05:59:07.916865 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:59:07.917240 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:59:07.921549 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.921881 [debug] [MainThread]: On master: BEGIN
[0m05:59:07.922082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:59:07.926989 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m05:59:07.927320 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.927566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:59:07.930667 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m05:59:07.931775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675059e5a0>]}
[0m05:59:07.932179 [debug] [MainThread]: On master: ROLLBACK
[0m05:59:07.932586 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.932845 [debug] [MainThread]: On master: BEGIN
[0m05:59:07.933249 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:59:07.933463 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.933813 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.934102 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.934432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:59:07.934660 [debug] [MainThread]: On master: Close
[0m05:59:07.936716 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:59:07.937114 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m05:59:07.937484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:59:07.937704 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:59:07.942406 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:59:07.942961 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:59:07.969114 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:59:07.969745 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:07.970013 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:59:07.970231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:07.974740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m05:59:07.975085 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:07.975372 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select  * 
from "db"."dev"."raw_weather_data"

select 
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    time as weather_time_local,
    (inserted_at +(utc_offset || 'hours') :: interval) as inserted_at_local
from source
  );
  
[0m05:59:07.976646 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 17: select 
         ^

[0m05:59:07.976885 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m05:59:07.977312 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:59:07.984487 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "select"
  LINE 17: select 
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m05:59:07.985818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75dfe5e-ce33-4eb4-95a3-64eb2812a22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766755dae4b0>]}
[0m05:59:07.986358 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.05s]
[0m05:59:07.986863 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:59:07.987434 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "select"
  LINE 17: select 
           ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m05:59:07.989245 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.989504 [debug] [MainThread]: On master: BEGIN
[0m05:59:07.989695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:59:07.994899 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m05:59:07.995284 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.995502 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:07.995698 [debug] [MainThread]: On master: COMMIT
[0m05:59:07.996038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:59:07.996265 [debug] [MainThread]: On master: Close
[0m05:59:07.996616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:59:07.996821 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:59:07.997044 [info ] [MainThread]: 
[0m05:59:07.997323 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m05:59:07.998056 [debug] [MainThread]: Command end result
[0m05:59:08.010690 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:59:08.012022 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:59:08.016031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:59:08.016275 [info ] [MainThread]: 
[0m05:59:08.016560 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:59:08.016910 [info ] [MainThread]: 
[0m05:59:08.017562 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "select"
  LINE 17: select 
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m05:59:08.017923 [info ] [MainThread]: 
[0m05:59:08.018333 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:59:08.019476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7569224, "process_in_blocks": "368", "process_kernel_time": 0.193704, "process_mem_max_rss": "110264", "process_out_blocks": "2520", "process_user_time": 1.598061}
[0m05:59:08.020605 [debug] [MainThread]: Command `dbt run` failed at 05:59:08.020490 after 0.76 seconds
[0m05:59:08.020940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675521cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7667535f38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76675510e180>]}
[0m05:59:08.021351 [debug] [MainThread]: Flushing usage events
[0m05:59:08.888995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:01:28.106487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd89b83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd82b7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd89b84a0>]}


============================== 06:01:28.109053 | f5e95e68-2a1e-485b-8c47-bc8452266021 ==============================
[0m06:01:28.109053 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:01:28.109439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:01:28.230907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd7ce1310>]}
[0m06:01:28.273759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abdb4ca900>]}
[0m06:01:28.274443 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:01:28.319118 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:01:28.385327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:01:28.385762 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:01:28.582314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd60e8710>]}
[0m06:01:28.630365 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:01:28.632876 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:01:28.643836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd60e2150>]}
[0m06:01:28.644539 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m06:01:28.645030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd61c7b90>]}
[0m06:01:28.646654 [info ] [MainThread]: 
[0m06:01:28.646958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:01:28.647469 [info ] [MainThread]: 
[0m06:01:28.648434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:01:28.649209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:01:28.672967 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:01:28.673290 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:01:28.673483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:28.681332 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m06:01:28.682432 [debug] [ThreadPool]: On list_db: Close
[0m06:01:28.683895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:01:28.687718 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:01:28.687971 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:01:28.688152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:28.692680 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:01:28.692962 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:01:28.693149 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:01:28.694937 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:01:28.695844 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:01:28.696167 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:01:28.700393 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.700650 [debug] [MainThread]: On master: BEGIN
[0m06:01:28.700838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:01:28.705571 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:01:28.705907 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.706154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:01:28.708778 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:01:28.709813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abcef902f0>]}
[0m06:01:28.710175 [debug] [MainThread]: On master: ROLLBACK
[0m06:01:28.710547 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.710773 [debug] [MainThread]: On master: BEGIN
[0m06:01:28.711238 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:01:28.711462 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.711643 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.711816 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.712094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:01:28.712305 [debug] [MainThread]: On master: Close
[0m06:01:28.714368 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:01:28.714785 [info ] [Thread-1 (]: 1 of 1 START sql Table model dev.staging ....................................... [RUN]
[0m06:01:28.715142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:01:28.715368 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:01:28.720099 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:01:28.720696 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:01:28.722521 [debug] [Thread-1 (]: Compilation Error in model staging (models/staging/staging.sql)
  No materialization 'Table' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m06:01:28.723692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e95e68-2a1e-485b-8c47-bc8452266021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd8982360>]}
[0m06:01:28.724186 [error] [Thread-1 (]: 1 of 1 ERROR creating sql Table model dev.staging .............................. [[31mERROR[0m in 0.01s]
[0m06:01:28.724580 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:01:28.724974 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Compilation Error in model staging (models/staging/staging.sql)
  No materialization 'Table' was found for adapter postgres! (searched types 'default' and 'postgres').
[0m06:01:28.726807 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.727102 [debug] [MainThread]: On master: BEGIN
[0m06:01:28.727297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:01:28.731880 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:01:28.732326 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.732539 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:28.732718 [debug] [MainThread]: On master: COMMIT
[0m06:01:28.733089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:01:28.733349 [debug] [MainThread]: On master: Close
[0m06:01:28.733685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:01:28.733868 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:01:28.734088 [info ] [MainThread]: 
[0m06:01:28.734314 [info ] [MainThread]: Finished running 1 Table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m06:01:28.734795 [debug] [MainThread]: Command end result
[0m06:01:28.747333 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:01:28.748619 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:01:28.752870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:01:28.753194 [info ] [MainThread]: 
[0m06:01:28.753508 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:01:28.753760 [info ] [MainThread]: 
[0m06:01:28.754482 [error] [MainThread]:   Compilation Error in model staging (models/staging/staging.sql)
  No materialization 'Table' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m06:01:28.754965 [info ] [MainThread]: 
[0m06:01:28.755521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:01:28.756681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7180685, "process_in_blocks": "0", "process_kernel_time": 0.141998, "process_mem_max_rss": "108740", "process_out_blocks": "2512", "process_user_time": 1.588608}
[0m06:01:28.757048 [debug] [MainThread]: Command `dbt run` failed at 06:01:28.756970 after 0.72 seconds
[0m06:01:28.757321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd7fc6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd7ce2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73abd617c7d0>]}
[0m06:01:28.757576 [debug] [MainThread]: Flushing usage events
[0m06:01:29.556090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:02:33.083965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb263473b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2633a6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb26490bb90>]}


============================== 06:02:33.088998 | 8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67 ==============================
[0m06:02:33.088998 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:02:33.089488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:33.207527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb262e9f7a0>]}
[0m06:02:33.250222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb26303cd40>]}
[0m06:02:33.250888 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:02:33.296037 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:02:33.367709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:02:33.368174 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:02:33.550953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb261330920>]}
[0m06:02:33.596497 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:02:33.598178 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:02:33.607889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb261321fd0>]}
[0m06:02:33.608250 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m06:02:33.608505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2614114f0>]}
[0m06:02:33.609679 [info ] [MainThread]: 
[0m06:02:33.609964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:02:33.610163 [info ] [MainThread]: 
[0m06:02:33.610530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:02:33.611381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:02:33.637453 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:02:33.637789 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:02:33.638009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:33.674696 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.037 seconds
[0m06:02:33.676685 [debug] [ThreadPool]: On list_db: Close
[0m06:02:33.678400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:02:33.682733 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:02:33.682989 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:02:33.683184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:33.688410 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:02:33.688822 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:02:33.689106 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:02:33.691301 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:02:33.692287 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:02:33.692718 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:02:33.697240 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.697545 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.697748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:33.702307 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:02:33.702880 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.703228 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:02:33.705496 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:02:33.706425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb25a28a990>]}
[0m06:02:33.706750 [debug] [MainThread]: On master: ROLLBACK
[0m06:02:33.707112 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.707306 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.707699 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:02:33.707925 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.708121 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.708282 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.708609 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:33.708837 [debug] [MainThread]: On master: Close
[0m06:02:33.711243 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:02:33.711687 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:02:33.712022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:02:33.712257 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:02:33.716844 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:02:33.717337 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:02:33.742018 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:02:33.742601 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:33.742835 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:02:33.743024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:33.748222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:02:33.748648 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:33.748884 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM "db"."dev"."raw_weather_data";
  );
  
[0m06:02:33.749391 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: FROM "db"."dev"."raw_weather_data";
                                           ^

[0m06:02:33.749641 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:02:33.750090 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:02:33.752621 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: FROM "db"."dev"."raw_weather_data";
                                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:02:33.753879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d4437b7-d56a-4cb0-8bca-e0e2d78b3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb263bc9e80>]}
[0m06:02:33.754405 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:02:33.754849 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:02:33.755335 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: FROM "db"."dev"."raw_weather_data";
                                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:02:33.757567 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.757893 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.758115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:33.763204 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:02:33.763586 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.763901 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:33.764149 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.764561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:33.764805 [debug] [MainThread]: On master: Close
[0m06:02:33.765160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:33.765357 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:02:33.765576 [info ] [MainThread]: 
[0m06:02:33.765810 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m06:02:33.766428 [debug] [MainThread]: Command end result
[0m06:02:33.779183 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:02:33.780781 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:02:33.784802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:02:33.785036 [info ] [MainThread]: 
[0m06:02:33.785319 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:02:33.785549 [info ] [MainThread]: 
[0m06:02:33.786081 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: FROM "db"."dev"."raw_weather_data";
                                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:02:33.786538 [info ] [MainThread]: 
[0m06:02:33.786878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:02:33.787679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76986665, "process_in_blocks": "0", "process_kernel_time": 0.147353, "process_mem_max_rss": "109768", "process_out_blocks": "2528", "process_user_time": 1.603027}
[0m06:02:33.788039 [debug] [MainThread]: Command `dbt run` failed at 06:02:33.787945 after 0.77 seconds
[0m06:02:33.788310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2635e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb263bc9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2613c5c10>]}
[0m06:02:33.788595 [debug] [MainThread]: Flushing usage events
[0m06:02:34.601845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:03:39.944458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9467170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9bb2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cca7f3290>]}


============================== 06:03:39.949357 | 125ff9ea-eddf-4238-94c0-395e28cf2669 ==============================
[0m06:03:39.949357 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:03:39.950062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:40.062905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc91e7e90>]}
[0m06:03:40.102281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9f0cbc0>]}
[0m06:03:40.102932 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:03:40.147924 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:03:40.214408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:03:40.214852 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:03:40.412196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc76c4620>]}
[0m06:03:40.458117 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:03:40.459953 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:03:40.470618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc76bde20>]}
[0m06:03:40.470987 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m06:03:40.471241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9255640>]}
[0m06:03:40.472790 [info ] [MainThread]: 
[0m06:03:40.473087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:03:40.473496 [info ] [MainThread]: 
[0m06:03:40.474082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:03:40.474853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:03:40.499368 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:03:40.499715 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:03:40.499949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:40.507279 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:03:40.508570 [debug] [ThreadPool]: On list_db: Close
[0m06:03:40.509648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:03:40.513154 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:03:40.513418 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:03:40.513595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:40.518801 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:03:40.519059 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:03:40.519247 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:03:40.521656 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:03:40.522520 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:03:40.522834 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:03:40.527073 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.527370 [debug] [MainThread]: On master: BEGIN
[0m06:03:40.527574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:40.532377 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:03:40.532731 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.532977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:03:40.535433 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:03:40.536475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc4446060>]}
[0m06:03:40.536828 [debug] [MainThread]: On master: ROLLBACK
[0m06:03:40.537294 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.537521 [debug] [MainThread]: On master: BEGIN
[0m06:03:40.537998 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:03:40.538231 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.538589 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.538792 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.539100 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:03:40.539330 [debug] [MainThread]: On master: Close
[0m06:03:40.541357 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:03:40.541744 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:03:40.542063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:03:40.542292 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:03:40.546952 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:03:40.547685 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:03:40.572527 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:03:40.573097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.573342 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:03:40.573557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:40.578425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:03:40.578779 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.579016 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM "db"."dev"."raw_weather_data"
  );
  
[0m06:03:40.584881 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.006 seconds
[0m06:03:40.589116 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.589403 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:03:40.589967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:03:40.600537 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:03:40.600874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.601082 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:03:40.603687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:03:40.607378 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:03:40.610665 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:40.610906 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:03:40.611445 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:03:40.612950 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:03:40.614541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '125ff9ea-eddf-4238-94c0-395e28cf2669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ccb02a450>]}
[0m06:03:40.615069 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 33[0m in 0.07s]
[0m06:03:40.615444 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:03:40.617010 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.617332 [debug] [MainThread]: On master: BEGIN
[0m06:03:40.617527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:40.622077 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:03:40.622391 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.622596 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:40.622782 [debug] [MainThread]: On master: COMMIT
[0m06:03:40.623112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:03:40.623349 [debug] [MainThread]: On master: Close
[0m06:03:40.623703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:40.623914 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:03:40.624185 [info ] [MainThread]: 
[0m06:03:40.624633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m06:03:40.625544 [debug] [MainThread]: Command end result
[0m06:03:40.638104 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:03:40.639714 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:03:40.643683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:03:40.643959 [info ] [MainThread]: 
[0m06:03:40.644256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:40.644468 [info ] [MainThread]: 
[0m06:03:40.644697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:03:40.645676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7725314, "process_in_blocks": "0", "process_kernel_time": 0.207482, "process_mem_max_rss": "109540", "process_out_blocks": "2520", "process_user_time": 1.575983}
[0m06:03:40.646037 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:40.645962 after 0.77 seconds
[0m06:03:40.646287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9839160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc932fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718cc9bb2d80>]}
[0m06:03:40.646531 [debug] [MainThread]: Flushing usage events
[0m06:03:41.480421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:28:51.587587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2d1a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2e8a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf4238530>]}


============================== 06:28:51.590272 | 4cdd516e-1a47-4738-92b4-f3ae97ed9437 ==============================
[0m06:28:51.590272 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:28:51.590651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:51.720756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2f031a0>]}
[0m06:28:51.770894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf46541a0>]}
[0m06:28:51.771568 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:28:51.820969 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:28:51.899467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:28:51.900011 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/weather_report.sql
[0m06:28:51.900365 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:28:52.116892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf0bd9100>]}
[0m06:28:52.174235 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:52.176001 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:52.187351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf0bc6ab0>]}
[0m06:28:52.187726 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:28:52.187996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf0bc36e0>]}
[0m06:28:52.189634 [info ] [MainThread]: 
[0m06:28:52.190036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:52.190392 [info ] [MainThread]: 
[0m06:28:52.191155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:28:52.193968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:28:52.221089 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:28:52.221493 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:28:52.221800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:52.296297 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.074 seconds
[0m06:28:52.297664 [debug] [ThreadPool]: On list_db: Close
[0m06:28:52.299155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:28:52.304095 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:52.304376 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:28:52.304559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:52.310739 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:28:52.311350 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:52.311635 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:28:52.313795 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:28:52.314663 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:28:52.315014 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:28:52.318288 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.318587 [debug] [MainThread]: On master: BEGIN
[0m06:28:52.318786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:28:52.323376 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:28:52.323718 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.324008 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:28:52.326395 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:28:52.327335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf1077290>]}
[0m06:28:52.327670 [debug] [MainThread]: On master: ROLLBACK
[0m06:28:52.328000 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.328201 [debug] [MainThread]: On master: BEGIN
[0m06:28:52.328581 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:28:52.328781 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.329179 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.329530 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.329991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:52.330231 [debug] [MainThread]: On master: Close
[0m06:28:52.332672 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:28:52.333144 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:28:52.333537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:28:52.333802 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:28:52.337989 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:28:52.338519 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:28:52.364734 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:28:52.365358 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:52.365625 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:28:52.366039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:52.370600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:28:52.370863 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:52.371067 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:28:52.371521 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "de_dup"
LINE 14: de_dup as (
         ^

[0m06:28:52.371759 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:28:52.372130 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:28:52.374405 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 14: de_dup as (
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:28:52.376155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cdd516e-1a47-4738-92b4-f3ae97ed9437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf10775f0>]}
[0m06:28:52.378393 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:28:52.379052 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:28:52.379653 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 14: de_dup as (
           ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:28:52.381273 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:28:52.381606 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m06:28:52.381966 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:28:52.383604 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.383860 [debug] [MainThread]: On master: BEGIN
[0m06:28:52.384052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:28:52.389030 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:28:52.389496 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.389836 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:52.390106 [debug] [MainThread]: On master: COMMIT
[0m06:28:52.390536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:52.390787 [debug] [MainThread]: On master: Close
[0m06:28:52.391134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:52.391324 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:28:52.391617 [info ] [MainThread]: 
[0m06:28:52.391883 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m06:28:52.392988 [debug] [MainThread]: Command end result
[0m06:28:52.408700 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:52.410216 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:52.414227 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:28:52.414478 [info ] [MainThread]: 
[0m06:28:52.414752 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:28:52.414977 [info ] [MainThread]: 
[0m06:28:52.415243 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 14: de_dup as (
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:28:52.415452 [info ] [MainThread]: 
[0m06:28:52.415680 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m06:28:52.416429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8942181, "process_in_blocks": "0", "process_kernel_time": 0.178353, "process_mem_max_rss": "110180", "process_out_blocks": "2520", "process_user_time": 1.712192}
[0m06:28:52.416792 [debug] [MainThread]: Command `dbt run` failed at 06:28:52.416716 after 0.89 seconds
[0m06:28:52.417065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf36a27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2a9b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702cf2a99a90>]}
[0m06:28:52.417335 [debug] [MainThread]: Flushing usage events
[0m06:28:53.361168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:29:09.168691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef84d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef84c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef84e450>]}


============================== 06:29:09.173149 | 80f173f5-c4e6-48df-aff3-0114133c8366 ==============================
[0m06:29:09.173149 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:29:09.173837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:09.296883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef385b80>]}
[0m06:29:09.343257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f0522780>]}
[0m06:29:09.344040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:29:09.392108 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:29:09.463605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:29:09.464085 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:29:09.658824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed641100>]}
[0m06:29:09.706124 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:09.707871 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:09.718725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ec062990>]}
[0m06:29:09.719093 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:29:09.719450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed640cb0>]}
[0m06:29:09.720626 [info ] [MainThread]: 
[0m06:29:09.720915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:29:09.721149 [info ] [MainThread]: 
[0m06:29:09.721522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:29:09.724390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:29:09.751158 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:29:09.751519 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:29:09.751732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:09.758560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:29:09.759466 [debug] [ThreadPool]: On list_db: Close
[0m06:29:09.760862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:29:09.764930 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:09.765228 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:29:09.765422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:09.770216 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:29:09.770469 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:09.770639 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:29:09.772733 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:29:09.773647 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:29:09.774073 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:29:09.778840 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.779160 [debug] [MainThread]: On master: BEGIN
[0m06:29:09.779393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:09.783890 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:29:09.784194 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.784437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:29:09.786951 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:29:09.787875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed56df70>]}
[0m06:29:09.788225 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:09.788610 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.788810 [debug] [MainThread]: On master: BEGIN
[0m06:29:09.789176 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:29:09.789435 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.789929 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.790129 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.790445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:09.790653 [debug] [MainThread]: On master: Close
[0m06:29:09.793105 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:29:09.793543 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:29:09.793958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:29:09.794209 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:29:09.799521 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:29:09.800204 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:29:09.825507 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:29:09.826151 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:09.826423 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:29:09.826621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:09.831130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:29:09.831381 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:09.831585 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    ,

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:29:09.832091 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 12:     ,
             ^

[0m06:29:09.832330 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:29:09.832705 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:29:09.834874 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ","
  LINE 12:     ,
               ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:29:09.836008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80f173f5-c4e6-48df-aff3-0114133c8366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed56d820>]}
[0m06:29:09.836490 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:29:09.836919 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:29:09.837396 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ","
  LINE 12:     ,
               ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:29:09.838555 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:29:09.839148 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m06:29:09.839446 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:29:09.840873 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.841107 [debug] [MainThread]: On master: BEGIN
[0m06:29:09.841287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:09.845821 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:29:09.846156 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.846352 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:09.846532 [debug] [MainThread]: On master: COMMIT
[0m06:29:09.846923 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:09.847144 [debug] [MainThread]: On master: Close
[0m06:29:09.847493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:09.847675 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:29:09.848032 [info ] [MainThread]: 
[0m06:29:09.848402 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m06:29:09.849458 [debug] [MainThread]: Command end result
[0m06:29:09.864021 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:09.866655 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:09.872594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:29:09.872915 [info ] [MainThread]: 
[0m06:29:09.873219 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:29:09.873478 [info ] [MainThread]: 
[0m06:29:09.873776 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ","
  LINE 12:     ,
               ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:29:09.874010 [info ] [MainThread]: 
[0m06:29:09.874346 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m06:29:09.875168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76969665, "process_in_blocks": "0", "process_kernel_time": 0.234683, "process_mem_max_rss": "109904", "process_out_blocks": "2520", "process_user_time": 1.576366}
[0m06:29:09.875568 [debug] [MainThread]: Command `dbt run` failed at 06:29:09.875482 after 0.77 seconds
[0m06:29:09.875884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ef750da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235ed627e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235e649dc70>]}
[0m06:29:09.876166 [debug] [MainThread]: Flushing usage events
[0m06:29:10.688596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:33:42.853660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad977ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad971a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad902bfb0>]}


============================== 06:33:42.856334 | 2f72781a-c753-42d2-8210-455bda215747 ==============================
[0m06:33:42.856334 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:33:42.856939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:33:42.977637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad8a57c20>]}
[0m06:33:43.020243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad8a9c8c0>]}
[0m06:33:43.020950 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:33:43.064415 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:33:43.136397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:33:43.136910 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:33:43.332967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6f053d0>]}
[0m06:33:43.380219 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:33:43.382066 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:33:43.393480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6efa810>]}
[0m06:33:43.393854 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:33:43.394102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6feda60>]}
[0m06:33:43.395549 [info ] [MainThread]: 
[0m06:33:43.395822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:33:43.396428 [info ] [MainThread]: 
[0m06:33:43.397011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:43.399741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:33:43.428241 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:33:43.428578 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:33:43.428775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:43.438315 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m06:33:43.439331 [debug] [ThreadPool]: On list_db: Close
[0m06:33:43.440578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:33:43.444116 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:33:43.444385 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:33:43.444564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:43.449126 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:33:43.449463 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:33:43.449665 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:33:43.451881 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:33:43.452809 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:33:43.453147 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:33:43.457760 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.458051 [debug] [MainThread]: On master: BEGIN
[0m06:33:43.458241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:33:43.462613 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:33:43.462851 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.463076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:33:43.465501 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:33:43.466617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad6ef3fb0>]}
[0m06:33:43.466993 [debug] [MainThread]: On master: ROLLBACK
[0m06:33:43.467401 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.467609 [debug] [MainThread]: On master: BEGIN
[0m06:33:43.468028 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:33:43.468267 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.468474 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.468872 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.469296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:43.469539 [debug] [MainThread]: On master: Close
[0m06:33:43.471668 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:33:43.472099 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:33:43.472426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:33:43.472643 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:33:43.477262 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:33:43.477762 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:33:43.501475 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:33:43.502048 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:43.502294 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:33:43.502488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:43.507048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:33:43.507304 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:33:43.507509 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:33:43.508045 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                ^

[0m06:33:43.508290 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:33:43.508816 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:33:43.511504 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                  ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:33:43.512983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f72781a-c753-42d2-8210-455bda215747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759acfeacfe0>]}
[0m06:33:43.513736 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.04s]
[0m06:33:43.514225 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:33:43.514666 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                  ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:33:43.515807 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:33:43.516103 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m06:33:43.516360 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:33:43.517985 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.518485 [debug] [MainThread]: On master: BEGIN
[0m06:33:43.518738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:33:43.523835 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:33:43.524236 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.524460 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:43.524660 [debug] [MainThread]: On master: COMMIT
[0m06:33:43.525149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:43.525569 [debug] [MainThread]: On master: Close
[0m06:33:43.526156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:43.526477 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:33:43.526796 [info ] [MainThread]: 
[0m06:33:43.527076 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m06:33:43.528560 [debug] [MainThread]: Command end result
[0m06:33:43.541844 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:33:43.543288 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:33:43.547495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:33:43.547744 [info ] [MainThread]: 
[0m06:33:43.548005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:33:43.548228 [info ] [MainThread]: 
[0m06:33:43.548500 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 20: ...number() over(partition by time order by inserted at) as rm 
                                                                  ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:33:43.548701 [info ] [MainThread]: 
[0m06:33:43.548927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m06:33:43.549675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.757676, "process_in_blocks": "0", "process_kernel_time": 0.260723, "process_mem_max_rss": "110372", "process_out_blocks": "2528", "process_user_time": 1.559919}
[0m06:33:43.550049 [debug] [MainThread]: Command `dbt run` failed at 06:33:43.549961 after 0.76 seconds
[0m06:33:43.550429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad95e40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad8b097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ad7057cb0>]}
[0m06:33:43.550696 [debug] [MainThread]: Flushing usage events
[0m06:33:44.371198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:29.721050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab84bec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86fee900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86366060>]}


============================== 06:34:29.723843 | b6536add-4987-474d-bccf-7f4a7f28091f ==============================
[0m06:34:29.723843 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:29.724505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:34:29.839793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab8545cec0>]}
[0m06:34:29.886305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab849138c0>]}
[0m06:34:29.887067 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:29.936298 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:34:30.004801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:34:30.005301 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:34:30.200155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab82da1100>]}
[0m06:34:30.245600 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:30.247587 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:30.258550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab82cbaa50>]}
[0m06:34:30.258932 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:34:30.259199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab8308bd70>]}
[0m06:34:30.260402 [info ] [MainThread]: 
[0m06:34:30.260706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:30.260935 [info ] [MainThread]: 
[0m06:34:30.261330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:30.264576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:34:30.292597 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:34:30.292967 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:34:30.293172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:30.301973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m06:34:30.303367 [debug] [ThreadPool]: On list_db: Close
[0m06:34:30.304567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:34:30.308370 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:30.308689 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:34:30.308879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:30.313577 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.313842 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:30.314028 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:34:30.315797 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m06:34:30.316734 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:34:30.317090 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:34:30.321399 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.321686 [debug] [MainThread]: On master: BEGIN
[0m06:34:30.321890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:30.326620 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.326966 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.327211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:30.329683 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:34:30.330683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86740530>]}
[0m06:34:30.331028 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:30.331384 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.331595 [debug] [MainThread]: On master: BEGIN
[0m06:34:30.332027 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:30.332285 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.332471 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.332647 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.332931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:30.333152 [debug] [MainThread]: On master: Close
[0m06:34:30.335394 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:34:30.335827 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:34:30.336216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:34:30.336457 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:34:30.341182 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:34:30.341702 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:34:30.365918 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:34:30.366497 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.366980 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:34:30.367292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:30.372275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.372658 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.372901 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

select * from de_dup
  );
  
[0m06:34:30.379772 [debug] [Thread-1 (]: SQL status: SELECT 68 in 0.007 seconds
[0m06:34:30.383979 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.384361 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:34:30.385082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:30.386743 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.386976 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:34:30.387491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:30.399294 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:30.399639 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.399878 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:30.405436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:34:30.409159 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:34:30.412786 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:30.413051 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:34:30.444832 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m06:34:30.446719 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:34:30.447939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab86696450>]}
[0m06:34:30.448562 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 68[0m in 0.11s]
[0m06:34:30.448968 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:34:30.450176 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:34:30.451007 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m06:34:30.451784 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:34:30.452173 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m06:34:30.454509 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:34:30.455269 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m06:34:30.457316 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:34:30.458035 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.458292 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m06:34:30.458496 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:34:30.463763 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:34:30.464323 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.464610 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:34:30.473954 [debug] [Thread-3 (]: SQL status: SELECT 68 in 0.009 seconds
[0m06:34:30.476158 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.476433 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:34:30.476929 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:30.477830 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:34:30.478056 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.478250 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:34:30.480223 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:34:30.482476 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:34:30.482867 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:34:30.483107 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:34:30.483554 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:34:30.484464 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m06:34:30.484882 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6536add-4987-474d-bccf-7f4a7f28091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab80169f40>]}
[0m06:34:30.485297 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 68[0m in 0.03s]
[0m06:34:30.485659 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:34:30.487674 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.488173 [debug] [MainThread]: On master: BEGIN
[0m06:34:30.488409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:30.492885 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:34:30.493198 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.493398 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:30.493581 [debug] [MainThread]: On master: COMMIT
[0m06:34:30.493977 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:30.494215 [debug] [MainThread]: On master: Close
[0m06:34:30.494558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:30.494746 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:34:30.494904 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:34:30.495160 [info ] [MainThread]: 
[0m06:34:30.495390 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m06:34:30.496131 [debug] [MainThread]: Command end result
[0m06:34:30.509179 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:30.510541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:30.514723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:34:30.514990 [info ] [MainThread]: 
[0m06:34:30.515262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:30.515534 [info ] [MainThread]: 
[0m06:34:30.516408 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:34:30.517966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8695422, "process_in_blocks": "0", "process_kernel_time": 0.291748, "process_mem_max_rss": "110160", "process_out_blocks": "2552", "process_user_time": 1.626716}
[0m06:34:30.518393 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:30.518304 after 0.87 seconds
[0m06:34:30.518674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab84bec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab831aeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aab8300d5b0>]}
[0m06:34:30.518950 [debug] [MainThread]: Flushing usage events
[0m06:34:31.323832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:37:59.426424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81a206a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81bec3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81a205e80>]}


============================== 06:37:59.429040 | f6a22583-ea0f-49eb-b743-3af94ceee28a ==============================
[0m06:37:59.429040 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:37:59.429419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:37:59.557318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa819cf9700>]}
[0m06:37:59.601895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8184f7a40>]}
[0m06:37:59.602701 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:37:59.647823 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:37:59.719581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:37:59.720148 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:37:59.920117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa818187c50>]}
[0m06:37:59.970400 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:37:59.972453 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:37:59.984101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81805e8a0>]}
[0m06:37:59.984478 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m06:37:59.984745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa818050f50>]}
[0m06:37:59.985957 [info ] [MainThread]: 
[0m06:37:59.986255 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:37:59.986472 [info ] [MainThread]: 
[0m06:37:59.986846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:37:59.989674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:38:00.020663 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:38:00.020990 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:38:00.021183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:00.029200 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m06:38:00.030202 [debug] [ThreadPool]: On list_db: Close
[0m06:38:00.031577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:38:00.035263 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:38:00.035662 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:38:00.035877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:00.040132 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:38:00.040357 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:38:00.040691 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:00.042700 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:38:00.043926 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:38:00.044454 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:38:00.050279 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.050618 [debug] [MainThread]: On master: BEGIN
[0m06:38:00.050817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:00.055709 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:00.056071 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.056344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:00.059301 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:38:00.060402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81ba90500>]}
[0m06:38:00.060787 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:00.061170 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.061390 [debug] [MainThread]: On master: BEGIN
[0m06:38:00.061875 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:00.062109 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.062300 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.062485 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.062838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:00.063175 [debug] [MainThread]: On master: Close
[0m06:38:00.065505 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:38:00.065905 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:38:00.066238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:38:00.066472 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:38:00.071863 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:38:00.072362 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:38:00.098003 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:38:00.098636 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.098911 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:38:00.099145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:00.103671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:38:00.103959 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.104174 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:38:00.110669 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:38:00.115201 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.115612 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:38:00.116354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.118025 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.118254 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:38:00.118691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.131174 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:38:00.131600 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.131817 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:38:00.137180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:38:00.141330 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:38:00.145138 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:38:00.145494 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:38:00.148677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:38:00.151396 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:38:00.152717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8144cf8f0>]}
[0m06:38:00.153242 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.09s]
[0m06:38:00.154157 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:38:00.154998 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m06:38:00.155531 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m06:38:00.155936 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:38:00.156156 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m06:38:00.158057 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:38:00.158512 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m06:38:00.160426 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:38:00.160979 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.161207 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m06:38:00.161404 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:38:00.166233 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:38:00.166616 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.166847 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:38:00.172365 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:38:00.174867 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.175165 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:38:00.175884 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.178664 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.178920 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:38:00.179575 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:00.180624 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:38:00.180939 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.181182 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m06:38:00.183464 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:38:00.185252 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:38:00.185666 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m06:38:00.185883 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:38:00.188386 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:38:00.189317 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m06:38:00.189752 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6a22583-ea0f-49eb-b743-3af94ceee28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8181ad700>]}
[0m06:38:00.190173 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.03s]
[0m06:38:00.190532 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m06:38:00.192045 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.192282 [debug] [MainThread]: On master: BEGIN
[0m06:38:00.192472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:00.197852 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:00.198278 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.198534 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:00.198769 [debug] [MainThread]: On master: COMMIT
[0m06:38:00.199505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:00.199855 [debug] [MainThread]: On master: Close
[0m06:38:00.200303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:00.200539 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:38:00.200762 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:38:00.201122 [info ] [MainThread]: 
[0m06:38:00.201539 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m06:38:00.202844 [debug] [MainThread]: Command end result
[0m06:38:00.216982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:38:00.218560 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:38:00.222922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:38:00.223190 [info ] [MainThread]: 
[0m06:38:00.223591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:00.223827 [info ] [MainThread]: 
[0m06:38:00.224264 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:38:00.225366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8662028, "process_in_blocks": "0", "process_kernel_time": 0.287998, "process_mem_max_rss": "109840", "process_out_blocks": "2568", "process_user_time": 1.688111}
[0m06:38:00.225798 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:00.225707 after 0.87 seconds
[0m06:38:00.226101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81a162b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8181a33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa819f8c980>]}
[0m06:38:00.226398 [debug] [MainThread]: Flushing usage events
[0m06:38:01.024121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:43:16.451356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bd256900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bca33bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bd256630>]}


============================== 06:43:16.455251 | ee6ce91e-7b04-42ce-8199-a1892dff6441 ==============================
[0m06:43:16.455251 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:43:16.455668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:16.587789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc7a6360>]}
[0m06:43:16.632000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bdbb5940>]}
[0m06:43:16.632714 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:43:16.677886 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:43:16.757420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:43:16.757958 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/daily_avg.sql
[0m06:43:16.945835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295baaa52e0>]}
[0m06:43:16.993303 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:43:16.995066 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:43:17.005899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bab7b020>]}
[0m06:43:17.006282 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:43:17.006530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bac63d70>]}
[0m06:43:17.007660 [info ] [MainThread]: 
[0m06:43:17.007942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:17.008161 [info ] [MainThread]: 
[0m06:43:17.008502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:17.011345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:43:17.041416 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:43:17.041797 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:43:17.042010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:17.049356 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:43:17.050503 [debug] [ThreadPool]: On list_db: Close
[0m06:43:17.051986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:43:17.056578 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:43:17.056824 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:43:17.057003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:17.061305 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:43:17.061592 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:43:17.061796 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:43:17.063914 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:43:17.064904 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:43:17.065453 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:43:17.069147 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.069480 [debug] [MainThread]: On master: BEGIN
[0m06:43:17.069677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:17.074253 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:43:17.074561 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.074814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:17.077461 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:43:17.078447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b87c2b10>]}
[0m06:43:17.078790 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:17.079227 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.079478 [debug] [MainThread]: On master: BEGIN
[0m06:43:17.079908 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:43:17.080185 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.080593 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.080913 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.081410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:17.081678 [debug] [MainThread]: On master: Close
[0m06:43:17.084024 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:43:17.084435 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:43:17.084770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:43:17.085008 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:43:17.089558 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:43:17.090098 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:43:17.114330 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:43:17.114906 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.115160 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:43:17.115366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:17.119869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:43:17.120136 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.120347 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:43:17.127556 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:43:17.132222 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.132601 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:43:17.133302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:17.135649 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.135965 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:43:17.136502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:17.149624 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:43:17.149987 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.150200 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:43:17.154675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m06:43:17.159882 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:43:17.163097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:43:17.163357 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:43:17.166219 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:43:17.167978 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:43:17.169112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295be5166c0>]}
[0m06:43:17.169593 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.08s]
[0m06:43:17.170133 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:43:17.171217 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:43:17.171578 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:43:17.172030 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:43:17.172641 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:43:17.173273 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:43:17.173724 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:43:17.174052 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:43:17.174343 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:43:17.176263 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:43:17.178026 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:43:17.178552 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:43:17.181621 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:43:17.182094 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:43:17.184095 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:43:17.184694 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:43:17.185499 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:43:17.185855 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:43:17.186179 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.186566 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:43:17.186768 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:43:17.190996 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:43:17.191386 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:43:17.191646 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed,
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:43:17.191995 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m06:43:17.192328 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.192567 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 19: from "db"."dev"."staging"
         ^

[0m06:43:17.192860 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:43:17.193166 [debug] [Thread-3 (]: On model.my_project.daily_avg: ROLLBACK
[0m06:43:17.193748 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:43:17.199232 [debug] [Thread-3 (]: Database Error in model daily_avg (models/mart/daily_avg.sql)
  syntax error at or near "from"
  LINE 19: from "db"."dev"."staging"
           ^
  compiled code at target/run/my_project/models/mart/daily_avg.sql
[0m06:43:17.199753 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:43:17.200418 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bae7f860>]}
[0m06:43:17.202984 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.203774 [error] [Thread-3 (]: 2 of 3 ERROR creating sql table model dev.daily_avg ............................ [[31mERROR[0m in 0.03s]
[0m06:43:17.204276 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:43:17.204770 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:43:17.205561 [debug] [Thread-7 (]: Marking all children of 'model.my_project.daily_avg' to be skipped because of status 'error'.  Reason: Database Error in model daily_avg (models/mart/daily_avg.sql)
  syntax error at or near "from"
  LINE 19: from "db"."dev"."staging"
           ^
  compiled code at target/run/my_project/models/mart/daily_avg.sql.
[0m06:43:17.205940 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:17.208654 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.208955 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:43:17.209536 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:17.210786 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:43:17.211072 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.211304 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:43:17.213461 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:43:17.214878 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:43:17.215338 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:43:17.215574 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:43:17.218217 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:43:17.219214 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:43:17.219672 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6ce91e-7b04-42ce-8199-a1892dff6441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b821cc50>]}
[0m06:43:17.220082 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m06:43:17.220439 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:43:17.221966 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.222205 [debug] [MainThread]: On master: BEGIN
[0m06:43:17.222393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:17.226659 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:43:17.226930 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.227123 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:17.227311 [debug] [MainThread]: On master: COMMIT
[0m06:43:17.227678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:17.227939 [debug] [MainThread]: On master: Close
[0m06:43:17.228281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:17.228481 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:43:17.228653 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:43:17.228819 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:43:17.229333 [info ] [MainThread]: 
[0m06:43:17.229863 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m06:43:17.231227 [debug] [MainThread]: Command end result
[0m06:43:17.246298 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:43:17.247878 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:43:17.252939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:43:17.253304 [info ] [MainThread]: 
[0m06:43:17.253644 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:43:17.253963 [info ] [MainThread]: 
[0m06:43:17.254373 [error] [MainThread]:   Database Error in model daily_avg (models/mart/daily_avg.sql)
  syntax error at or near "from"
  LINE 19: from "db"."dev"."staging"
           ^
  compiled code at target/run/my_project/models/mart/daily_avg.sql
[0m06:43:17.254631 [info ] [MainThread]: 
[0m06:43:17.254960 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m06:43:17.255927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8733757, "process_in_blocks": "0", "process_kernel_time": 0.212605, "process_mem_max_rss": "110324", "process_out_blocks": "2616", "process_user_time": 1.762851}
[0m06:43:17.256399 [debug] [MainThread]: Command `dbt run` failed at 06:43:17.256248 after 0.87 seconds
[0m06:43:17.256735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc832db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bff6a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bab85be0>]}
[0m06:43:17.257014 [debug] [MainThread]: Flushing usage events
[0m06:43:18.048588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:44:54.204878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f97229dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971a51d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971562480>]}


============================== 06:44:54.207117 | f6ee715e-0f29-41cf-98cf-e5f1d2f4d093 ==============================
[0m06:44:54.207117 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:44:54.207512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:44:54.322925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f970f74ce0>]}
[0m06:44:54.363635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971b8fe00>]}
[0m06:44:54.364380 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:44:54.410060 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:44:54.479579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:44:54.480061 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/daily_avg.sql
[0m06:44:54.671868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f9710f1880>]}
[0m06:44:54.722088 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:44:54.723893 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:44:54.737365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f2e6f90>]}
[0m06:44:54.737733 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:44:54.737983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f6c2960>]}
[0m06:44:54.739143 [info ] [MainThread]: 
[0m06:44:54.739415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:44:54.739603 [info ] [MainThread]: 
[0m06:44:54.739947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:44:54.742688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:44:54.769835 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:44:54.770185 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:44:54.770387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:54.777216 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m06:44:54.778772 [debug] [ThreadPool]: On list_db: Close
[0m06:44:54.780408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:44:54.783956 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:44:54.784221 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:44:54.784400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:44:54.788469 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.788736 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:44:54.788923 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:44:54.791005 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:44:54.792074 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:44:54.792472 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:44:54.797253 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.797546 [debug] [MainThread]: On master: BEGIN
[0m06:44:54.797741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:44:54.802220 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.802506 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.802744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:44:54.805520 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:44:54.806522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f6c2960>]}
[0m06:44:54.806892 [debug] [MainThread]: On master: ROLLBACK
[0m06:44:54.807302 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.807507 [debug] [MainThread]: On master: BEGIN
[0m06:44:54.807905 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:44:54.808120 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.808311 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.808485 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.808808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:44:54.809007 [debug] [MainThread]: On master: Close
[0m06:44:54.811202 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:44:54.811658 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:44:54.811993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:44:54.812226 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:44:54.816752 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:44:54.817238 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:44:54.840847 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:44:54.841409 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.841657 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:44:54.841855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:44:54.846395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.846648 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.846870 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m06:44:54.852373 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:44:54.856652 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.856958 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:44:54.857488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.859123 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.859358 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:44:54.859711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.871665 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:44:54.871997 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.872233 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:44:54.910312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m06:44:54.916683 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:44:54.919982 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:44:54.920241 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:44:54.923846 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m06:44:54.927129 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:44:54.928557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f972cca360>]}
[0m06:44:54.929024 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.12s]
[0m06:44:54.929400 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:44:54.930379 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m06:44:54.930692 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:44:54.931213 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m06:44:54.931772 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:44:54.932394 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m06:44:54.933038 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:44:54.933394 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m06:44:54.933659 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:44:54.935579 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m06:44:54.937482 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:44:54.938067 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:44:54.938325 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m06:44:54.940292 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:44:54.943574 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m06:44:54.944293 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.944587 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:44:54.945007 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.945439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:44:54.945750 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m06:44:54.946148 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:44:54.950641 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m06:44:54.951015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m06:44:54.951308 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.951597 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.951873 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m06:44:54.952162 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:44:54.957333 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:44:54.959463 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.959748 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:44:54.960011 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:44:54.961701 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.961976 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:44:54.962277 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m06:44:54.963803 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.964156 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:44:54.964428 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.964711 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:44:54.965622 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:44:54.966580 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:44:54.966875 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.967146 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.967421 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m06:44:54.967701 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:44:54.970018 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:44:54.971294 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m06:44:54.971564 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:44:54.972058 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m06:44:54.973519 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:44:54.973843 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m06:44:54.974263 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:44:54.974600 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:44:54.974930 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:44:54.975759 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m06:44:54.976169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96f82eb70>]}
[0m06:44:54.976622 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.04s]
[0m06:44:54.977000 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m06:44:54.977245 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m06:44:54.978337 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:44:54.978714 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ee715e-0f29-41cf-98cf-e5f1d2f4d093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f96c1a2ed0>]}
[0m06:44:54.979082 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.05s]
[0m06:44:54.979431 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:44:54.980758 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.980990 [debug] [MainThread]: On master: BEGIN
[0m06:44:54.981172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:44:54.985538 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:44:54.986052 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.986313 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:54.986505 [debug] [MainThread]: On master: COMMIT
[0m06:44:54.986877 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:44:54.987133 [debug] [MainThread]: On master: Close
[0m06:44:54.987513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:54.987737 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:44:54.987933 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m06:44:54.988105 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:44:54.988456 [info ] [MainThread]: 
[0m06:44:54.988740 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m06:44:54.989595 [debug] [MainThread]: Command end result
[0m06:44:55.004663 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:44:55.007002 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:44:55.017551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:44:55.018112 [info ] [MainThread]: 
[0m06:44:55.018543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:44:55.019024 [info ] [MainThread]: 
[0m06:44:55.019457 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:44:55.021080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8758612, "process_in_blocks": "0", "process_kernel_time": 0.198539, "process_mem_max_rss": "110596", "process_out_blocks": "2616", "process_user_time": 1.650086}
[0m06:44:55.021841 [debug] [MainThread]: Command `dbt run` succeeded at 06:44:55.021663 after 0.88 seconds
[0m06:44:55.022459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f9713ff530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f972cca360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f971a04b60>]}
[0m06:44:55.023073 [debug] [MainThread]: Flushing usage events
[0m06:44:55.809210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:14:55.447547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb836840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb69e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb6ee540>]}


============================== 07:14:55.453872 | 5f703c84-23fb-4579-9d15-272dd4fa2b2e ==============================
[0m07:14:55.453872 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:14:55.454280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:14:55.627958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfbe888c0>]}
[0m07:14:55.677893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df98b8050>]}
[0m07:14:55.678696 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:14:55.765503 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:14:55.841547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:55.841876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:55.866007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df9973b90>]}
[0m07:14:55.920593 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:14:55.922513 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:14:55.941682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df98a2660>]}
[0m07:14:55.942147 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:14:55.942531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb200110>]}
[0m07:14:55.944126 [info ] [MainThread]: 
[0m07:14:55.944636 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:55.945025 [info ] [MainThread]: 
[0m07:14:55.945785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:14:55.948710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:14:55.983039 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:14:55.983393 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:14:55.983793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:55.994335 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m07:14:55.995674 [debug] [ThreadPool]: On list_db: Close
[0m07:14:55.997135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:14:56.000920 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:14:56.001179 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:14:56.001358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:56.007258 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:14:56.007510 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:14:56.007720 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:14:56.010088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:14:56.011306 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:14:56.011858 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:14:56.016749 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.017156 [debug] [MainThread]: On master: BEGIN
[0m07:14:56.017432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:14:56.023279 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:14:56.023700 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.024358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:14:56.027366 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:14:56.028985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb274980>]}
[0m07:14:56.029538 [debug] [MainThread]: On master: ROLLBACK
[0m07:14:56.030188 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.030499 [debug] [MainThread]: On master: BEGIN
[0m07:14:56.031136 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:14:56.031575 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.031844 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.032112 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.032532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:14:56.032818 [debug] [MainThread]: On master: Close
[0m07:14:56.035167 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:14:56.035551 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:14:56.035877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:14:56.036087 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:14:56.040458 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:14:56.041073 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:14:56.066320 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:14:56.066874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.067117 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:14:56.067316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:56.073106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:14:56.073402 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.073636 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:14:56.081324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m07:14:56.086011 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.086286 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:14:56.086818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:14:56.097710 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:14:56.098244 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.098519 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:14:56.120711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m07:14:56.129369 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:14:56.136653 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:14:56.137091 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:14:56.138584 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:14:56.140447 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:14:56.141593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfd0fe600>]}
[0m07:14:56.142051 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.11s]
[0m07:14:56.142422 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:14:56.143494 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:14:56.143909 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:14:56.144611 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_avg ..................................... [RUN]
[0m07:14:56.145078 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m07:14:56.145630 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_avg'
[0m07:14:56.146205 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m07:14:56.146860 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m07:14:56.146582 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_avg
[0m07:14:56.149395 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m07:14:56.152274 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_avg"
[0m07:14:56.153065 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m07:14:56.153367 [debug] [Thread-3 (]: Began executing node model.my_project.daily_avg
[0m07:14:56.156071 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m07:14:56.158033 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_avg"
[0m07:14:56.158767 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.159136 [debug] [Thread-3 (]: On model.my_project.daily_avg: BEGIN
[0m07:14:56.159824 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:14:56.160218 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.160616 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m07:14:56.161123 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:14:56.166578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m07:14:56.167286 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.167717 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m07:14:56.168012 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * from "db"."dev"."staging"
  );
  
[0m07:14:56.168405 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.168914 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */

  
    

  create  table "db"."dev"."daily_avg__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temp,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from "db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m07:14:56.177946 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m07:14:56.182612 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.183297 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m07:14:56.186990 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.187238 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
alter table "db"."dev"."daily_avg__dbt_tmp" rename to "daily_avg"
[0m07:14:56.187990 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:14:56.183713 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m07:14:56.188946 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:14:56.189441 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.189624 [debug] [Thread-3 (]: On model.my_project.daily_avg: COMMIT
[0m07:14:56.190969 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:14:56.192118 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:14:56.192386 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.192613 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m07:14:56.192907 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m07:14:56.195743 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_avg__dbt_backup"
[0m07:14:56.196562 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_avg"
[0m07:14:56.196928 [debug] [Thread-3 (]: On model.my_project.daily_avg: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_avg"} */
drop table if exists "db"."dev"."daily_avg__dbt_backup" cascade
[0m07:14:56.198001 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:14:56.199270 [debug] [Thread-3 (]: On model.my_project.daily_avg: Close
[0m07:14:56.199733 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df87d7b90>]}
[0m07:14:56.200162 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_avg ................................ [[32mSELECT 1[0m in 0.05s]
[0m07:14:56.200509 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:14:56.201001 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m07:14:56.203157 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m07:14:56.204466 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m07:14:56.204839 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m07:14:56.205546 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:14:56.206771 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m07:14:56.208418 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f703c84-23fb-4579-9d15-272dd4fa2b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df87e53d0>]}
[0m07:14:56.213223 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.06s]
[0m07:14:56.213689 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:14:56.215049 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.215307 [debug] [MainThread]: On master: BEGIN
[0m07:14:56.215483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:14:56.235819 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m07:14:56.236212 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.236418 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:56.236616 [debug] [MainThread]: On master: COMMIT
[0m07:14:56.236975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:14:56.237222 [debug] [MainThread]: On master: Close
[0m07:14:56.237597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:56.237786 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:14:56.237991 [debug] [MainThread]: Connection 'model.my_project.daily_avg' was properly closed.
[0m07:14:56.238147 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m07:14:56.238459 [info ] [MainThread]: 
[0m07:14:56.238711 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:14:56.239415 [debug] [MainThread]: Command end result
[0m07:14:56.253496 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:14:56.255329 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:14:56.260630 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:14:56.260964 [info ] [MainThread]: 
[0m07:14:56.261631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:14:56.262811 [info ] [MainThread]: 
[0m07:14:56.263767 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:14:56.265025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85888064, "process_in_blocks": "1376", "process_kernel_time": 0.354395, "process_mem_max_rss": "107932", "process_out_blocks": "3392", "process_user_time": 1.668798}
[0m07:14:56.265406 [debug] [MainThread]: Command `dbt run` succeeded at 07:14:56.265328 after 0.86 seconds
[0m07:14:56.265767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb1bfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8df98ebb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8dfb4fca70>]}
[0m07:14:56.266200 [debug] [MainThread]: Flushing usage events
[0m07:14:57.272338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:23:15.091610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f96642000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f95182ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f952085c0>]}


============================== 07:23:15.095327 | 664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5 ==============================
[0m07:23:15.095327 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:23:15.096228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:23:15.246992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94af24b0>]}
[0m07:23:15.292729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94b52000>]}
[0m07:23:15.293450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:23:15.342030 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:23:15.417611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:23:15.418006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:23:15.443763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94565280>]}
[0m07:23:15.511289 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:23:15.513494 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:23:15.528131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f92a08110>]}
[0m07:23:15.528527 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:23:15.528804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '664ce06c-9e6c-46a3-b1d6-50fc4ac16dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94648e30>]}
[0m07:23:15.530029 [info ] [MainThread]: 
[0m07:23:15.530297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:23:15.530501 [info ] [MainThread]: 
[0m07:23:15.530857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:23:15.533582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:23:15.565882 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:23:15.566207 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:23:15.566378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:19.305490 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Name or service not known

[0m07:23:22.824587 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:23:22.825107 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:23:22.825606 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:23:22.825873 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:23:22.826152 [debug] [ThreadPool]: On list_db: No close available on handle
[0m07:23:22.827160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:22.827616 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m07:23:22.828150 [info ] [MainThread]: 
[0m07:23:22.828490 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m07:23:22.828927 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m07:23:22.831372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.815302, "process_in_blocks": "0", "process_kernel_time": 0.246595, "process_mem_max_rss": "102948", "process_out_blocks": "872", "process_user_time": 1.623046}
[0m07:23:22.831762 [debug] [MainThread]: Command `dbt run` failed at 07:23:22.831689 after 7.82 seconds
[0m07:23:22.831988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f94af1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f929fb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3f929d3380>]}
[0m07:23:22.832205 [debug] [MainThread]: Flushing usage events
[0m07:23:24.020782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:05.533567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f595d0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f59ebfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f593d8470>]}


============================== 07:31:05.540896 | aa1d46d1-960e-40d2-9f73-aefde062b5d2 ==============================
[0m07:31:05.540896 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:31:05.541648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:31:05.719155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f59446960>]}
[0m07:31:05.765157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f57a7b8f0>]}
[0m07:31:05.765926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:31:05.829230 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:31:05.905867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:31:05.923775 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m07:31:06.141226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f57746e40>]}
[0m07:31:06.192002 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:31:06.193791 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:31:06.213793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f55165010>]}
[0m07:31:06.214500 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:31:06.215032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5786b3b0>]}
[0m07:31:06.216760 [info ] [MainThread]: 
[0m07:31:06.217191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:06.217913 [info ] [MainThread]: 
[0m07:31:06.219308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:06.223005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:31:06.250696 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:31:06.251048 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:31:06.251236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:06.261744 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m07:31:06.262758 [debug] [ThreadPool]: On list_db: Close
[0m07:31:06.263477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:31:06.263814 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:31:06.266918 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:31:06.267146 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:31:06.267313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:06.271952 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:31:06.272544 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:31:06.272875 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:31:06.273421 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:31:06.274067 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:31:06.274312 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:31:06.274479 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:31:06.277487 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m07:31:06.277734 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:31:06.279008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:31:06.282971 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:31:06.283281 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:31:06.283453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:06.288125 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:31:06.288408 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:31:06.288833 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:31:06.291684 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:31:06.292514 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:31:06.292862 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:31:06.295977 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.296269 [debug] [MainThread]: On master: BEGIN
[0m07:31:06.296460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:06.301048 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:31:06.301375 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.301602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:06.303517 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m07:31:06.304451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f57650170>]}
[0m07:31:06.304786 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:06.305134 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.305334 [debug] [MainThread]: On master: BEGIN
[0m07:31:06.305894 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:31:06.306271 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.306551 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.306853 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.307210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:06.307515 [debug] [MainThread]: On master: Close
[0m07:31:06.312168 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:31:06.312737 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:31:06.313115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:31:06.313342 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:31:06.319030 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:31:06.319512 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:31:06.351893 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:31:06.352436 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:31:06.352675 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:31:06.352867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:06.359727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:31:06.360321 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:31:06.360831 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:31:06.361871 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_weather_data" does not exist
LINE 15:     select * from "db"."dev"."raw_weather_data"
                           ^

[0m07:31:06.362204 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:31:06.362830 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:31:06.375241 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:31:06.376568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa1d46d1-960e-40d2-9f73-aefde062b5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5453c380>]}
[0m07:31:06.377080 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.06s]
[0m07:31:06.377493 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:31:06.377922 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:31:06.379088 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:31:06.379477 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:31:06.379908 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_avg ............................................. [[33mSKIP[0m]
[0m07:31:06.380182 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m07:31:06.381410 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:31:06.381110 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:31:06.383503 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.384109 [debug] [MainThread]: On master: BEGIN
[0m07:31:06.384298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:06.390834 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:31:06.391326 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.391629 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:06.391990 [debug] [MainThread]: On master: COMMIT
[0m07:31:06.392445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:06.392704 [debug] [MainThread]: On master: Close
[0m07:31:06.393045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:06.393213 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:31:06.393442 [info ] [MainThread]: 
[0m07:31:06.393673 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m07:31:06.394249 [debug] [MainThread]: Command end result
[0m07:31:06.411724 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:31:06.412996 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:31:06.420465 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:31:06.420808 [info ] [MainThread]: 
[0m07:31:06.421416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:31:06.421953 [info ] [MainThread]: 
[0m07:31:06.422862 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:31:06.423539 [info ] [MainThread]: 
[0m07:31:06.424291 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m07:31:06.425049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9459884, "process_in_blocks": "0", "process_kernel_time": 0.372149, "process_mem_max_rss": "110804", "process_out_blocks": "4168", "process_user_time": 1.878681}
[0m07:31:06.425427 [debug] [MainThread]: Command `dbt run` failed at 07:31:06.425354 after 0.95 seconds
[0m07:31:06.425685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5caee930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f594475f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f596576b0>]}
[0m07:31:06.425937 [debug] [MainThread]: Flushing usage events
[0m07:31:07.534450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:34:13.712497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ee34db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ee484140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eca0fc80>]}


============================== 07:34:13.718115 | e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0 ==============================
[0m07:34:13.718115 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:34:13.718681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:34:13.952594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eca43110>]}
[0m07:34:14.022094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ec4c1d30>]}
[0m07:34:14.022998 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:34:14.095404 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:34:14.192270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:34:14.193077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:34:14.230561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eac45400>]}
[0m07:34:14.315920 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:34:14.318248 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:34:14.352302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563eab93920>]}
[0m07:34:14.352826 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:34:14.353172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ea9249e0>]}
[0m07:34:14.355461 [info ] [MainThread]: 
[0m07:34:14.355990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:34:14.358697 [info ] [MainThread]: 
[0m07:34:14.360270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:34:14.366115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:34:14.429296 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:34:14.430016 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:34:14.430550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:14.446110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m07:34:14.448243 [debug] [ThreadPool]: On list_db: Close
[0m07:34:14.449804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:34:14.450559 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:34:14.458200 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:14.458947 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:34:14.459276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:14.467120 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:34:14.467884 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:14.468679 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:34:14.470033 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m07:34:14.471352 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:34:14.471875 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:14.472324 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:34:14.475858 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m07:34:14.476271 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:34:14.478366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:34:14.483016 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:34:14.483362 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:34:14.483591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:14.492379 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:34:14.493292 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:34:14.493787 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:34:14.497743 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m07:34:14.498911 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:34:14.499585 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:34:14.506445 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.507062 [debug] [MainThread]: On master: BEGIN
[0m07:34:14.507493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:14.516998 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:34:14.517433 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.517763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:34:14.521466 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:34:14.522843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ee2ac230>]}
[0m07:34:14.523333 [debug] [MainThread]: On master: ROLLBACK
[0m07:34:14.524023 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.524383 [debug] [MainThread]: On master: BEGIN
[0m07:34:14.525797 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:34:14.526710 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.527010 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.527254 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.527868 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:14.528365 [debug] [MainThread]: On master: Close
[0m07:34:14.532362 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:34:14.533014 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:34:14.533474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:34:14.533787 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:34:14.543454 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:34:14.545808 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:34:14.577655 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:34:14.578306 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:34:14.578648 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:34:14.578934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:14.586964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:34:14.587402 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:34:14.587696 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:34:14.588671 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_weather_data" does not exist
LINE 15:     select * from "db"."dev"."raw_weather_data"
                           ^

[0m07:34:14.589306 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:34:14.590210 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:34:14.597662 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:34:14.600150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f40e7a-eb10-4b88-9b0d-28ab30d7f7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ecffa2a0>]}
[0m07:34:14.601528 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.07s]
[0m07:34:14.602553 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:34:14.603670 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:34:14.606396 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:34:14.607548 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_avg ............................................. [[33mSKIP[0m]
[0m07:34:14.608786 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:34:14.609508 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m07:34:14.610103 [info ] [Thread-3 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m07:34:14.610804 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m07:34:14.615046 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.615447 [debug] [MainThread]: On master: BEGIN
[0m07:34:14.615684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:14.625272 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:34:14.626637 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.626911 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:14.627121 [debug] [MainThread]: On master: COMMIT
[0m07:34:14.627736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:14.628095 [debug] [MainThread]: On master: Close
[0m07:34:14.628642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:14.628986 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:34:14.629364 [info ] [MainThread]: 
[0m07:34:14.629692 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m07:34:14.630339 [debug] [MainThread]: Command end result
[0m07:34:14.657395 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:34:14.659552 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:34:14.664866 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:34:14.665224 [info ] [MainThread]: 
[0m07:34:14.665553 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:34:14.666083 [info ] [MainThread]: 
[0m07:34:14.666743 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:34:14.667260 [info ] [MainThread]: 
[0m07:34:14.667919 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m07:34:14.673616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0083218, "process_in_blocks": "8", "process_kernel_time": 0.431906, "process_mem_max_rss": "107520", "process_out_blocks": "3344", "process_user_time": 2.582531}
[0m07:34:14.674963 [debug] [MainThread]: Command `dbt run` failed at 07:34:14.674690 after 1.01 seconds
[0m07:34:14.675826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ece96270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563e9dc17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563ecbcb4d0>]}
[0m07:34:14.676217 [debug] [MainThread]: Flushing usage events
[0m07:34:15.792748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:38:10.613420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8be0e3e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf5e6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdfc934d0>]}


============================== 07:38:10.619749 | 9a083326-280a-4dcd-b0bf-505373c42a09 ==============================
[0m07:38:10.619749 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:38:10.621029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:38:10.839738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf16d6a0>]}
[0m07:38:10.924118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf5e6c30>]}
[0m07:38:10.925047 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:38:10.999648 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:38:11.097937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:11.098382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:11.129642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdef769f0>]}
[0m07:38:11.183070 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:38:11.184961 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:38:11.203415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdd4508c0>]}
[0m07:38:11.203862 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m07:38:11.204223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdef296a0>]}
[0m07:38:11.205935 [info ] [MainThread]: 
[0m07:38:11.206199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:38:11.206749 [info ] [MainThread]: 
[0m07:38:11.207790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:38:11.211036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:38:11.238446 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:38:11.238761 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:38:11.238933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:11.249175 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m07:38:11.250458 [debug] [ThreadPool]: On list_db: Close
[0m07:38:11.251540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:38:11.252168 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:38:11.256298 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:38:11.256618 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:38:11.256811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:11.262585 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:38:11.263712 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:38:11.264228 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:38:11.265197 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m07:38:11.265862 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:38:11.266057 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:38:11.266215 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:38:11.269364 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m07:38:11.269931 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:38:11.272298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:38:11.277943 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:38:11.278303 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:38:11.278599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:11.286548 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:38:11.287154 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:38:11.287655 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:38:11.291179 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:38:11.292955 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:38:11.293598 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:38:11.299754 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.300234 [debug] [MainThread]: On master: BEGIN
[0m07:38:11.300617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:38:11.306567 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:38:11.306912 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.307238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:38:11.310279 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:38:11.311581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdd4fa960>]}
[0m07:38:11.312054 [debug] [MainThread]: On master: ROLLBACK
[0m07:38:11.312748 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.313197 [debug] [MainThread]: On master: BEGIN
[0m07:38:11.314074 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:38:11.314480 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.314815 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.315135 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.315711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:38:11.315999 [debug] [MainThread]: On master: Close
[0m07:38:11.319078 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:38:11.319569 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m07:38:11.319977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:38:11.320242 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:38:11.325204 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:38:11.326158 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:38:11.353144 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:38:11.353755 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:38:11.354002 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:38:11.354215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:11.359121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:38:11.359442 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:38:11.359664 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "db"."dev"."raw_weather_data"
),

de_dup as (
    select *,   
        row_number() over(partition by time order by inserted_at) as rm 
    from source
)

SELECT
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time AS weather_time_local,
    (inserted_at + (utc_offset || ' hours')::interval) AS inserted_at_local
FROM de_dup
WHERE rm = 1
  );
  
[0m07:38:11.360262 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_weather_data" does not exist
LINE 15:     select * from "db"."dev"."raw_weather_data"
                           ^

[0m07:38:11.360702 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:38:11.363938 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:38:11.369753 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:38:11.370973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a083326-280a-4dcd-b0bf-505373c42a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdfacdf40>]}
[0m07:38:11.371474 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.05s]
[0m07:38:11.371841 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:38:11.372225 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:38:11.373252 [debug] [Thread-3 (]: Began running node model.my_project.daily_avg
[0m07:38:11.373601 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m07:38:11.373891 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_avg ............................................. [[33mSKIP[0m]
[0m07:38:11.374251 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m07:38:11.374586 [debug] [Thread-3 (]: Finished running node model.my_project.daily_avg
[0m07:38:11.374861 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m07:38:11.378119 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.378429 [debug] [MainThread]: On master: BEGIN
[0m07:38:11.378603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:38:11.385633 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:38:11.386456 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.387064 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:11.387353 [debug] [MainThread]: On master: COMMIT
[0m07:38:11.387718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:38:11.387943 [debug] [MainThread]: On master: Close
[0m07:38:11.388533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:11.389222 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:38:11.389599 [info ] [MainThread]: 
[0m07:38:11.390039 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m07:38:11.391622 [debug] [MainThread]: Command end result
[0m07:38:11.411352 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:38:11.412718 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:38:11.416615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:38:11.416878 [info ] [MainThread]: 
[0m07:38:11.417296 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:38:11.417799 [info ] [MainThread]: 
[0m07:38:11.418632 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_weather_data" does not exist
  LINE 15:     select * from "db"."dev"."raw_weather_data"
                             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:38:11.419461 [info ] [MainThread]: 
[0m07:38:11.421718 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m07:38:11.423852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8566439, "process_in_blocks": "0", "process_kernel_time": 0.405231, "process_mem_max_rss": "107236", "process_out_blocks": "3344", "process_user_time": 2.21496}
[0m07:38:11.424353 [debug] [MainThread]: Command `dbt run` failed at 07:38:11.424240 after 0.86 seconds
[0m07:38:11.424830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf16d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf008290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bdf008860>]}
[0m07:38:11.425196 [debug] [MainThread]: Flushing usage events
[0m07:38:12.601879 [debug] [MainThread]: An error was encountered while trying to flush usage events
